function CubicBezier(p1x,p1y,p2x,p2y){if(!(p1x>=0&&1>=p1x))throw new RangeError("'p1x' must be a number between 0 and 1. Got "+p1x+"instead.");if(!(p1y>=0&&1>=p1y))throw new RangeError("'p1y' must be a number between 0 and 1. Got "+p1y+"instead.");if(!(p2x>=0&&1>=p2x))throw new RangeError("'p2x' must be a number between 0 and 1. Got "+p2x+"instead.");if(!(p2y>=0&&1>=p2y))throw new RangeError("'p2y' must be a number between 0 and 1. Got "+p2y+"instead.");this._p1={x:p1x,y:p1y},this._p2={x:p2x,y:p2y}}function Utils($http){this.linkDefault="http://thilaixe.de",Utils.prototype.convertText=function(text){var x=text,r=/\\u([\d\w]{4})/gi;return x=x.replace(r,function(match,grp){return String.fromCharCode(parseInt(grp,16))}),x=unescape(x)},Utils.prototype.randomQuestion=function(min,max){return Math.floor(Math.random()*(max-min+1))+min}}function QuestionMenu(){this.countAllQuestion={number:null,percent:null},this.countAllAnswered={number:null,percent:null},this.countAllAnsweredRight={number:null,percent:null},this.countAllAnsweredWrong={number:null,percent:null},this.countAllNotAnswer={number:null,percent:null},this.countAllQuestionHard={number:null,percent:null},this.countAllQuestionNumber={number:null,percent:null},this.countAllQuestionVariant={number:null,percent:null},this.countAllQuestionVideo={number:null,percent:null}}function QuestionModel(){this.number,this.Z_PK,this.Z_ENT,this.Z_OPT,this.ZID,this.ZTESTIMAGE,this.ZUPDATE,this.ZISHTML,this.ZISVIDEO,this.ZISVIDEO_DEFAULT,this.ZOLDID,this.ZTESTBIGIMAGE,this.ZL,this.ZPOINTS,this.ZTHEMA,this.ZQZG,this.ZVALID1,this.ZVALID2,this.ZVALID3,this.ZISINPUT,this.ZINPUTRIGHT1=null,this.ZINPUTRIGHT2=null,this.ZINPUTANSWER1=null,this.ZINPUTANSWER2=null,this.countPlayVideo=0,this.countPlayVideoText=null,this.textip1,this.textip1_1,this.textip1_2,this.textip1VN,this.textip1_1VN,this.textip1_2VN,this.ZPRETEXT,this.ZIMAGE,this.ZWBMP,this.ZQUESTION,this.ZQUESTIONIMAGE,this.ZTIP,this.ZKOMENTAR,this.ZSETNAME,this.ZNOTUSED,this.ZTYPE,this.ZFRAGENKATALOG,this.ZBIGIMAGE,this.ZCOMMENTMOFFA,this.ZCOMMENTZ,this.ZTIPVN,this.ZQUESTIONVN,this.ZPRETEXTVN,this.ZPRETEXTTEMP,this.ZISPRETEXT=!1,this.ZISIMAGE=!1,this.ZVARIANT=!1,this.ZVIDEOSOURCE,this.ANSWERINPUTSTRING1,this.ANSWERINPUTSTRING2,this.ANSWERINPUTSTRING1VN,this.ANSWERINPUTSTRING2VN,this.ANSWERINPUTSTRING1TEMP,this.ANSWERINPUTSTRING2TEMP,this.ISANSWERED=!1,this.ANSWERRIGHT=!1,this.ISHARD=!1,this.ISCHECK=!1,this.ZICON,this.ZQUESTIONTEMP,this.ZTEST=!1,this.ZANSWER1=null,this.ZANSWER1VN=null,this.ZANSWER=[{vn:{ZANSWER:"",ZANSWERIMAGE:""},de:{ZANSWER:"",ZANSWERIMAGE:""},ZANSWER:"",Number:0,isAnswer:!1,isValid:null,isRight:!1,checkAnswer:!1,isImage:!1},{vn:{ZANSWER:"",ZANSWERIMAGE:""},de:{ZANSWER:"",ZANSWERIMAGE:""},ZANSWER:"",Number:0,isAnswer:!1,isValid:null,isRight:!1,checkAnswer:!1,isImage:!1},{vn:{ZANSWER:"",ZANSWERIMAGE:""},de:{ZANSWER:"",ZANSWERIMAGE:""},ZANSWER:"",Number:0,isAnswer:!1,isValid:null,isRight:!1,checkAnswer:!1,isImage:!1}]}function initAds(){AdMob&&AdMob.createBanner({adId:admobid.banner,position:AdMob.AD_POSITION.BOTTOM_CENTER,autoShow:!0})}function initInterstitialAds(){AdMob.prepareInterstitial({adId:admobid.interstitial,autoShow:!0})}function downloadAssets(){var storage=window.localStorage,value=storage.getItem("assets_downloaded");if("done"!=value){var fileTransfer=new FileTransfer,uri=encodeURI("http://thilaixe.de/assets.zip"),targetPath=cordova.file.externalDataDirectory+"/assets.zip",targetDir=cordova.file.externalDataDirectory+"/fahrschul";fileTransfer.download(uri,targetPath,function(entry){console.log("Download complete: "+entry.fullPath),cordova.plugin.pDialog.dismiss(),cordova.plugin.pDialog.init({progressStyle:"SPINNER",cancelable:!1,title:"Please Wait",message:"Unzipping files..."}),zip.unzip(targetPath,targetDir,unzipCallback,unzipProgressCallback)},function(error){console.log("download error source "+error.source),console.log("download error target "+error.target),console.log("upload error code"+error.code)},!1,{headers:{Authorization:"Basic dGVzdHVzZXJuYW1lOnRlc3RwYXNzd29yZA=="}});var unzipProgressCallback=function(progressEvent){console.log("Unzip: "+Math.round(progressEvent.loaded/progressEvent.total*100)),cordova.plugin.pDialog.setProgress(Math.round(progressEvent.loaded/progressEvent.total*100))},unzipCallback=function(){storage.setItem("assets_downloaded","done"),cordova.plugin.pDialog.dismiss()};cordova.plugin.pDialog.init({progressStyle:"HORIZONTAL",title:"Please Wait",message:"Downloading data...",cancelable:!1}),fileTransfer.onprogress=function(progressEvent){if(progressEvent.lengthComputable){var currentProgress=Math.round(progressEvent.loaded/progressEvent.total*100);cordova.plugin.pDialog.setProgress(currentProgress)}}}}CubicBezier.prototype._getCoordinateForT=function(t,p1,p2){var c=3*p1,b=3*(p2-p1)-c,a=1-c-b;return((a*t+b)*t+c)*t},CubicBezier.prototype._getCoordinateDerivateForT=function(t,p1,p2){var c=3*p1,b=3*(p2-p1)-c,a=1-c-b;return(3*a*t+2*b)*t+c},CubicBezier.prototype._getTForCoordinate=function(c,p1,p2,epsilon){if(!isFinite(epsilon)||0>=epsilon)throw new RangeError("'epsilon' must be a number greater than 0.");for(var c2,d2,t2=c,i=0;8>i;i++){if(c2=this._getCoordinateForT(t2,p1,p2)-c,Math.abs(c2)<epsilon)return t2;if(d2=this._getCoordinateDerivateForT(t2,p1,p2),Math.abs(d2)<1e-6)break;t2-=c2/d2}t2=c;var c2,t0=0,t1=1;if(t0>t2)return t0;if(t2>t1)return t1;for(;t1>t0;){if(c2=this._getCoordinateForT(t2,p1,p2),Math.abs(c2-c)<epsilon)return t2;c>c2?t0=t2:t1=t2,t2=.5*(t1-t0)+t0}return t2},CubicBezier.prototype.getPointForT=function(t){if(0==t||1==t)return{x:t,y:t};if(!(t>0&&1>t))throw new RangeError("'t' must be a number between 0 and 1Got "+t+" instead.");return{x:this._getCoordinateForT(t,this._p1.x,this._p2.x),y:this._getCoordinateForT(t,this._p1.y,this._p2.y)}},CubicBezier.prototype.getTforX=function(x,epsilon){return this._getTForCoordinate(x,this._p1.x,this._p2.x,epsilon)},CubicBezier.prototype.getTforY=function(y,epsilon){return this._getTForCoordinate(y,this._p1.y,this._p2.y,epsilon)},CubicBezier.prototype._getAuxPoints=function(t){if(!(t>0&&1>t))throw new RangeError("'t' must be greater than 0 and lower than 1");var i0={x:t*this._p1.x,y:t*this._p1.y},i1={x:this._p1.x+t*(this._p2.x-this._p1.x),y:this._p1.y+t*(this._p2.y-this._p1.y)},i2={x:this._p2.x+t*(1-this._p2.x),y:this._p2.y+t*(1-this._p2.y)},j0={x:i0.x+t*(i1.x-i0.x),y:i0.y+t*(i1.y-i0.y)},j1={x:i1.x+t*(i2.x-i1.x),y:i1.y+t*(i2.y-i1.y)},k={x:j0.x+t*(j1.x-j0.x),y:j0.y+t*(j1.y-j0.y)};return{i0:i0,i1:i1,i2:i2,j0:j0,j1:j1,k:k}},CubicBezier.prototype.divideAtT=function(t){if(0>t||t>1)throw new RangeError("'t' must be a number between 0 and 1. Got "+t+" instead.");if(0===t||1===t){var curves=[];return curves[t]=CubicBezier.linear(),curves[1-t]=this.clone(),curves}var left={},right={},points=this._getAuxPoints(t),i0=points.i0,i2=(points.i1,points.i2),j0=points.j0,j1=points.j1,k=points.k,factorX=k.x,factorY=k.y;return left.p1={x:i0.x/factorX,y:i0.y/factorY},left.p2={x:j0.x/factorX,y:j0.y/factorY},right.p1={x:(j1.x-factorX)/(1-factorX),y:(j1.y-factorY)/(1-factorY)},right.p2={x:(i2.x-factorX)/(1-factorX),y:(i2.y-factorY)/(1-factorY)},[new CubicBezier(left.p1.x,left.p1.y,left.p2.x,left.p2.y),new CubicBezier(right.p1.x,right.p1.y,right.p2.x,right.p2.y)]},CubicBezier.prototype.divideAtX=function(x,epsilon){if(0>x||x>1)throw new RangeError("'x' must be a number between 0 and 1. Got "+x+" instead.");var t=this.getTforX(x,epsilon);return this.divideAtT(t)},CubicBezier.prototype.divideAtY=function(y,epsilon){if(0>y||y>1)throw new RangeError("'y' must be a number between 0 and 1. Got "+y+" instead.");var t=this.getTforY(y,epsilon);return this.divideAtT(t)},CubicBezier.prototype.clone=function(){return new CubicBezier(this._p1.x,this._p1.y,this._p2.x,this._p2.y)},CubicBezier.prototype.toString=function(){return"cubic-bezier("+[this._p1.x,this._p1.y,this._p2.x,this._p2.y].join(", ")+")"},CubicBezier.linear=function(){return new CubicBezier},CubicBezier.ease=function(){return new CubicBezier(.25,.1,.25,1)},CubicBezier.linear=function(){return new CubicBezier(0,0,1,1)},CubicBezier.easeIn=function(){return new CubicBezier(.42,0,1,1)},CubicBezier.easeOut=function(){return new CubicBezier(0,0,.58,1)},CubicBezier.easeInOut=function(){return new CubicBezier(.42,0,.58,1)};var MENU={vn:{app:"thilaixe.de",app_name:"HỌC LÁI XE TIẾNG VIỆT - HẠNG B - ",version_free:"BẢN MIỄN PHÍ",version_full:"BẢN ĐẦY ĐỦ",klass:"Hạng B",question:"Câu hỏi",test:"Thi thử",test_klass:"Thi thử hạng B",search:"Tìm kiếm",statistic:"Thống kê",setting:"Cài đặt",buy_pro:"Nâng cấp",license:"Bản quyền",all_question:"Toàn bộ câu hỏi",answered:"Câu hỏi đã trả lời",answered_right:"Câu trả lời đúng",answered_wrong:"Câu trả lời sai",hard_question:"Câu hỏi khó",not_answered:"Câu hỏi chưa trả lời",number_question:"Câu hỏi về số",variant_question:"Câu hỏi biến thể",film_question:"Câu hỏi video",weaknesses:"Yếu điểm",back:"Quay lại",basic_divider:"Bộ câu hỏi sắp xếp theo chủ đề: Cơ bản",advanced_divider:"Bộ câu hỏi sắp xếp theo chủ đề: Nâng cao",search_question:"Tìm câu hỏi",close:"Đóng",delete_result:"Xóa kết quả",result_question:"Kết quả câu hỏi",result_test:"Kết quả thi thử",answer:"Câu trả lời",answer_yes:"Trả lời đúng",answer_no:"Trả lời sai",not_answer:"Chưa trả lời",question_b:"Câu hỏi hạng B",screen_start:"Màn hình khi mở ứng dụng",start:"Bắt đầu",rate_app:"Đánh giá ứng dụng",down_result:"Tải kết quả",setting_question:"Cài đặt câu hỏi",random:"ngẫu nhiên",audio:"Âm thanh",down_film:"Tải video",quality_low:"Độ phân giải thấp",down_all_film:"Tải toàn bộ video",quality_up:"Độ phân giải cao",change_all_question:"Thay đổi bộ câu hỏi",question_prev:"Bộ câu hỏi trước",online_learning:"Dành cho người học Online",open_online:"Mở hệ thống học Online",send_resutl:"Gửi kết quả",question_advanced:"Nâng cao B",code_question:"Mã câu hỏi: ",point:"Điểm: ",cancel:"Hủy",view_result:"Trả lời",previos_question:"Câu trước",next_question:"Câu tiếp",ticked:"Đánh dấu",submit:"Nộp bài",back_check:"Bạn có thực sự muốn dừng bài thi thử này?",submit_check:"Bạn có thực sự muốn hoàn thành bài thi thử này?",alert_submit:"Bạn đang có ",alert_submit_1:" câu hỏi chưa được trả lời",show_question:"Nếu bạn chuyển sang phần câu hỏi của câu này bạn sẽ không thể xem lại Video này nữa. Bạn có thực sự muốn chuyển sang phần câu hỏi luôn không?",yes:"Có",no:"Không",start_video:"Hãy xem đoạn video về tình huống giao thông sau đây.",button_start_video:"Bắt đầu video",view_question_video:"Xem câu hỏi",title_count_play1:"Bạn có thể xem video ",title_count_play2:" lần.",count_ticked_1:"Còn lại ",count_ticked_2:" câu",result_title:"Kết quả",back_test:"Thi lại",point_error:"Điểm sai",basic_test:"Cơ bản",advanced:"Hạng B Nâng cao",not_bestanden:"Không đỗ",bestanden:"Thi đỗ",hasmade:"Đã làm",wrong_point:"Điểm sai",advanced_question:"Câu hỏi nâng cao",basic_question:"Câu hỏi cơ bản",all_rick:"Đúng tất cả",your_answer:"Câu trả lời của bạn",right_answer:"Câu trả lời đúng",status_answer_right:"Bạn đã trả lời chính xác!",status_answer_wrong:"Bạn đã trả lời sai!",status_answer_hard:"Câu hỏi này đã được đánh dấu khó.",status_answer_un_hard:"Câu hỏi này đã được bỏ đánh dấu khó",version:"Phiên bản",licence:"Bản quyền",activated:"Bạn đã active thành công và có thể dùng bản đầy đủ!",question_from:"Bộ câu hỏi từ 01.04.2016",no_test:"Chưa có kết quả thi thử",buy_full_version:"Bạn có muốn đăng nhập để dùng bản đầy đủ không?",buy_full_test:"Bạn có muốn đăng nhập để có nhiều bài thi không?",cause_tion:"Chú ý",go:"Đến câu: ",hard:"Khó"},de:{app_name:"FÜHRERSCHEIN FAHRSCHULE KLASSE B ",version_free:"DEMO VERSION",version_full:"VOLLVERSION",klass:"Klasse B",question:"Fragen lernen",test:"Prüfungssimulation",test_klass:"Prüfungssimulationen für Klasse B",search:"Fragen suchen",statistic:"Meine Statistik",setting:"Einstellungen",buy_pro:"Upgrade",license:"Bản quyền",all_question:"Alle Fragen",answered:"Bearbeitete",answered_right:"Richtig beantwortete",answered_wrong:"Falsch beantwortete",hard_question:"Schwierige",not_answered:"Noch nicht gemachte",number_question:"Zahlenfragen",variant_question:"Variationen",film_question:"Filmfragen",weaknesses:"Meine Schwächen",back:"Zurück",basic_divider:"AMTLICHER FRAGENKATALOG NACH THEMEN SORTIERT: GRUNDSTOFF",advanced_divider:"AMTLICHER FRAGENKATALOG NACH THEMEN SORTIERT: ZUSATZSTOFF",search_question:"Frage suchen",close:"Schließen",delete_result:"Ergebnisse löschen",result_question:"Ergebnisse der Fragen",result_test:"Ergebnisse der Prüfungssimulationen",answer:"Antworten",answer_yes:"Richtig beantwortete",answer_no:"Falsch beantwortete",not_answer:"Noch nicht gemachte",hard_question_stastic:"Schwierige Fragen",question_b:"Fragen für Klass B",screen_start:"STARTBILDSCHIRM DER ANWENDUNG",start:"Start",rate_app:"AppLaiXe bewerten",down_result:"Tải kết quả",setting_question:"EINSTELLUNGEN BEIM „FRAGEN LERNEN“",question_setting:"Fragen ",random:"zufällig",audio:"Ton",down_film:"Tải video",quality_low:"Độ phân giải thấp",down_all_film:"Tải toàn bộ video",quality_up:"Độ phân giải cao",change_all_question:"HIER KÖNNEN SIE DEN FRAGENKATALOG ÄNDERN",question_prev:"Fragenkatalog gültig ab",online_learning:"Dành cho người học Online",open_online:"Mở hệ thống học Online",send_resutl:"Gửi kết quả",question_advanced:"Zusatzfrage B",code_question:"Frage: ",point:"Punkte: ",cancel:"Abbrechen",view_result:"Antwort",previos_question:"Zurück",next_question:"Weiter",ticked:"Markieren",submit:"Abgabe",submit_check:"Möchten Sie diese Prüfung wirklich beenden?",back_check:"Möchten Sie diese Prüfung wirklich abbrechen?",show_question:"Wenn Sie zur Aufgabenstellung wechseln, können Sie den Film nicht noch einmal ansehen! Wollen Sie wirklich zur Aufgabenstellung wechseln?",alert_submit:"Sie haben noch ",alert_submit_1:" nicht beantwortete Fragen",yes:"Ja",no:"Nein",start_video:"Bitte starten Sie den Film, um sich mit der Situation vertraut zu machen.",button_start_video:"Film starten",view_question_video:"Zur Aufgabenstellung",title_count_play1:"Sie können the sich den Film insgesamt ",title_count_play2:" mal ansehen.",count_ticked_1:"noch ",count_ticked_2:" aufgaben",result_title:"Ihre Ergebnisse",back_test:"Wiederholen",point_error:"Fehlerpunkte",basic_test:"Grundstoff",advanced:"Zusatzstoff Klasse B",not_bestanden:"Nicht bestanden",bestanden:"Bestanden",hasmade:"Gemacht",wrong_point:"Fehlerpunkte",advanced_question:"Zusatzfragen",basic_question:"Grundfragen",all_rick:"Alles richtig",your_answer:"Ihre Antwort",right_answer:"Richtige Antwort",status_answer_right:"Sie haben richtig geantwortet!",status_answer_wrong:"Sie haben falsch geantwortet!",status_answer_hard:"Die Frage wurde als schwierig markiert.",status_answer_un_hard:"Die Frage wurde als nicht schwierig markiert.",version:"Version",licence:"Alle Rechte vorbehalten",question_from:"Fragenkatalog gültig ab 01.04.2016",no_test:"Es gibt keine Ergebnisse der Prüfungssimulationen",cause_tion:"Aufmerksamkeit",go:"Gehe zu: ",hard:"Schwer"}};!function(){"use strict";angular.module("TrafficLaws.cordovaService",[]).factory("cordova",["$q","$window",function($q,$window){var deferred=$q.defer(),resolved=!1;return resolved&&$window.cordova?deferred.resolve($window.cordova):document.addEventListener("deviceready",function(){resolved=!0,deferred.resolve($window.cordova)},!1),{ready:deferred.promise}}])}(),function(){"use strict";angular.module("TrafficLaws.connectService",["ui.router","ngAnimate","TrafficLaws.databaseService"]).factory("connect",["$rootScope","$q","$timeout","$window","$filter","cordova","db","$state",function($rootScope,$q,$timeout,$window,$filter,cordova,db,$state){return{getAllQuestion:function(){var deferred=$q.defer(),menuQuestionCount=new QuestionMenu;if(0==$rootScope.language)var menuQuestion=[{name:$rootScope.Menu.vn.all_question,event:1,number:"",percent:"",icon:"fa-folder-open-o"},{name:$rootScope.Menu.vn.answered,event:2,number:"",percent:"",icon:"fa-file-text-o"},{name:$rootScope.Menu.vn.answered_right,event:3,number:"",percent:"",icon:"fa-calendar-check-o"},{name:$rootScope.Menu.vn.answered_wrong,event:4,number:"",percent:"",icon:"fa-calendar-times-o"},{name:$rootScope.Menu.vn.hard_question,event:5,number:"",percent:"",icon:"fa-bookmark-o"},{name:$rootScope.Menu.vn.not_answered,event:6,number:"",percent:"",icon:"fa-file-o"},{name:$rootScope.Menu.vn.number_question,event:7,number:"",percent:"",icon:"fa-file-excel-o"},{name:$rootScope.Menu.vn.variant_question,event:8,number:"",percent:"",icon:"fa-file-image-o"},{name:$rootScope.Menu.vn.film_question,event:9,number:"",percent:"",icon:"fa-file-video-o"}];else var menuQuestion=[{name:$rootScope.Menu.de.all_question,event:1,number:"",percent:"",icon:"fa-folder-open-o"},{name:$rootScope.Menu.de.answered,event:2,number:"",percent:"",icon:"fa-file-text-o"},{name:$rootScope.Menu.de.answered_right,event:3,number:"",percent:"",icon:"fa-calendar-check-o"},{name:$rootScope.Menu.de.answered_wrong,event:4,number:"",percent:"",icon:"fa-calendar-times-o"},{name:$rootScope.Menu.de.hard_question,event:5,number:"",percent:"",icon:"fa-bookmark-o"},{name:$rootScope.Menu.de.not_answered,event:6,number:"",percent:"",icon:"fa-file-o"},{name:$rootScope.Menu.de.number_question,event:7,number:"",percent:"",icon:"fa-file-excel-o"},{name:$rootScope.Menu.de.variant_question,event:8,number:"",percent:"",icon:"fa-file-image-o"},{name:$rootScope.Menu.de.film_question,event:9,number:"",percent:"",icon:"fa-file-video-o"}];return db.countQuestionAll().then(function(data){menuQuestionCount.countAllQuestion.number=data,menuQuestionCount.countAllQuestion.percent=100,menuQuestion[0].number=data,menuQuestion[0].percent=100,db.countAnsweredAll().then(function(data){menuQuestionCount.countAllAnswered.number=data,menuQuestionCount.countAllAnswered.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),menuQuestion[1].number=data,menuQuestion[1].percent=menuQuestionCount.countAllAnswered.percent,menuQuestionCount.countAllNotAnswer.number=menuQuestionCount.countAllQuestion.number-menuQuestionCount.countAllAnswered.number,menuQuestionCount.countAllNotAnswer.percent=menuQuestionCount.countAllQuestion.percent-menuQuestionCount.countAllAnswered.percent,menuQuestion[5].number=menuQuestionCount.countAllNotAnswer.number,menuQuestion[5].percent=menuQuestionCount.countAllNotAnswer.percent,db.countAnsweredRightAll().then(function(data){menuQuestionCount.countAllAnsweredRight.number=data,menuQuestionCount.countAllAnsweredRight.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),menuQuestion[2].number=data,menuQuestion[2].percent=menuQuestionCount.countAllAnsweredRight.percent,db.countAnsweredWrongAll().then(function(data){menuQuestionCount.countAllAnsweredWrong.number=data,menuQuestionCount.countAllAnsweredWrong.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),menuQuestion[3].number=data,menuQuestion[3].percent=menuQuestionCount.countAllAnsweredWrong.percent,db.countQuestionHardAll().then(function(data){menuQuestionCount.countAllQuestionHard.number=data,menuQuestionCount.countAllQuestionHard.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),menuQuestion[4].number=data,menuQuestion[4].percent=menuQuestionCount.countAllQuestionHard.percent,db.countQuestionNumberAll().then(function(data){menuQuestionCount.countAllQuestionNumber.number=data,menuQuestionCount.countAllQuestionNumber.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),menuQuestion[6].number=data,menuQuestion[6].percent=menuQuestionCount.countAllQuestionNumber.percent,db.countQuestionVariantAll().then(function(data){menuQuestionCount.countAllQuestionVariant.number=data,menuQuestionCount.countAllQuestionVariant.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),menuQuestion[7].number=data,menuQuestion[7].percent=menuQuestionCount.countAllQuestionVariant.percent,db.countQuestionVideoAll().then(function(data){menuQuestionCount.countAllQuestionVideo.number=data,menuQuestionCount.countAllQuestionVideo.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),menuQuestion[8].number=data,menuQuestion[8].percent=menuQuestionCount.countAllQuestionVideo.percent,deferred.resolve(menuQuestion)})})})})})})})}),deferred.promise}}}])}(),function(){"use strict";angular.module("TrafficLaws.databaseService",["TrafficLaws.cordovaService","ngAnimate"]).factory("db",["$q","cordova","$sce","$http","$rootScope","$window",function($q,cordova,$sce,$http,$rootScope,$window){function DatabaseManager(){function search(text,isActive){var SEARCH_QUERY,deferred=$q.defer();return SEARCH_QUERY=isActive?"SELECT ZQUESTION, ZQUESTIONVN, ZID, ZFRAGENKATALOG FROM ZQUESTION WHERE (ZQUESTIONVN LIKE '%"+text+"%') OR (ZQUESTION LIKE '%"+text+"%') OR (ZFRAGENKATALOG LIKE '%"+text+"%') LIMIT 10":"SELECT ZQUESTION, ZQUESTIONVN,ZID, ZFRAGENKATALOG FROM ZQUESTION WHERE ((ZQUESTIONVN LIKE '%"+text+"%') OR (ZQUESTION LIKE '%"+text+"%') OR (ZFRAGENKATALOG LIKE '%"+text+"%')) AND ZTEST=1 LIMIT 10",mDB.transaction(function(tx){tx.executeSql(SEARCH_QUERY,[],function(tx,results){null!=results&&null!=results.rows.item(0).ZID?deferred.resolve(results.rows):deferred.resolve(null)})},function(tx,err){console.log("search fail"+tx.message),deferred.resolve(null)}),deferred.promise}function addAnswerRight(id){var deferred=$q.defer(),ADD_ANSWER_RIGHT="INSERT INTO 'main'.'ZQUESTIONSTATS' ('Z_ENT','Z_OPT','ZLASTRESULT','ZDIFFICULT','ZRIGHTCOUNT','ZUSERID','ZWRONGCOUNT','ZQUESTION') SELECT '1','1','1','0','0','1','0','"+id+"' WHERE NOT EXISTS (SELECT 1 FROM 'ZQUESTIONSTATS' WHERE ZQUESTION = "+id+")";return mDB.transaction(function(tx){tx.executeSql(ADD_ANSWER_RIGHT)},function(tx,er){console.log("answer right Fail "+er),deferred.resolve()},function(e){console.log("answer right Success"),deferred.resolve()}),deferred.promise}function addAnswerWrong(id){var deferred=$q.defer(),ADD_ANSWER_RIGHT="INSERT INTO 'main'.'ZQUESTIONSTATS' ('Z_ENT','Z_OPT','ZLASTRESULT','ZDIFFICULT','ZRIGHTCOUNT','ZUSERID','ZWRONGCOUNT','ZQUESTION') SELECT '1','1','0','0','0','1','0','"+id+"' WHERE NOT EXISTS (SELECT 1 FROM 'ZQUESTIONSTATS' WHERE ZQUESTION = "+id+")";return mDB.transaction(function(tx){tx.executeSql(ADD_ANSWER_RIGHT)},function(tx,er){console.log("answer wrong Fail "+er),deferred.resolve()},function(e){console.log("answer wrong Success"),deferred.resolve()}),deferred.promise}function addQuestionHard(id){var deferred=$q.defer(),ADD_ANSWER_HARD="INSERT INTO 'main'.'ZQUESTIONSTATS' ('Z_ENT','Z_OPT','ZLASTRESULT','ZDIFFICULT','ZRIGHTCOUNT','ZUSERID','ZWRONGCOUNT','ZQUESTION') SELECT '1','1','-1','1','0','1','0','"+id+"' WHERE NOT EXISTS (SELECT 1 FROM 'ZQUESTIONSTATS' WHERE ZQUESTION = "+id+")";return mDB.transaction(function(tx){tx.executeSql(ADD_ANSWER_HARD)},function(tx,er){console.log("add question hard Fail "+er),deferred.resolve()},function(e){console.log("add question hard Success"),deferred.resolve()}),deferred.promise}function checkExistsTest(id){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql("SELECT ZTEST FROM ZTESTSTATS WHERE ZTEST="+id,[],function(tx,results){null!=results.rows.item(0).ZTEST?deferred.resolve(results.rows.item(0).ZTEST):deferred.resolve(null)})},function(tx,err){console.log("check teststart if exists"+tx.message),deferred.resolve(null)}),deferred.promise}function addTestStart(basisErrorPoint,result,advancedErrorPoint,timestamp,userId,testId){var deferred=$q.defer(),ADD_TEST_START="INSERT INTO 'main'.'ZTESTSTATS' ('Z_ENT','Z_OPT','ZBASICERRORPOINTS','ZRESULT','ZEXTENDEDERRORPOINTS','ZTIMESTAMP','ZUSERID','ZTEST') SELECT '1','1','"+basisErrorPoint+"','"+result+"','"+advancedErrorPoint+"','"+timestamp+"','"+userId+"','"+testId+"' WHERE NOT EXISTS (SELECT 1 FROM 'ZTESTSTATS' WHERE ZTEST = "+testId+")";return mDB.transaction(function(tx){tx.executeSql(ADD_TEST_START)},function(tx,er){console.log("add test start Fail "+er),deferred.resolve()},function(e){console.log("add test start Success"),deferred.resolve()}),deferred.promise}function updateAnswerRight(id){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(UPDATE_ANSWER_RIGHT+id)},function(tx,er){console.log("update answer right Fail "+er),deferred.resolve()},function(e){console.log("update answer right Success"),deferred.resolve()}),deferred.promise}function updateAnswerWrong(id){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(UPDATE_ANSWER_WRONG+id)},function(tx,er){console.log("update answer wrong Fail "+er),deferred.resolve()},function(e){console.log("update answer wrong Success"),deferred.resolve()}),deferred.promise}function updateQuestionHard(id){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(UPDATE_QUESTION_HARD+id)},function(tx,er){console.log("update question hard Fail "+er),deferred.resolve()},function(e){console.log("update question hard Success"),deferred.resolve()}),deferred.promise}function updateQuestionUnHard(id){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(UPDATE_QUESTION_UN_HARD+id)},function(tx,er){console.log("update question un hard Fail "+er),deferred.resolve()},function(e){console.log("update question un hard Success"),deferred.resolve()}),deferred.promise}function updateTestStart(basisErrorPoint,result,advancedErrorPoint,timestamp,userId,testId){var deferred=$q.defer(),UPDATE_TEST_START="UPDATE ZTESTSTATS SET ZBASICERRORPOINTS = '"+basisErrorPoint+"',ZRESULT = '"+result+"',ZEXTENDEDERRORPOINTS = '"+advancedErrorPoint+"', ZTIMESTAMP = '"+timestamp+"',ZUSERID = '"+userId+"' WHERE  ZTEST = '"+testId+"'";return mDB.transaction(function(tx){tx.executeSql(UPDATE_TEST_START)},function(tx,er){console.log("update test start Fail "+er),deferred.resolve()},function(e){console.log("update test start Success"),deferred.resolve()}),deferred.promise}function selectQuestionStart(id){var deferred=$q.defer(),QUERY="SELECT ZQUESTION FROM ZQUESTIONSTATS WHERE ZQUESTION = "+id;return mDB.transaction(function(tx){tx.executeSql(QUERY,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).ZQUESTION):deferred.resolve(0)})},function(tx,err){console.log("check if exits all question fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectQuestionStartTest(id,i){var deferred=$q.defer(),QUERY="SELECT ZQUESTION FROM ZQUESTIONSTATS WHERE ZQUESTION = "+id;return mDB.transaction(function(tx){tx.executeSql(QUERY,[],function(tx,results){var item=new Object;item.ZQUESTION=null,item.number=i,null!=results.rows.item(0).ZQUESTION?(item.ZQUESTION=results.rows.item(0).ZQUESTION,item.number=i,deferred.resolve(item)):deferred.resolve(item)})},function(tx,err){console.log("check if exits all question fail"+tx.message);var item=new Object;item.ZQUESTION=null,item.number=i,deferred.resolve(item)}),deferred.promise}function selectTest(type){var deferred=$q.defer(),QUERY=PACKAGE_TEST_B+type+" LIMIT 1";return mDB.transaction(function(tx){tx.executeSql(QUERY,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0)):deferred.resolve(null)})},function(tx,err){console.log("select test"+tx.message),deferred.resolve(null)}),deferred.promise}function selectTestFree(type){var deferred=$q.defer(),QUERY=PACKAGE_TEST_B_FREE+type+" LIMIT 1";return mDB.transaction(function(tx){tx.executeSql(QUERY,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0)):deferred.resolve(null)})},function(tx,err){console.log("select test"+tx.message),deferred.resolve(null)}),deferred.promise}function checkQuestionVideo(id,i){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql("SELECT ZISVIDEO,ZFRAGENKATALOG FROM ZQUESTION WHERE ZID="+id,[],function(tx,results){var item=new Object;null!=results?(item.isVideo=results.rows.item(0).ZISVIDEO,item.number=i,item.prefix=results.rows.item(0).ZFRAGENKATALOG,deferred.resolve(item)):deferred.resolve(item)})},function(tx,err){console.log("check video if exists"+tx.message),deferred.resolve(null)}),deferred.promise}function selectQuestionByIdByTest(ID){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(SELECT_ALL_TEST+ID+") ORDER BY  ZFRAGENKATALOG",[],function(tx,results){var result=[];if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new Object;itemData.number=i,itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=data.ZISINPUT,itemData.ZPRETEXT=data.ZPRETEXT,itemData.ZIMAGE=data.ZIMAGE,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER2=data.ZANSWER2,itemData.ZANSWER3=data.ZANSWER3,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,itemData.ZQUESTION=data.ZQUESTION,itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZBIGIMAGE=data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=data.ZPRETEXTVN,itemData.ZQUESTIONVN=data.ZQUESTIONVN,itemData.ZTIPVN=data.ZTIPVN,itemData.ZANSWER3VN=data.ZANSWER3VN,itemData.ZANSWER2VN=data.ZANSWER2VN,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZDIFFICULT=data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,result.push(itemData)}deferred.resolve(result)}else deferred.resolve(result)})},function(tx,err){console.log("Select all QuestType fail"+tx.message),deferred.resolve(err)}),deferred.promise}function countTestStart(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_TEST_START,[],function(tx,results){results.rows.item(0).countTest>0?deferred.resolve(results.rows.item(0).countTest):deferred.resolve(null)})},function(tx,err){console.log("Count test start fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countTestStartRight(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_TEST_BESTANDEN,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countTest):deferred.resolve(results)})},function(tx,err){console.log("Count test start right fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectAllTestStart(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(GET_TEST_START,[],function(tx,results){results.rows.length>0?deferred.resolve(results.rows):deferred.resolve(null)})},function(tx,err){console.log("Select all test Start fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectAllQuestionB(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,
itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all QuestType fail"+tx.message),deferred.resolve(tx.message)}),deferred.promise}function selectAllQuestionFree(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_FREE+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all QuestType fail"+tx.message),deferred.resolve(tx.message)}),deferred.promise}function selectAllAnswerB(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_ANSWERED+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all answered fail"+tx.message),deferred.resolve(tx.message)}),deferred.promise}function selectAllNotAnswerB(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_NOT_ANSWERED+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,
itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all answered fail"+tx.message),deferred.resolve(tx.message)}),deferred.promise}function selectAllNotAnswerFree(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_NOT_ANSWERED_FREE+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all answered fail"+tx.message),deferred.resolve(tx.message)}),deferred.promise}function selectQuestionVideoB(type,callBack){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_VIDEO+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question video fail"+tx.message),deferred.resolve(err)}),deferred.promise}function selectQuestionNumberB(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_NUMBER+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question number fail"+tx.message),deferred.resolve(tx.message)}),deferred.promise}function selectQuestionVariantB(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_VARIANT+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),
itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question variant fail"+tx.message),deferred.resolve(tx.message)}),deferred.promise}function selectQuestionAnsweRightB(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_ANSWERED_RIGHT+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question answer right fail"+tx.message),deferred.resolve(tx.message)}),deferred.promise}function selectQuestionAnsweWrongB(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_ANSWERED_WRONG+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question answer wrong fail"+tx.message),deferred.resolve(err)}),deferred.promise}function selectQuestionHardB(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_QUESTION_HARD+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){deferred.resolve(err)}),deferred.promise}function selectQuestionByIdB(ZID){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_BY_ID+ZID,[],function(tx,results){var itemData=new Object;if(results.rows.length>0){var data=results.rows.item(0);itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=data.ZISINPUT,itemData.ZPRETEXT=data.ZPRETEXT,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE=data.ZIMAGE,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER2=data.ZANSWER2,itemData.ZANSWER3=data.ZANSWER3,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,itemData.ZQUESTION=data.ZQUESTION,itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZBIGIMAGE=data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=data.ZPRETEXTVN,itemData.ZQUESTIONVN=data.ZQUESTIONVN,itemData.ZTIPVN=data.ZTIPVN,itemData.ZANSWER3VN=data.ZANSWER3VN,itemData.ZANSWER2VN=data.ZANSWER2VN,
itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZDIFFICULT=data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,deferred.resolve(itemData)}else deferred.resolve(itemData)})},function(tx,err){console.log("Select question by id fail"+tx.message),deferred.resolve(err)}),deferred.promise}function selectAllQuestionThemB(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(SELECT_THEME_QUESTION,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new Object;itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZORDER=data.ZORDER,itemData.ZGROUP=data.ZGROUP,itemData.ZNAMEDE=data.ZNAME,itemData.ZNAMEVN=data.ZNAMEVN,itemData.ZICON="./img/catalogs/"+data.ZICON,itemData.ZPREFIX=data.ZPREFIX,itemData.ISSHOW=!(data.ZNAME.indexOf("(nicht belegt)")>-1),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all theme question fail"+tx.message),deferred.resolve()}),deferred.promise}function countQuestionB_All(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_ALL_B,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(0)})},function(tx,err){console.log("Count all question fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countAnsweredB_All(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_ANSWERED_B,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(null)})},function(tx,err){console.log("Count all answered all fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countAnsweredRightB_All(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_ANSWERED_RIGHT_B,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all answered right fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countAnsweredWrongB_All(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_ANSWERED_WRONG_B,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all answered wrong fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countQuestionHardB_All(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_QUESTION_HARD,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all question hard fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countQuestionNumberB_All(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_QUESTION_NUMBER_B,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all question to number fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countQuestionVariantB_All(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_QUESTION_VARIANT_B,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all question to variant fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countQuestionVideoB_All(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_QUESTION_VIDEO_B,[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all question to video fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countQuestionByTheme(theme){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_QUESTION_BY_THEME+"'%"+theme+".%'",[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all question by theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countQuestionByThemeFree(theme){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_QUESTION_BY_THEME+"'%"+theme+".%' AND ZTEST=1",[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all question by theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countAnsweredByTheme(theme){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_ANSWERED_THEME+"'%"+theme+"%'",[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all answered all theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countAnsweredRightByTheme(theme){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_ANSWERED_RIGHT_THEME+"'%"+theme+"%'",[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all answered right theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countAnsweredWrongByTheme(theme){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_ANSWERED_WRONG_THEME+"'%"+theme+"%'",[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all answered wrong theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function countQuestionHardByTheme(theme){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(COUNT_QUESTION_HARD_THEME+"'%"+theme+"%'",[],function(tx,results){null!=results?deferred.resolve(results.rows.item(0).countQuestion):deferred.resolve(results)})},function(tx,err){console.log("Count all question hard theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectQuestionByTheme(theme,type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_BY_THEME+"'%"+theme+"%'"+ORDER_BY+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question by theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectQuestionByThemeFree(theme,type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_BY_THEME_FREE+"'%"+theme+"%'"+ORDER_BY+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question by theme free fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectQuestionVideoFree(type,callBack){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_VIDEO_FREE+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,
itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question video fail"+tx.message),deferred.resolve(err)}),deferred.promise}function selectQuestionNumberFree(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_NUMBER_FREE+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question number fail"+tx.message),deferred.resolve(tx.message)}),deferred.promise}function selectQuestionVariantFree(type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_RANDOM_VARIANT_FREE+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question variant fail"+tx.message),deferred.resolve(tx.message)}),deferred.promise}function selectAnsweredByTheme(theme,type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_ANSWERED_THEME+"'%"+theme+"%'"+ORDER_BY+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all answered theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectNotAnsweredByTheme(theme,type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_NOT_ANSWERED_THEME+"'%"+theme+"%'"+ORDER_BY+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,
itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all not answered theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectNotAnsweredByThemeFree(theme,type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_NOT_ANSWERED_THEME_FREE+"'%"+theme+"%'"+ORDER_BY+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all not answered theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectAnswerRightByTheme(theme,type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_ANSWERED_RIGHT_THEME+"'%"+theme+"%'"+ORDER_BY+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all answer right theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectAnswerWrongByTheme(theme,type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_ANSWERED_WRONG_THEME+"'%"+theme+"%'"+ORDER_BY+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all answer wrong theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function selectQuestionHardByTheme(theme,type){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(QUESTION_QUESTION_HARD_THEME+"'%"+theme+"%'"+ORDER_BY+type,[],function(tx,results){var dataResult=new Array;if(results.rows.length>0){for(var i=0;i<results.rows.length;i++){var data=results.rows.item(i),itemData=new QuestionModel;if(itemData.Z_PK=data.Z_PK,itemData.Z_ENT=data.Z_ENT,itemData.Z_OPT=data.Z_OPT,itemData.ZID=data.ZID,itemData.ZTESTIMAGE=data.ZTESTIMAGE,itemData.ZUPDATE=data.ZUPDATE,itemData.ZISHTML=data.ZISHTML,itemData.ZISVIDEO=1==data.ZISVIDEO,itemData.ZOLDID=data.ZOLDID,itemData.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,itemData.ZL=data.ZL,itemData.ZPOINTS=data.ZPOINTS,itemData.ZTHEMA=data.ZTHEMA,itemData.ZQZG=data.ZQZG,itemData.ZVALID1=data.ZVALID1,itemData.ZVALID2=data.ZVALID2,itemData.ZVALID3=data.ZVALID3,itemData.ZISINPUT=1==data.ZISINPUT,itemData.ZANSWER1=data.ZANSWER1,itemData.ZANSWER1VN=data.ZANSWER1VN,itemData.ZISINPUT){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}itemData.ANSWERINPUTSTRING1TEMP=itemData.ANSWERINPUTSTRING1VN,itemData.ANSWERINPUTSTRING2TEMP=itemData.ANSWERINPUTSTRING2VN;
var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";itemData.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",itemData.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),itemData.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,itemData.ZISPRETEXT=null!=data.ZPRETEXT,itemData.ZIMAGE="img/"+data.ZIMAGE,itemData.ZISIMAGE=null!=data.ZIMAGE,itemData.ZANSWER1IMAGE=data.ZANSWER1IMAGE,itemData.ZANSWER2IMAGE=data.ZANSWER2IMAGE,itemData.ZANSWER3IMAGE=data.ZANSWER3IMAGE,itemData.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),itemData.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMMENTAR?data.ZKOMMENTAR:""))),itemData.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,itemData.ZTIP=data.ZTIP,itemData.ZKOMENTAR=data.ZKOMMENTAR,itemData.ZSETNAME=data.ZSETNAME,itemData.ZNOTUSED=data.ZNOTUSED,itemData.ZTYPE=data.ZTYPE,itemData.ZFRAGENKATALOG=data.ZFRAGENKATALOG,itemData.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,itemData.ZBIGIMAGE="img/"+data.ZBIGIMAGE,itemData.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,itemData.ZCOMMENTZ=data.ZCOMMENTZ,itemData.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,itemData.ZQUESTIONVN=$sce.trustAsHtml(data.ZQUESTIONVN),itemData.ZTIPVN=data.ZTIPVN,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),itemData.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,itemData.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,itemData.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,itemData.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,itemData.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,itemData.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,itemData.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,itemData.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,itemData.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,itemData.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,itemData.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,itemData.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,itemData.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,itemData.ZANSWER[0].isAnswer=null!=data.ZANSWER1,itemData.ZANSWER[1].isAnswer=null!=data.ZANSWER2,itemData.ZANSWER[2].isAnswer=null!=data.ZANSWER3,itemData.ZANSWER[0].checkAnswer=!1,itemData.ZANSWER[1].checkAnswer=!1,itemData.ZANSWER[2].checkAnswer=!1,itemData.ZDIFFICULT=1==data.ZDIFFICULT,itemData.ZTEST=1==data.ZTEST,itemData.ZQUESTIONTEMP=itemData.ZQUESTIONVN,itemData.ZANSWER[0].ZANSWER=itemData.ZANSWER[0].vn.ZANSWER,itemData.ZANSWER[1].ZANSWER=itemData.ZANSWER[1].vn.ZANSWER,itemData.ZANSWER[2].ZANSWER=itemData.ZANSWER[2].vn.ZANSWER,itemData.ZISVIDEO&&(itemData.ZVARIANT=!0),dataResult.push(itemData)}deferred.resolve(dataResult)}else deferred.resolve(dataResult)})},function(tx,err){console.log("Select all Question hard theme fail"+tx.message),deferred.resolve(null)}),deferred.promise}function ready(){var deferred=$q.defer();return cordova.ready.then(function(){mDB?(deferred.resolve(),console.log("b")):(mDB=window.sqlitePlugin.openDatabase({name:DB_NAME,location:"default",createFromLocation:1}),deferred.resolve(),console.log("a"))}),deferred.promise}function getVersion(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(VERSION_APP,[],function(tx,results){var item=new Object;item.versionApp=null,results.rows.length>0?(item.versionApp=results.rows.item(0).ZVALUE,deferred.resolve(item)):deferred.resolve(item)})},function(tx,err){console.log("Select version app fail"+tx.message),deferred.resolve(null)}),deferred.promise}function checkIsActive(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(CHECK_IS_ACTIVE,[],function(tx,results){var item=new Object;item.isActive=null,results.rows.length>0?(item.isActive="1"==results.rows.item(0).ZVALUE,deferred.resolve(item)):(item.isActive=!1,deferred.resolve(item))})},function(tx,err){console.log("Select active fail"+tx.message),deferred.resolve(!1)}),deferred.promise}function updateUserActive(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(UPDATE_USER_ACTIVE)},function(tx,er){console.log("update active Fail "+er),deferred.resolve()},function(e){console.log("update active Success"),deferred.resolve()}),deferred.promise}function updateUserName(username){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql("UPDATE ZSETTINGS SET ZVALUE = "+username+" WHERE ZKEY = 'UserName'")},function(tx,er){console.log("update username Fail "+er),deferred.resolve()},function(e){console.log("update username Success"),deferred.resolve()}),deferred.promise}function updateQuestionActive(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(UPDATE_ACTIVE_QUESTION)},function(tx,er){console.log("update active question Fail "+er),deferred.resolve()},function(e){console.log("update active question Success"),deferred.resolve()}),deferred.promise}function updateTestActive(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(UPDATE_ACTIVE_TEST)},function(tx,er){console.log("update active test Fail "+er),deferred.resolve()},function(e){console.log("update active test Success"),deferred.resolve()}),deferred.promise}function clearTest(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(DELETE_TEST_START)},function(tx,er){console.log("clear test Fail "+er),deferred.resolve()},function(e){console.log("clear test Success"),deferred.resolve()}),deferred.promise}function clearQuestion(){var deferred=$q.defer();return mDB.transaction(function(tx){tx.executeSql(DELETE_QUESTION_START)},function(tx,er){console.log("clear question Fail "+er),deferred.resolve()},function(e){console.log("clear question Success"),deferred.resolve()}),deferred.promise}function percentCalculation(a,b){return Math.floor(a/b*100)}var DB_NAME="auto.db",mDB=null,ORDER_BY=" ORDER BY ",COUNT_ALL_B="SELECT COUNT() AS countQuestion FROM ZQUESTION WHERE (ZTYPE LIKE '%,3,%')",COUNT_QUESTION_VIDEO_B="SELECT COUNT() AS countQuestion From ZQUESTION WHERE (ZTYPE LIKE '%,3,%') AND ZISVIDEO ='1'",COUNT_QUESTION_NUMBER_B="SELECT COUNT() AS countQuestion From ZQUESTION WHERE (ZTYPE LIKE '%,3,%') AND ZISINPUT  ='1'",COUNT_QUESTION_VARIANT_B="SELECT COUNT() AS countQuestion From ZQUESTION WHERE (ZTYPE LIKE '%,3,%') AND ((ZFRAGENKATALOG like '%-%-M%') OR (ZFRAGENKATALOG like '%-%-B%'))",COUNT_ANSWERED_B="SELECT COUNT() AS countQuestion From ZQUESTIONSTATS  WHERE ZUSERID =1 AND ZLASTRESULT >'-1'",COUNT_ANSWERED_RIGHT_B="SELECT COUNT() AS countQuestion From ZQUESTIONSTATS  WHERE ZUSERID =1 AND (ZLASTRESULT = 1)",COUNT_ANSWERED_WRONG_B="SELECT COUNT() AS countQuestion From ZQUESTIONSTATS  WHERE ZUSERID =1 AND (ZLASTRESULT = 0)",COUNT_QUESTION_HARD="SELECT COUNT() AS countQuestion From ZQUESTIONSTATS  WHERE ZUSERID =1 AND (ZDIFFICULT = 1)",COUNT_ANSWERED_B="SELECT COUNT() AS countQuestion From ZQUESTIONSTATS",QUESTION_RANDOM="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE (ZQUESTION.ZTYPE LIKE '%,3,%') ORDER BY ",QUESTION_RANDOM_FREE="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE ZQUESTION.ZTEST=1 AND  (ZQUESTION.ZTYPE LIKE '%,3,%') ORDER BY ",QUESTION_BY_ID="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE ZQUESTION.ZID = ",QUESTION_RANDOM_VIDEO="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE (ZTYPE LIKE '%,3,%') AND ZISVIDEO ='1' ORDER BY ",QUESTION_RANDOM_NUMBER="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE (ZTYPE LIKE '%,3,%') AND ZISINPUT  ='1' ORDER BY ",QUESTION_RANDOM_VARIANT="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE (ZTYPE LIKE '%,3,%') AND ((ZFRAGENKATALOG like '%-%-M%') OR (ZFRAGENKATALOG like '%-%-B%')) ORDER BY ",QUESTION_RANDOM_ANSWERED="SELECT ZQUESTION.*,ZQUESTIONSTATS.ZDIFFICULT From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND ZLASTRESULT >'-1' ORDER BY ",QUESTION_NOT_ANSWERED="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE (ZTYPE LIKE '%,3,%') AND ZID NOT IN (SELECT ZQUESTIONSTATS.ZQUESTION From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION  WHERE ZUSERID =1 AND ZLASTRESULT >'-1') ORDER BY ",QUESTION_NOT_ANSWERED_FREE="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE ZTEST=1 AND (ZTYPE LIKE '%,3,%') AND ZID NOT IN (SELECT ZQUESTIONSTATS.ZQUESTION From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION  WHERE ZUSERID =1 AND ZLASTRESULT >'-1') ORDER BY ",QUESTION_RANDOM_ANSWERED_RIGHT="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND (ZLASTRESULT = 1)  ORDER BY ",QUESTION_RANDOM_ANSWERED_WRONG="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND (ZLASTRESULT = 0)  ORDER BY ",QUESTION_RANDOM_QUESTION_HARD="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND (ZDIFFICULT = 1 )  ORDER BY ",PACKAGE_TEST_B="SELECT * FROM ZTEST WHERE ZKLASS = 'B' AND ZERSTEODERERWEITERUNG = '1' ORDER BY ",SELECT_ALL_TEST="SELECT * FROM ZQUESTION WHERE ZID IN (",QUESTION_RANDOM_VIDEO_FREE="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE (ZTYPE LIKE '%,3,%') AND ZISVIDEO ='1' AND ZTEST=1 ORDER BY ",QUESTION_RANDOM_NUMBER_FREE="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE (ZTYPE LIKE '%,3,%') AND ZISINPUT  ='1' AND ZTEST=1 ORDER BY ",QUESTION_RANDOM_VARIANT_FREE="SELECT ZQUESTION.*, ZQUESTIONSTATS.ZDIFFICULT FROM ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE (ZTYPE LIKE '%,3,%') AND ((ZFRAGENKATALOG like '%-%-M%') OR (ZFRAGENKATALOG like '%-%-B%')) AND ZTEST=1 ORDER BY ",QUESTION_BY_THEME_FREE="SELECT ZQUESTION.*, ZQUESTION.Z_PK,ZQUESTIONSTATS.ZDIFFICULT From ZQUESTION LEFT OUTER JOIN  ZQUESTIONSTATS ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE (ZTYPE LIKE '%,3,%') AND ZTEST=1 AND ZFRAGENKATALOG LIKE ",QUESTION_NOT_ANSWERED_THEME_FREE="SELECT ZQUESTION.*,ZQUESTIONSTATS.ZDIFFICULT From ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE (ZTYPE LIKE '%,3,%') AND ZQUESTION.ZTEST=1 AND ZID NOT IN (SELECT ZQUESTIONSTATS.ZQUESTION From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION  WHERE ZUSERID =1 AND ZLASTRESULT >'-1') and ZFRAGENKATALOG LIKE ",PACKAGE_TEST_B_FREE="SELECT * FROM ZTEST WHERE ZKLASS = 'B' AND ZERSTEODERERWEITERUNG = '1' AND ZPRO=0 ORDER BY ",UPDATE_QUESTION_HARD="UPDATE ZQUESTIONSTATS SET ZDIFFICULT = 1 WHERE  ZQUESTION = ",UPDATE_QUESTION_UN_HARD="UPDATE ZQUESTIONSTATS SET ZDIFFICULT = 0 WHERE  ZQUESTION = ",UPDATE_ANSWER_RIGHT="UPDATE ZQUESTIONSTATS SET ZRIGHTCOUNT = ZRIGHTCOUNT+1, ZLASTRESULT = 1 WHERE  ZQUESTION = ",UPDATE_ANSWER_WRONG="UPDATE ZQUESTIONSTATS SET ZWRONGCOUNT =ZWRONGCOUNT+1, ZLASTRESULT= 0 WHERE  ZQUESTION = ",DELETE_QUESTION_START="DELETE FROM ZQUESTIONSTATS",SELECT_THEME_QUESTION="SELECT * FROM ZQUESTIONTHEME",COUNT_QUESTION_BY_THEME="SELECT COUNT() AS countQuestion FROM ZQUESTION WHERE  (ZTYPE LIKE '%,3,%')  and ZFRAGENKATALOG LIKE ",COUNT_ANSWERED_THEME="SELECT COUNT() AS countQuestion From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND ZLASTRESULT >'-1' and ZFRAGENKATALOG LIKE ",COUNT_ANSWERED_RIGHT_THEME="SELECT COUNT() AS countQuestion From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND (ZLASTRESULT = 1) and ZFRAGENKATALOG LIKE ",COUNT_ANSWERED_WRONG_THEME="SELECT COUNT() AS countQuestion From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND (ZLASTRESULT = 0) and ZFRAGENKATALOG LIKE ",COUNT_QUESTION_HARD_THEME="SELECT COUNT() AS countQuestion From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND (ZDIFFICULT = 1) and ZFRAGENKATALOG LIKE ",GET_TEST_START="SELECT * From ZTESTSTATS",COUNT_TEST_START="SELECT COUNT() AS countTest,* From ZTESTSTATS",COUNT_TEST_BESTANDEN="SELECT COUNT() AS countTest From ZTESTSTATS WHERE ZRESULT = '1'",DELETE_TEST_START="DELETE FROM ZTESTSTATS",QUESTION_BY_THEME="SELECT ZQUESTION.*, ZQUESTION.Z_PK,ZQUESTIONSTATS.ZDIFFICULT From ZQUESTION LEFT OUTER JOIN  ZQUESTIONSTATS ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE (ZTYPE LIKE '%,3,%') AND ZFRAGENKATALOG LIKE ",QUESTION_ANSWERED_THEME="SELECT ZQUESTION.*,ZQUESTIONSTATS.ZDIFFICULT From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND ZLASTRESULT >'-1' AND ZFRAGENKATALOG LIKE ",QUESTION_NOT_ANSWERED_THEME="SELECT ZQUESTION.*,ZQUESTIONSTATS.ZDIFFICULT From ZQUESTION LEFT JOIN ZQUESTIONSTATS ON ZQUESTIONSTATS.ZQUESTION = ZQUESTION.ZID WHERE (ZTYPE LIKE '%,3,%') AND ZID NOT IN (SELECT ZQUESTIONSTATS.ZQUESTION From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION  WHERE ZUSERID =1 AND ZLASTRESULT >'-1') and ZFRAGENKATALOG LIKE ",QUESTION_ANSWERED_RIGHT_THEME="SELECT ZQUESTION.*,ZQUESTIONSTATS.ZDIFFICULT From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND (ZLASTRESULT = 1) AND ZFRAGENKATALOG LIKE ",QUESTION_ANSWERED_WRONG_THEME="SELECT ZQUESTION.*,ZQUESTIONSTATS.ZDIFFICULT From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND (ZLASTRESULT = 0) AND ZFRAGENKATALOG LIKE ",QUESTION_QUESTION_HARD_THEME="SELECT ZQUESTION.*,ZQUESTIONSTATS.ZDIFFICULT From ZQUESTIONSTATS LEFT OUTER JOIN  ZQUESTION ON ZQUESTION.ZID = ZQUESTIONSTATS.ZQUESTION WHERE ZUSERID =1 AND (ZDIFFICULT = 1 ) AND ZFRAGENKATALOG LIKE ",VERSION_APP="SELECT ZVALUE FROM ZSETTINGS WHERE ZKEY = 'DBVersion'",CHECK_IS_ACTIVE="SELECT ZVALUE FROM ZSETTINGS WHERE ZKEY = 'IsActive'",UPDATE_USER_ACTIVE="UPDATE ZSETTINGS SET ZVALUE = 1 WHERE ZKEY = 'IsActive'",UPDATE_ACTIVE_QUESTION="UPDATE ZQUESTION SET ZTEST=0 WHERE ZTEST=0",UPDATE_ACTIVE_TEST="UPDATE ZTEST SET ZPRO=1 WHERE ZPRO=0",utils=new Utils($http);DatabaseManager.prototype.ready=ready,DatabaseManager.prototype.updateQuestionActive=updateQuestionActive,DatabaseManager.prototype.updateTestActive=updateTestActive,DatabaseManager.prototype.clearTest=clearTest,DatabaseManager.prototype.clearQuestion=clearQuestion,DatabaseManager.prototype.getVersion=getVersion,DatabaseManager.prototype.checkIsActive=checkIsActive,DatabaseManager.prototype.updateUserActive=updateUserActive,DatabaseManager.prototype.updateUserName=updateUserName,DatabaseManager.prototype.percentCalculation=percentCalculation,DatabaseManager.prototype.checkIfExistsQuestion=selectQuestionStart,DatabaseManager.prototype.checkIfExistsQuestionTest=selectQuestionStartTest,DatabaseManager.prototype.addAnswerRight=addAnswerRight,DatabaseManager.prototype.addAnswerWrong=addAnswerWrong,DatabaseManager.prototype.addQuestionHard=addQuestionHard,DatabaseManager.prototype.updateAnswerRight=updateAnswerRight,DatabaseManager.prototype.updateAnswerWrong=updateAnswerWrong,DatabaseManager.prototype.updateQuestionHard=updateQuestionHard,DatabaseManager.prototype.updateQuestionUnHard=updateQuestionUnHard,DatabaseManager.prototype.selectAllQuestionRandom=selectAllQuestionB,DatabaseManager.prototype.selectAllQuestionFree=selectAllQuestionFree,DatabaseManager.prototype.selectAllAnswered=selectAllAnswerB,DatabaseManager.prototype.selectAllNotAnswered=selectAllNotAnswerB,DatabaseManager.prototype.selectAllNotAnsweredFree=selectAllNotAnswerFree,DatabaseManager.prototype.selectAllQuestionVideo=selectQuestionVideoB,DatabaseManager.prototype.selectAllQuestionNumber=selectQuestionNumberB,DatabaseManager.prototype.selectAllQuestionVariant=selectQuestionVariantB,DatabaseManager.prototype.selectAllAnswerRight=selectQuestionAnsweRightB,DatabaseManager.prototype.selectAllAnswerWrong=selectQuestionAnsweWrongB,DatabaseManager.prototype.selectAllQuestionHard=selectQuestionHardB,DatabaseManager.prototype.selectAllQuestionVideoFree=selectQuestionVideoFree,DatabaseManager.prototype.selectAllQuestionNumberFree=selectQuestionNumberFree,DatabaseManager.prototype.selectAllQuestionVariantFree=selectQuestionVariantFree,DatabaseManager.prototype.selectAllQuestionTheme=selectAllQuestionThemB,DatabaseManager.prototype.countQuestionAll=countQuestionB_All,DatabaseManager.prototype.countAnsweredAll=countAnsweredB_All,DatabaseManager.prototype.countAnsweredRightAll=countAnsweredRightB_All,DatabaseManager.prototype.countAnsweredWrongAll=countAnsweredWrongB_All,DatabaseManager.prototype.countQuestionHardAll=countQuestionHardB_All,DatabaseManager.prototype.countQuestionNumberAll=countQuestionNumberB_All,DatabaseManager.prototype.countQuestionVariantAll=countQuestionVariantB_All,DatabaseManager.prototype.countQuestionVideoAll=countQuestionVideoB_All,DatabaseManager.prototype.selectQuestionById=selectQuestionByIdB,DatabaseManager.prototype.searchQuestion=search,DatabaseManager.prototype.countQuestionByTheme=countQuestionByTheme,DatabaseManager.prototype.countQuestionByThemeFree=countQuestionByThemeFree,DatabaseManager.prototype.countAnsweredByTheme=countAnsweredByTheme,DatabaseManager.prototype.countAnsweredRightByTheme=countAnsweredRightByTheme,DatabaseManager.prototype.countAnsweredWrongByTheme=countAnsweredWrongByTheme,DatabaseManager.prototype.countQuestionHardByTheme=countQuestionHardByTheme,DatabaseManager.prototype.selectQuestionByTheme=selectQuestionByTheme,DatabaseManager.prototype.selectQuestionByThemeFree=selectQuestionByThemeFree,DatabaseManager.prototype.selectAllAnsweredByTheme=selectAnsweredByTheme,DatabaseManager.prototype.selectAllNotAnsweredByTheme=selectNotAnsweredByTheme,DatabaseManager.prototype.selectAllNotAnsweredByThemeFree=selectNotAnsweredByThemeFree,DatabaseManager.prototype.selectAllAnswerRightByTheme=selectAnswerRightByTheme,DatabaseManager.prototype.selectAllAnswerWrongByTheme=selectAnswerWrongByTheme,DatabaseManager.prototype.selectQuestionHardByTheme=selectQuestionHardByTheme,DatabaseManager.prototype.selectTestPackage=selectTest,DatabaseManager.prototype.selectTestPackageFree=selectTestFree,DatabaseManager.prototype.checkQuestionVideo=checkQuestionVideo,DatabaseManager.prototype.selectQuestionByIdByTest=selectQuestionByIdByTest,DatabaseManager.prototype.addTestStart=addTestStart,DatabaseManager.prototype.updateTestStart=updateTestStart,DatabaseManager.prototype.checkExistsTest=checkExistsTest,DatabaseManager.prototype.countTestStart=countTestStart,DatabaseManager.prototype.countTestStartRight=countTestStartRight,DatabaseManager.prototype.selectAllTestStart=selectAllTestStart}return new DatabaseManager}])}();var adsEnabled=!1,upgradeEnabled=!1;if("free"==appVersion)var adsEnabled=!0,upgradeEnabled=!0;var admobid={};admobid=/(android)/i.test(navigator.userAgent)?{banner:"ca-app-pub-7887128767743361/7828509138",interstitial:"ca-app-pub-7887128767743361/9305242337"}:/(ipod|iphone|ipad)/i.test(navigator.userAgent)?{banner:"ca-app-pub-7887128767743361/1921576338",interstitial:"ca-app-pub-7887128767743361/3398309538"}:{banner:"ca-app-pub-7887128767743361/1921576338",interstitial:"ca-app-pub-7887128767743361/3398309538"},function(){"use strict";angular.module("TrafficLaws",["ionic","ui.router","TrafficLaws.cordovaService","TrafficLaws.databaseService","TrafficLaws.HomeController","TrafficLaws.SearchController","TrafficLaws.CategoriesController","TrafficLaws.QuestionController","TrafficLaws.SettingController","TrafficLaws.QuestionSearchController","TrafficLaws.connectService","TrafficLaws.TestController","TrafficLaws.ThemeController"]).run(function($ionicPlatform){$ionicPlatform.ready(function(){ionic.Platform.isAndroid()&&window.downloadAssets();var changeLanguageEnabled=JSON.parse(window.localStorage.getItem("CHANGE_LANGUAGE_ENABLED"));if(1!=changeLanguageEnabled&&0!=changeLanguageEnabled&&(window.localStorage.setItem("CHANGE_LANGUAGE_ENABLED",!1),changeLanguageEnabled=!1),window.adsEnabled&&!changeLanguageEnabled){window.initAds();var clickCount=0;document.addEventListener("click",function(){clickCount++,clickCount%10!=0||changeLanguageEnabled||initInterstitialAds()})}window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.plugins&&window.plugins.NativeAudio&&(window.plugins.NativeAudio.preloadSimple("error","audio/error.wav",function(msg){console.info(msg)},function(msg){console.error("Error: "+msg)}),window.plugins.NativeAudio.preloadSimple("hard","audio/hard.wav",function(msg){console.info(msg)},function(msg){console.error("Error: "+msg)}),window.plugins.NativeAudio.preloadSimple("next","audio/next.wav",function(msg){console.info(msg)},function(msg){console.error("Error: "+msg)}),window.plugins.NativeAudio.preloadSimple("right","audio/right.wav",function(msg){console.info(msg)},function(msg){console.error("Error: "+msg)}),window.plugins.NativeAudio.preloadSimple("lang","audio/lang.mp3",function(msg){console.info(msg)},function(msg){console.error("Error: "+msg)}),window.plugins.NativeAudio.preloadSimple("flap","audio/flap.mp3",function(msg){console.info(msg)},function(msg){console.error("Error: "+msg)})),window.StatusBar&&StatusBar.styleLightContent(),navigator.splashscreen&&(console.warn("Hiding splash screen"),navigator.splashscreen.hide()),"android"==cordova.platformId&&StatusBar.backgroundColorByHexString("#181B3D"),ionic.Platform.isFullScreen=!0})}).config(function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("home",{url:"/home",templateUrl:"pages/home.html",controller:"HomeCtrl"}).state("search",{url:"/search",templateUrl:"pages/search.html",controller:"SearchCtrl"}).state("categories",{url:"/categories",templateUrl:"pages/categories.html",controller:"CategoriesCtrl"}).state("test",{url:"/test",templateUrl:"pages/test.html",controller:"TestCtrl"}).state("statistic",{url:"/statistic",templateUrl:"pages/statistic.html",controller:"StatisticCtrl"}).state("statistic2",{url:"/statistic2",templateUrl:"pages/statistic2.html",controller:"Statistic2Ctrl"}).state("listQuestion",{url:"/listQuestion/:LID/:THEME",templateUrl:"pages/listQuestion.html",controller:"QuestionItemCtrl"}).state("question",{url:"/question/:menuQuestion",templateUrl:"pages/question.html",controller:"QuestionCtrl"}).state("questionSearch",{url:"/questionSearch/:ZId",templateUrl:"pages/questionItem.html",controller:"QuestionSearchCtrl"}).state("setting",{url:"/setting",templateUrl:"pages/setting.html",controller:"SettingCtrl"})}).controller("MasterCtrl",function($scope,$rootScope,$ionicPopup,$window,$q,$state,$sce,cordova,db,$timeout,$http,$ionicLoading,connect){function onBackKey(event){event.preventDefault()}function onBack(){$rootScope.isSetting||$rootScope.isBack?$rootScope.isBack&&($rootScope.isSearch?($rootScope.isSearch=!1,$state.go("home",{},{location:"replace"})):1==$rootScope.startApp||$rootScope.questionTheme||$rootScope.isClear?($rootScope.questionTheme||$rootScope.statistic1||$rootScope.statistic2||$window.history.back(),$rootScope.question||$rootScope.isClear||$rootScope.statistic2?!$rootScope.isClear||$rootScope.statistic1||$rootScope.statistic2?$rootScope.isBack&&$rootScope.question&&!$rootScope.questionTheme?($rootScope.question=!1,$rootScope.isBack=!1,$rootScope.titleAll=""):$rootScope.questionTheme?($window.history.back(),$rootScope.questionTheme=!1):$rootScope.statistic1&&($rootScope.statistic1=!1,$rootScope.$broadcast("backStastic")):($rootScope.isBack=!1,$rootScope.isClear=!1,$rootScope.titleAll=""):($rootScope.isBack=!1,$rootScope.titleAll=""),$rootScope.statistic2&&($window.history.back(),$rootScope.statistic2=!1),$rootScope.isSetting&&($rootScope.isSearch?$rootScope.isBack=!0:$rootScope.isSetting=!1),$rootScope.isSearch=!1):($state.go("home",{},{location:"replace"}),$rootScope.isBack=!1,$rootScope.isSearch=!1,$rootScope.question=!1)):$state.go("setting",{},{})}$rootScope.language=1,$rootScope.showChangeLanguageBtn=!0,$rootScope.changeLanguageEnabled=!1,$rootScope.Menu=MENU,$scope.backApp=!1,$rootScope.isBack=!1,$rootScope.isSearch=!1,$rootScope.isClear=!1,$rootScope.isSetting=!1,$rootScope.question=!1,$rootScope.questionTheme=!1,$rootScope.statistic1=!1,$rootScope.statistic2=!1,$rootScope.versionApp=null,$rootScope.isActive=!1,$rootScope.yearApp=(new Date).getUTCFullYear(),$rootScope.appSite=$rootScope.Menu.vn.app,$rootScope.appDidLoad=!1,$rootScope.startApp=JSON.parse($window.localStorage.getItem("START_APP")),$rootScope.assetsPath="",$rootScope.isWideScreen=window.screen.width>641,null!=$rootScope.startApp&&void 0!=$rootScope.startApp||($rootScope.startApp=1,$window.localStorage.setItem("START_APP",$rootScope.startApp)),db.ready().then(function(){db.getVersion().then(function(version){$rootScope.versionApp=version.versionApp,db.checkIsActive().then(function(data){switch($rootScope.isActive=data.isActive,$rootScope.isActive=!0,$rootScope.$broadcast("active"),db.updateUserActive().then(function(){}),$rootScope.startApp){case 1:$state.go("home",{},{});break;case 2:connect.getAllQuestion().then(function(data){$state.go("question",{menuQuestion:JSON.stringify(data)},{})});break;case 3:$state.go("test",{},{})}})})}),$rootScope.questionRandom=JSON.parse($window.localStorage.getItem("QUESTION_RANDOM")),$rootScope.answeredRandom=JSON.parse($window.localStorage.getItem("ANSWERED_RANDOM")),$rootScope.audio=JSON.parse($window.localStorage.getItem("AUDIO")),$scope.languageText=0==$rootScope.language?"DE":"VN",null==$rootScope.questionRandom&&($window.localStorage.setItem("QUESTION_RANDOM",!1),$rootScope.questionRandom=!1),null==$rootScope.answeredRandom&&($window.localStorage.setItem("ANSWERED_RANDOM",!1),$rootScope.answeredRandom=!1),null==$rootScope.audio&&($window.localStorage.setItem("AUDIO",!0),$rootScope.audio=!0),$rootScope.changeLanguageEnabled=JSON.parse($window.localStorage.getItem("CHANGE_LANGUAGE_ENABLED")),null==$rootScope.changeLanguageEnabled&&($window.localStorage.setItem("CHANGE_LANGUAGE_ENABLED",!1),$rootScope.changeLanguageEnabled=!1),document.addEventListener("offline",function(){$scope.netwokPopup=$ionicPopup.show({cssClass:"center",template:'<i class="fa fa-exclamation-triangle fa-2x" aria-hidden="true"></i><br><br>Network not available',title:"Error"})},!1),document.addEventListener("online",function(){$scope.netwokPopup&&$scope.netwokPopup.close()},!1),document.addEventListener("backbutton",onBackKey,!1),$scope.setting=function(event){onBack()},$scope.changeLanguage=function(){$rootScope.changeLanguageEnabled=JSON.parse($window.localStorage.getItem("CHANGE_LANGUAGE_ENABLED")),$rootScope.changeLanguageEnabled?(0==$rootScope.language?$rootScope.language=1:$rootScope.language=0,$scope.languageText=0==$rootScope.language?"DE":"VN",$rootScope.$broadcast("changeLanguage"),$rootScope.audio&&$rootScope.$broadcast("playaudio","lang")):showActivePopup()};var showActivePopup=function(){$scope.data={},$scope.activePopup=$ionicPopup.show({template:'<input type="text" placeholder="Nhập code" ng-enter="codeInputEnter()" ng-model="data.code">',title:"Nâng cấp",subTitle:"Mở gói tiếng Việt",scope:$scope,buttons:[{text:"Hủy",type:"button-stable"},{text:"OK",type:"button-dark",onTap:function(e){return $scope.data.code?$scope.data.code:void e.preventDefault()}}]}),$scope.activePopup.then(function(res){console.log("Tapped!",res),void 0!=res&&activeCode()})};$scope.codeInputEnter=function(){$window.cordova.plugins.Keyboard.close(),$scope.activePopup.close(),activeCode()};var activeCode=function(){$ionicLoading.show({template:'<ion-spinner icon="lines"></ion-spinner>'});var url="http://thilaixe.de/check_code?code="+$scope.data.code;$http.get(url).success(function(response){response.success?($window.localStorage.setItem("CHANGE_LANGUAGE_ENABLED",!0),$rootScope.changeLanguageEnabled=!0,$ionicPopup.alert({title:"Thông báo",cssClass:"center",
template:"Bạn đã nâng cấp thành công",okType:"button-dark"})):($window.localStorage.setItem("CHANGE_LANGUAGE_ENABLED",!1),$rootScope.changeLanguageEnabled=!1,$ionicPopup.alert({title:"Thông báo",cssClass:"center",template:"Code không hợp lệ.<br>Vui lòng kiểm tra lại",okType:"button-dark"})),$ionicLoading.hide()})};$scope.openSearch=function(){$rootScope.isSearch||$rootScope.isClear?$rootScope.isClear&&($ionicLoading.show({template:'<ion-spinner icon="lines"></ion-spinner>',hideOnStateChange:!0,noBackdrop:!0}),$rootScope.statistic2&&db.clearTest().then(function(){$rootScope.$broadcast("reloadStatistic")}),$rootScope.statistic1&&db.clearQuestion().then(function(){$rootScope.$broadcast("reloadStatistic1")}),$rootScope.statistic1||$rootScope.statistic2||(db.clearTest().then(function(){}),db.clearQuestion().then(function(){})),$timeout(function(){$ionicLoading.show({template:'<ion-spinner icon="lines"></ion-spinner>',hideOnStateChange:!0,noBackdrop:!0})},1e3)):$state.go("search",{},{})},$rootScope.isShowAlertVersion=!1,$rootScope.isShowAlertVersionTest=!0,$rootScope.showActiveTest=!1,$rootScope.showActiveQuestion=!1,$scope.$on("playaudio",function(event,src){window.plugins.NativeAudio.play(src,function(msg){console.info(msg)},function(msg){console.error("Error: "+msg)},function(msg){console.error("Complete: "+msg)})})})}(),function(){"use strict";angular.module("TrafficLaws.HomeController",["ui.router","TrafficLaws.connectService","TrafficLaws.databaseService"]).controller("HomeCtrl",function($scope,$rootScope,$q,db,$state,$window,$timeout,$ionicLoading,connect){function init(){0==$rootScope.language?($scope.appName=$rootScope.Menu.vn.app_name+($rootScope.isActive?$rootScope.Menu.vn.version_full:$rootScope.Menu.vn.version_free),$scope.version=$rootScope.Menu.vn.version,$scope.licenceApp=$rootScope.Menu.vn.licence,$scope.listMenu=[{name:$rootScope.Menu.vn.question,event:2,icon:"fa-folder-open-o"},{name:$rootScope.Menu.vn.test,event:3,icon:"fa-clock-o"},{name:$rootScope.Menu.vn.search,event:4,icon:"fa-search"},{name:$rootScope.Menu.vn.setting,event:6,icon:"fa-cog"}],$window.upgradeEnabled&&$scope.listMenu.push({name:$rootScope.Menu.vn.buy_pro,event:7,icon:"fa-star"})):($scope.appName=$rootScope.Menu.de.app_name+($rootScope.isActive?$rootScope.Menu.de.version_full:$rootScope.Menu.de.version_free),$scope.version=$rootScope.Menu.de.version,$scope.licenceApp=$rootScope.Menu.de.licence,$scope.listMenu=[{name:$rootScope.Menu.de.question,event:2,icon:"fa-folder-open-o"},{name:$rootScope.Menu.de.test,event:3,icon:"fa-clock-o"},{name:$rootScope.Menu.de.search,event:4,icon:"fa-search"},{name:$rootScope.Menu.de.setting,event:6,icon:"fa-cog"}],$window.upgradeEnabled&&$scope.listMenu.push({name:$rootScope.Menu.de.buy_pro,event:7,icon:"fa-star"})),$scope.$$phase?$timeout(function(){$scope.$apply()},500):$scope.$apply()}function openProApp(){"android"==cordova.platformId?cordova.plugins.market.open("eu.vietplus.fahrschulpro"):cordova.plugins.market.open("id1111527349")}$scope.menuQuestionCount=new QuestionMenu,"android"==cordova.platformId?$rootScope.assetsPath=cordova.file.externalDataDirectory+"/fahrschul/assets/":$rootScope.assetsPath=cordova.file.applicationDirectory+"/www/",init(),$scope.$on("changeLanguage",function(event){$scope.isLanguage=$rootScope.language,init()}),$scope.$on("active",function(event){0==$rootScope.language?$scope.appName=$rootScope.Menu.vn.app_name+($rootScope.isActive?$rootScope.Menu.vn.version_full:$rootScope.Menu.vn.version_free):$scope.appName=$rootScope.Menu.de.app_name+($rootScope.isActive?$rootScope.Menu.de.version_full:$rootScope.Menu.de.version_free)}),$scope.open=function(event){switch(event){case 2:$state.go("categories",{},{});break;case 3:$state.go("test",{},{});break;case 4:$state.go("search",{},{});break;case 5:$state.go("statistic",{},{});break;case 6:$state.go("setting",{},{});break;case 7:openProApp()}}})}(),function(){"use strict";angular.module("TrafficLaws.SearchController",["ui.router"]).controller("SearchCtrl",function($scope,$rootScope,$q,db,$timeout,$state,$sce,$http){function searchQuestions(){$scope.searchInput.length>0&&$scope.searchInput.length%2==0?db.searchQuestion($scope.searchInput,$rootScope.isActive).then(function(data){if($scope.listSearch=[],null!=data){for(var i=0;i<data.length;i++){var item=new Object,k=data.item(i).ZQUESTION.indexOf("<br");k>-1&&(data.item(i).ZQUESTION=data.item(i).ZQUESTION.substring(0,k));var length=data.item(i).ZQUESTION.length>55;length&&(data.item(i).ZQUESTION=data.item(i).ZQUESTION.substring(0,55)+"...");var j=data.item(i).ZQUESTIONVN.indexOf("<br");k>-1&&(data.item(i).ZQUESTIONVN=data.item(i).ZQUESTIONVN.substring(0,j));var length=data.item(i).ZQUESTIONVN.length>55;length&&(data.item(i).ZQUESTIONVN=data.item(i).ZQUESTIONVN.substring(0,55)+"..."),item.ZQUESTION=null!=data.item(i).ZQUESTION?$sce.trustAsHtml(utils.convertText(data.item(i).ZQUESTION)):null,item.ZQUESTIONVN=null!=data.item(i).ZQUESTIONVN?$sce.trustAsHtml(data.item(i).ZQUESTIONVN):null,0==$rootScope.language?item.ZQUESTIONTEMP=item.ZQUESTIONVN:item.ZQUESTIONTEMP=item.ZQUESTION,item.ZID=data.item(i).ZID,item.ZFRAGENKATALOG=data.item(i).ZFRAGENKATALOG,$scope.listSearch.push(item)}$scope.$$phase?$timeout(function(){$scope.$apply()},500):$scope.$apply()}}):$scope.listSearch=[]}$scope.listSearch=[],$scope.onText=!1,$rootScope.isBack=!0,$rootScope.isSearch=!0,$rootScope.isClear=!1;var utils=new Utils($http);$scope.searchInput="",0==$rootScope.language?$rootScope.titleAll=$rootScope.Menu.vn.search_question:$rootScope.titleAll=$rootScope.Menu.de.search_question,$scope.$on("changeLanguage",function(event){if($scope.isLanguage=$rootScope.language,$rootScope.isSearch){0==$rootScope.language?$rootScope.titleAll=$rootScope.Menu.vn.search_question:$rootScope.titleAll=$rootScope.Menu.de.search_question;for(var i=0;i<$scope.listSearch.length;i++)0==$rootScope.language?$scope.listSearch[i].ZQUESTIONTEMP=$scope.listSearch[i].ZQUESTIONVN:$scope.listSearch[i].ZQUESTIONTEMP=$scope.listSearch[i].ZQUESTION}}),$scope.clearTextSearch=function(){$scope.searchInput="",$scope.listSearch=[]};$scope.changeSearch=function(event){searchQuestions(),$scope.searchInput.length>0?$scope.onText=!0:$scope.onText=!1},$scope.enterSearch=function(event){searchQuestions()},$scope.openQuestion=function(event){$rootScope.isSearch=!1,$state.go("questionSearch",{ZId:event},{})}})}(),function(){"use strict";angular.module("TrafficLaws.ThemeController",["ui.router","TrafficLaws.databaseService"]).controller("QuestionByThemeCtrl",function($scope,$rootScope,$timeout,$q,$state,db){function initListMenu(){0==$rootScope.language?($scope.MenuQuestionItem.klass=$rootScope.Menu.vn.klass,$scope.MenuQuestionItem.codeQuestion=$rootScope.Menu.vn.code_question,$scope.MenuQuestionItem.point=$rootScope.Menu.vn.point,$scope.MenuQuestionItem.back=$rootScope.Menu.vn.cancel,$scope.MenuQuestionItem.previos=$rootScope.Menu.vn.previos_question,$scope.MenuQuestionItem.next=$rootScope.Menu.vn.next_question,$scope.MenuQuestionItem.viewResult=$rootScope.Menu.vn.view_result,$scope.divider1=$rootScope.Menu.vn.klass,$scope.divider2=$rootScope.Menu.vn.basic_divider,$scope.divider3=$rootScope.Menu.vn.advanced_divider,$scope.menuQuestion=[{name:$rootScope.Menu.vn.all_question,event:1,number:"",percent:"",icon:"fa-folder-open-o"},{name:$rootScope.Menu.vn.answered,event:2,number:"",percent:"",icon:"fa-file-text-o"},{name:$rootScope.Menu.vn.answered_right,event:3,number:"",percent:"",icon:"fa-calendar-check-o"},{name:$rootScope.Menu.vn.answered_wrong,event:4,number:"",percent:"",icon:"fa-calendar-times-o"},{name:$rootScope.Menu.vn.hard_question,event:5,number:"",percent:"",icon:"fa-bookmark-o"},{name:$rootScope.Menu.vn.not_answered,event:6,number:"",percent:"",icon:"fa-file-o"}]):($scope.MenuQuestionItem.klass=$rootScope.Menu.de.klass,$scope.MenuQuestionItem.codeQuestion=$rootScope.Menu.de.code_question,$scope.MenuQuestionItem.point=$rootScope.Menu.de.point,$scope.MenuQuestionItem.back=$rootScope.Menu.de.cancel,$scope.MenuQuestionItem.previos=$rootScope.Menu.de.previos_question,$scope.MenuQuestionItem.next=$rootScope.Menu.de.next_question,$scope.MenuQuestionItem.viewResult=$rootScope.Menu.de.view_result,$scope.menuQuestion=[{name:$rootScope.Menu.de.all_question,event:1,number:"",percent:"",icon:"fa-folder-open-o"},{name:$rootScope.Menu.de.answered,event:2,number:"",percent:"",icon:"fa-file-text-o"},{name:$rootScope.Menu.de.answered_right,event:3,number:"",percent:"",icon:"fa-calendar-check-o"},{name:$rootScope.Menu.de.answered_wrong,event:4,number:"",percent:"",icon:"fa-calendar-times-o"},{name:$rootScope.Menu.de.hard_question,event:5,number:"",percent:"",icon:"fa-bookmark-o"},{name:$rootScope.Menu.de.not_answered,event:6,number:"",percent:"",icon:"fa-file-o"}])}function init(){0==$rootScope.language?($scope.MenuQuestionItem.klass=$rootScope.Menu.vn.klass,$scope.MenuQuestionItem.codeQuestion=$rootScope.Menu.vn.code_question,$scope.MenuQuestionItem.point=$rootScope.Menu.vn.point,$scope.MenuQuestionItem.back=$rootScope.Menu.vn.cancel,$scope.MenuQuestionItem.previos=$rootScope.Menu.vn.previos_question,$scope.MenuQuestionItem.next=$rootScope.Menu.vn.next_question,$scope.MenuQuestionItem.viewResult=$rootScope.Menu.vn.view_result,$scope.divider1=$rootScope.Menu.vn.klass,$scope.divider2=$rootScope.Menu.vn.basic_divider,$scope.divider3=$rootScope.Menu.vn.advanced_divider,$scope.menuQuestion[0].name=$rootScope.Menu.vn.all_question,$scope.menuQuestion[1].name=$rootScope.Menu.vn.answered,$scope.menuQuestion[2].name=$rootScope.Menu.vn.answered_right,$scope.menuQuestion[3].name=$rootScope.Menu.vn.answered_wrong,$scope.menuQuestion[4].name=$rootScope.Menu.vn.hard_question,$scope.menuQuestion[5].name=$rootScope.Menu.vn.not_answered):($scope.MenuQuestionItem.klass=$rootScope.Menu.de.klass,$scope.MenuQuestionItem.codeQuestion=$rootScope.Menu.de.code_question,$scope.MenuQuestionItem.point=$rootScope.Menu.de.point,$scope.MenuQuestionItem.back=$rootScope.Menu.de.cancel,$scope.MenuQuestionItem.previos=$rootScope.Menu.de.previos_question,$scope.MenuQuestionItem.next=$rootScope.Menu.de.next_question,$scope.MenuQuestionItem.viewResult=$rootScope.Menu.de.view_result,$scope.menuQuestion[0].name=$rootScope.Menu.de.all_question,$scope.menuQuestion[1].name=$rootScope.Menu.de.answered,$scope.menuQuestion[2].name=$rootScope.Menu.de.answered_right,$scope.menuQuestion[3].name=$rootScope.Menu.de.answered_wrong,$scope.menuQuestion[4].name=$rootScope.Menu.de.hard_question,$scope.menuQuestion[5].name=$rootScope.Menu.de.not_answered)}function titleTheme(){0==$rootScope.language?$rootScope.modalTitle=$scope.titleThemeVn:$rootScope.modalTitle=$scope.titleThemeDe}function reloadTheme(theme){db.countAnsweredByTheme(theme).then(function(data){$scope.menuQuestionCount.countAllAnswered.number=data,$scope.menuQuestionCount.countAllAnswered.percent=db.percentCalculation(data,$scope.menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[1].number=data,$scope.menuQuestion[1].percent=$scope.menuQuestionCount.countAllAnswered.percent,$scope.menuQuestionCount.countAllNotAnswer.number=$scope.menuQuestionCount.countAllQuestion.number-$scope.menuQuestionCount.countAllAnswered.number,$scope.menuQuestionCount.countAllNotAnswer.percent=$scope.menuQuestionCount.countAllQuestion.percent-$scope.menuQuestionCount.countAllAnswered.percent,$scope.menuQuestion[5].number=$scope.menuQuestionCount.countAllNotAnswer.number,$scope.menuQuestion[5].percent=$scope.menuQuestionCount.countAllNotAnswer.percent}),db.countAnsweredRightByTheme(theme).then(function(data){$scope.menuQuestionCount.countAllAnsweredRight.number=data,$scope.menuQuestionCount.countAllAnsweredRight.percent=db.percentCalculation(data,$scope.menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[2].number=data,$scope.menuQuestion[2].percent=$scope.menuQuestionCount.countAllAnsweredRight.percent}),db.countAnsweredWrongByTheme(theme).then(function(data){$scope.menuQuestionCount.countAllAnsweredWrong.number=data,$scope.menuQuestionCount.countAllAnsweredWrong.percent=db.percentCalculation(data,$scope.menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[3].number=data,$scope.menuQuestion[3].percent=$scope.menuQuestionCount.countAllAnsweredWrong.percent}),db.countQuestionHardByTheme(theme).then(function(data){$scope.menuQuestionCount.countAllQuestionHard.number=data,$scope.menuQuestionCount.countAllQuestionHard.percent=db.percentCalculation(data,$scope.menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[4].number=data,$scope.menuQuestion[4].percent=$scope.menuQuestionCount.countAllQuestionHard.percent})}$scope.menuQuestionCount=new QuestionMenu;var themeQuestion=null;$scope.titleThemeVn=null,$scope.titleThemeDe=null,$scope.MenuQuestionItem={klass:null,codeQuestion:null,point:null,back:null,previos:null,next:null,viewResult:null},$rootScope.modalTitle="",initListMenu(),$scope.$on("changeLanguage",function(event){init(),titleTheme(),initListMenu()}),$rootScope.$on("choose_theme",function(event,theme,titleThemeVn,titleThemeDe){$scope.titleThemeVn=titleThemeVn,$scope.titleThemeDe=titleThemeDe,titleTheme(),$rootScope.questionTheme=!0,themeQuestion=theme,db.countQuestionByTheme(theme).then(function(data){$scope.menuQuestionCount.countAllQuestion.number=data,$scope.menuQuestionCount.countAllQuestion.percent=100,$scope.menuQuestion[0].number=data,$scope.menuQuestion[0].percent=100,reloadTheme(theme)})}),$rootScope.$on("reloadTheme",reloadTheme),$scope.openQuestion=function(event){$scope.modal.hide(),$rootScope.isActive?$scope.menuQuestion[event-1].number>0&&($state.go("listQuestion",{LID:event,THEME:themeQuestion},{}),$rootScope.questionChildOld=2,$rootScope.questionChild=1):db.countQuestionByThemeFree(themeQuestion).then(function(data){data>0?(document.getElementById("questionByTheme").style.opacity="0",document.getElementById("listQuestion").style.display="block",$rootScope.$broadcast("choose_list",event,themeQuestion),$rootScope.questionChildOld=2,$rootScope.questionChild=1):navigator.notification.confirm("Bản miễn phí không có những câu hỏi này.\n\r Bạn vui lòng mua bản đầy đủ!",function(index){$scope.count=0,$scope.sum=0,$scope.nextQuestion=1,$scope.countPlayVideo=5,$scope.listQuestion=[],startPage=!1,2==$rootScope.questionChildOld?document.getElementById("questionByTheme").style.opacity="1":document.getElementById("mainQuestion").style.opacity="1",$timeout(function(event){document.getElementById("listQuestion").style.display="none"},100),2==$rootScope.questionChildOld?($rootScope.questionChild=2,$rootScope.questionChildOld=0):$rootScope.questionChild=0},"Mua bản đầy đủ",["Quay lại"])})}})}(),function(){"use strict";angular.module("TrafficLaws.CategoriesController",["ui.router","ngAnimate","TrafficLaws.databaseService"]).controller("CategoriesCtrl",function($scope,$rootScope,$timeout,$window,$q,$state,db,connect,$ionicLoading,$ionicModal){function viewLoaded(){$scope.dataLoadedCount++,$scope.dataLoadedCount>=2&&$timeout(function(){document.getElementById("mainQuestion").style.display="block",$ionicLoading.hide()},500)}function init1(){0==$rootScope.language?($rootScope.titleAll=$rootScope.Menu.vn.question,$scope.divider1=$rootScope.Menu.vn.klass,$scope.divider2=$rootScope.Menu.vn.basic_divider,$scope.divider3=$rootScope.Menu.vn.advanced_divider,$scope.menuQuestion[0].name=$rootScope.Menu.vn.all_question,$scope.menuQuestion[1].name=$rootScope.Menu.vn.answered,$scope.menuQuestion[2].name=$rootScope.Menu.vn.answered_right,$scope.menuQuestion[3].name=$rootScope.Menu.vn.answered_wrong,$scope.menuQuestion[4].name=$rootScope.Menu.vn.hard_question,$scope.menuQuestion[5].name=$rootScope.Menu.vn.not_answered,$scope.menuQuestion[6].name=$rootScope.Menu.vn.number_question,$scope.menuQuestion[7].name=$rootScope.Menu.vn.variant_question,$scope.menuQuestion[8].name=$rootScope.Menu.vn.film_question):($rootScope.titleAll=$rootScope.Menu.de.question,$scope.divider1=$rootScope.Menu.de.klass,$scope.divider2=$rootScope.Menu.de.basic_divider,$scope.divider3=$rootScope.Menu.de.advanced_divider,$scope.menuQuestion[0].name=$rootScope.Menu.de.all_question,$scope.menuQuestion[1].name=$rootScope.Menu.de.answered,$scope.menuQuestion[2].name=$rootScope.Menu.de.answered_right,$scope.menuQuestion[3].name=$rootScope.Menu.de.answered_wrong,$scope.menuQuestion[4].name=$rootScope.Menu.de.hard_question,$scope.menuQuestion[5].name=$rootScope.Menu.de.not_answered,$scope.menuQuestion[6].name=$rootScope.Menu.de.number_question,$scope.menuQuestion[7].name=$rootScope.Menu.de.variant_question,$scope.menuQuestion[8].name=$rootScope.Menu.de.film_question),$scope.language=1!=$rootScope.language}function init(){db.countQuestionAll().then(function(data){menuQuestionCount.countAllQuestion.number=data,menuQuestionCount.countAllQuestion.percent=100,$scope.menuQuestion[0].number=data,$scope.menuQuestion[0].percent=100,db.countAnsweredAll().then(function(data){menuQuestionCount.countAllAnswered.number=data,menuQuestionCount.countAllAnswered.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[1].number=data,$scope.menuQuestion[1].percent=menuQuestionCount.countAllAnswered.percent,menuQuestionCount.countAllNotAnswer.number=menuQuestionCount.countAllQuestion.number-menuQuestionCount.countAllAnswered.number,menuQuestionCount.countAllNotAnswer.percent=menuQuestionCount.countAllQuestion.percent-menuQuestionCount.countAllAnswered.percent,$scope.menuQuestion[5].number=menuQuestionCount.countAllNotAnswer.number,$scope.menuQuestion[5].percent=menuQuestionCount.countAllNotAnswer.percent,db.countAnsweredRightAll().then(function(data){menuQuestionCount.countAllAnsweredRight.number=data,menuQuestionCount.countAllAnsweredRight.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[2].number=data,$scope.menuQuestion[2].percent=menuQuestionCount.countAllAnsweredRight.percent,db.countAnsweredWrongAll().then(function(data){menuQuestionCount.countAllAnsweredWrong.number=data,menuQuestionCount.countAllAnsweredWrong.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[3].number=data,$scope.menuQuestion[3].percent=menuQuestionCount.countAllAnsweredWrong.percent,db.countQuestionHardAll().then(function(data){menuQuestionCount.countAllQuestionHard.number=data,menuQuestionCount.countAllQuestionHard.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[4].number=data,$scope.menuQuestion[4].percent=menuQuestionCount.countAllQuestionHard.percent,db.countQuestionNumberAll().then(function(data){menuQuestionCount.countAllQuestionNumber.number=data,menuQuestionCount.countAllQuestionNumber.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[6].number=data,$scope.menuQuestion[6].percent=menuQuestionCount.countAllQuestionNumber.percent,db.countQuestionVariantAll().then(function(data){menuQuestionCount.countAllQuestionVariant.number=data,menuQuestionCount.countAllQuestionVariant.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[7].number=data,$scope.menuQuestion[7].percent=menuQuestionCount.countAllQuestionVariant.percent,db.countQuestionVideoAll().then(function(data){menuQuestionCount.countAllQuestionVideo.number=data,menuQuestionCount.countAllQuestionVideo.percent=db.percentCalculation(data,menuQuestionCount.countAllQuestion.number),$scope.menuQuestion[8].number=data,$scope.menuQuestion[8].percent=menuQuestionCount.countAllQuestionVideo.percent})})})})})})})})}$rootScope.isBack=!0,$rootScope.question=!0,$rootScope.questionChild=0,$rootScope.questionChildOld=0,$scope.questionTheme1=new Array,$scope.questionTheme2=new Array,$scope.language=!1,$ionicLoading.show({template:'<ion-spinner icon="lines"></ion-spinner>',hideOnStateChange:!0,noBackdrop:!0}),$scope.menuQuestion={},$scope.dataLoadedCount=0,connect.getAllQuestion().then(function(data){$scope.menuQuestion=data,init1(),viewLoaded()}),db.selectAllQuestionTheme().then(function(data){for(var i=0;i<data.length;i++)1==data[i].ZGROUP?$scope.questionTheme1.push(data[i]):2==data[i].ZGROUP&&$scope.questionTheme2.push(data[i]);$scope.$$phase?$timeout(function(){$scope.$apply()},500):$scope.$apply(),viewLoaded()}),$scope.$on("changeTitle",function(event){$scope.language?$rootScope.titleAll=$rootScope.Menu.vn.question:$rootScope.titleAll=$rootScope.Menu.de.question}),$rootScope.$on("reload",function(event){init()});var menuQuestionCount=new QuestionMenu;$scope.$on("changeLanguage",function(event){init1()}),$scope.open=function(event){$scope.menuQuestion[event-1].number>0&&($state.go("listQuestion",{LID:event},{}),$rootScope.questionChild=1)},$ionicModal.fromTemplateUrl("theme-modal.html",{scope:$scope,animation:"slide-in-up"}).then(function(modal){$scope.modal=modal}),$scope.chooseTheme=function(prefix,ISSHOW,titleThemeVn,titleThemeDe){ISSHOW&&($scope.modal.show(),$rootScope.$broadcast("choose_theme",prefix,titleThemeVn,titleThemeDe),$rootScope.questionChild=2)}})}(),function(){"use strict";angular.module("TrafficLaws.QuestionController",["ui.router","ngAnimate","TrafficLaws.databaseService"]).controller("QuestionItemCtrl",function($scope,$rootScope,$q,$sce,$state,$window,db,$timeout,$http,$ionicLoading,$ionicModal){function init(){0==$rootScope.language?($scope.titlePlayVideo=$rootScope.Menu.vn.start_video,$scope.MenuQuestionItem.klass=$rootScope.Menu.vn.klass,$scope.MenuQuestionItem.codeQuestion=$rootScope.Menu.vn.code_question,$scope.MenuQuestionItem.point=$rootScope.Menu.vn.point,$scope.MenuQuestionItem.back=$rootScope.Menu.vn.cancel,$scope.MenuQuestionItem.previos=$rootScope.Menu.vn.previos_question,$scope.MenuQuestionItem.next=$rootScope.Menu.vn.next_question,$scope.MenuQuestionItem.viewResult=$rootScope.Menu.vn.view_result,$scope.MenuQuestionItem.filmStart=$rootScope.Menu.vn.button_start_video,$scope.MenuQuestionItem.viewQuestion=$rootScope.Menu.vn.view_question_video,$scope.MenuQuestionItem.titleCount1=$rootScope.Menu.vn.title_count_play1,$scope.MenuQuestionItem.titleCount2=$rootScope.Menu.vn.title_count_play2,$scope.MenuQuestionItem.yourAnswer=$rootScope.Menu.vn.your_answer,$scope.MenuQuestionItem.rightAnswer=$rootScope.Menu.vn.right_answer,$scope.MenuQuestionItem.statusRight=$rootScope.Menu.vn.status_answer_right,$scope.MenuQuestionItem.statusWrong=$rootScope.Menu.vn.status_answer_wrong,$scope.MenuQuestionItem.statusHard=$rootScope.Menu.vn.status_answer_hard,$scope.MenuQuestionItem.statusUnHard=$rootScope.Menu.vn.status_answer_un_hard,$scope.MenuQuestionItem.messageDialog=$rootScope.Menu.vn.show_question,$scope.MenuQuestionItem.yes=$rootScope.Menu.vn.yes,$scope.MenuQuestionItem.no=$rootScope.Menu.vn.no,$scope.MenuQuestionItem.go=$rootScope.Menu.vn.go,$scope.MenuQuestionItem.hard=$rootScope.Menu.vn.hard):($scope.titlePlayVideo=$rootScope.Menu.de.start_video,$scope.MenuQuestionItem.klass=$rootScope.Menu.de.klass,$scope.MenuQuestionItem.codeQuestion=$rootScope.Menu.de.code_question,$scope.MenuQuestionItem.point=$rootScope.Menu.de.point,$scope.MenuQuestionItem.back=$rootScope.Menu.de.cancel,$scope.MenuQuestionItem.previos=$rootScope.Menu.de.previos_question,$scope.MenuQuestionItem.next=$rootScope.Menu.de.next_question,$scope.MenuQuestionItem.viewResult=$rootScope.Menu.de.view_result,$scope.MenuQuestionItem.filmStart=$rootScope.Menu.de.button_start_video,$scope.MenuQuestionItem.viewQuestion=$rootScope.Menu.de.view_question_video,$scope.MenuQuestionItem.titleCount1=$rootScope.Menu.de.title_count_play1,$scope.MenuQuestionItem.titleCount2=$rootScope.Menu.de.title_count_play2,$scope.MenuQuestionItem.yourAnswer=$rootScope.Menu.de.your_answer,$scope.MenuQuestionItem.rightAnswer=$rootScope.Menu.de.right_answer,$scope.MenuQuestionItem.statusRight=$rootScope.Menu.de.status_answer_right,$scope.MenuQuestionItem.statusWrong=$rootScope.Menu.de.status_answer_wrong,$scope.MenuQuestionItem.statusHard=$rootScope.Menu.de.status_answer_hard,$scope.MenuQuestionItem.statusUnHard=$rootScope.Menu.de.status_answer_un_hard,$scope.MenuQuestionItem.messageDialog=$rootScope.Menu.de.show_question,$scope.MenuQuestionItem.yes=$rootScope.Menu.de.yes,$scope.MenuQuestionItem.no=$rootScope.Menu.de.no,$scope.MenuQuestionItem.go=$rootScope.Menu.de.go,$scope.MenuQuestionItem.hard=$rootScope.Menu.de.hard)}function loadQuestion(eventId,theme){var eid=parseInt(eventId);if($scope.listQuestion=[],null==theme||0==theme.length)switch(eid){case 1:console.log("Select all questions"),console.log(type),$rootScope.$broadcast("choose_list",eventId,null),db.selectAllQuestionRandom(type).then(callbackAllQuestion);break;case 2:db.selectAllAnswered(type).then(callbackAllQuestion);break;case 3:db.selectAllAnswerRight(type).then(callbackAllQuestion);break;case 4:db.selectAllAnswerWrong(type).then(callbackAllQuestion);break;case 5:db.selectAllQuestionHard(type).then(callbackAllQuestion);break;case 6:$rootScope.isActive?db.selectAllNotAnswered(type).then(callbackAllQuestion):db.selectAllNotAnsweredFree(type).then(callbackAllQuestion);break;case 7:$rootScope.isActive?db.selectAllQuestionNumber(type).then(callbackAllQuestion):db.selectAllQuestionNumberFree(type).then(callbackAllQuestion);break;case 8:$rootScope.isActive?db.selectAllQuestionVariant(type).then(callbackAllQuestion):db.selectAllQuestionVariantFree(type).then(callbackAllQuestion);break;case 9:$rootScope.isActive?db.selectAllQuestionVideo(type).then(callbackAllQuestion):db.selectAllQuestionVideoFree(type).then(callbackAllQuestion)}else switch(eid){case 1:$rootScope.isActive?db.selectQuestionByTheme(theme+".",type).then(callbackAllQuestion):db.selectQuestionByThemeFree(theme+".",type).then(callbackAllQuestion);break;case 2:db.selectAllAnsweredByTheme(theme+".",type).then(callbackAllQuestion);break;case 3:db.selectAllAnswerRightByTheme(theme+".",type).then(callbackAllQuestion);break;case 4:db.selectAllAnswerWrongByTheme(theme+".",type).then(callbackAllQuestion);break;case 5:db.selectQuestionHardByTheme(theme+".",type).then(callbackAllQuestion);break;case 6:$rootScope.isActive?db.selectAllNotAnsweredByTheme(theme+".",type).then(callbackAllQuestion):db.selectAllNotAnsweredByThemeFree(theme+".",type).then(callbackAllQuestion)}}function callbackAllQuestion(data){$scope.listQuestion=data,$scope.sum=$scope.listQuestion.length,$scope.questionCurrent=new QuestionModel,$scope.questionItem1=new QuestionModel,$scope.questionItem2=new QuestionModel,$scope.questionItem3=new QuestionModel,$scope.questionCurrent=$scope.listQuestion[$scope.count],$scope.questionCurrent.ZISVIDEO&&($scope.questionCurrent.ZVARIANT=!0),$scope.sum>2?($scope.questionItem1=$scope.listQuestion[$scope.sum-1],$scope.questionItem2=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[$scope.count+1]):$scope.sum>1?($scope.questionItem1=$scope.listQuestion[$scope.count+1],$scope.questionItem2=$scope.listQuestion[$scope.count]):$scope.sum>0?$scope.questionItem2=$scope.listQuestion[$scope.count]:navigator.notification.confirm("Bản miễn phí không có những câu hỏi này.\n\r Bạn vui lòng mua bản đầy đủ!",function(index){$scope.count=0,$scope.sum=0,$scope.nextQuestion=1,$scope.countPlayVideo=5,$scope.listQuestion=[],startPage=!1,2==$rootScope.questionChildOld?document.getElementById("questionByTheme").style.opacity="1":document.getElementById("mainQuestion").style.opacity="1",$timeout(function(event){document.getElementById("listQuestion").style.display="none"},100),2==$rootScope.questionChildOld?($rootScope.questionChild=2,$rootScope.questionChildOld=0):$rootScope.questionChild=0},"Mua bản đầy đủ",["Quay lại"]),init(),initChangeLanguage(),$ionicLoading.hide()}function initChangeLanguage(){0==$rootScope.language?($scope.questionCurrent.ZQUESTIONTEMP=$scope.questionCurrent.ZQUESTIONVN,$scope.questionCurrent.ZANSWER[0].ZANSWER=$scope.questionCurrent.ZANSWER[0].vn.ZANSWER,$scope.questionCurrent.ZANSWER[1].ZANSWER=$scope.questionCurrent.ZANSWER[1].vn.ZANSWER,$scope.questionCurrent.ZANSWER[2].ZANSWER=$scope.questionCurrent.ZANSWER[2].vn.ZANSWER,$scope.questionItem1.ZQUESTIONTEMP=$scope.questionItem1.ZQUESTIONVN,$scope.questionItem1.ZANSWER[0].ZANSWER=$scope.questionItem1.ZANSWER[0].vn.ZANSWER,$scope.questionItem1.ZANSWER[1].ZANSWER=$scope.questionItem1.ZANSWER[1].vn.ZANSWER,$scope.questionItem1.ZANSWER[2].ZANSWER=$scope.questionItem1.ZANSWER[2].vn.ZANSWER,$scope.questionItem2.ZQUESTIONTEMP=$scope.questionItem2.ZQUESTIONVN,$scope.questionItem2.ZANSWER[0].ZANSWER=$scope.questionItem2.ZANSWER[0].vn.ZANSWER,$scope.questionItem2.ZANSWER[1].ZANSWER=$scope.questionItem2.ZANSWER[1].vn.ZANSWER,$scope.questionItem2.ZANSWER[2].ZANSWER=$scope.questionItem2.ZANSWER[2].vn.ZANSWER,$scope.questionItem3.ZQUESTIONTEMP=$scope.questionItem3.ZQUESTIONVN,$scope.questionItem3.ZANSWER[0].ZANSWER=$scope.questionItem3.ZANSWER[0].vn.ZANSWER,$scope.questionItem3.ZANSWER[1].ZANSWER=$scope.questionItem3.ZANSWER[1].vn.ZANSWER,$scope.questionItem3.ZANSWER[2].ZANSWER=$scope.questionItem3.ZANSWER[2].vn.ZANSWER,$scope.questionItem1.ZPRETEXTTEMP=$scope.questionItem1.ZPRETEXTVN,$scope.questionItem2.ZPRETEXTTEMP=$scope.questionItem2.ZPRETEXTVN,$scope.questionItem3.ZPRETEXTTEMP=$scope.questionItem3.ZPRETEXTVN,$scope.questionItem1.ANSWERINPUTSTRING1TEMP=$scope.questionItem1.ANSWERINPUTSTRING1VN,$scope.questionItem2.ANSWERINPUTSTRING1TEMP=$scope.questionItem2.ANSWERINPUTSTRING1VN,$scope.questionItem3.ANSWERINPUTSTRING1TEMP=$scope.questionItem3.ANSWERINPUTSTRING1VN,$scope.questionItem1.ANSWERINPUTSTRING2TEMP=$scope.questionItem1.ANSWERINPUTSTRING2VN,$scope.questionItem2.ANSWERINPUTSTRING2TEMP=$scope.questionItem2.ANSWERINPUTSTRING2VN,$scope.questionItem3.ANSWERINPUTSTRING2TEMP=$scope.questionItem3.ANSWERINPUTSTRING2VN,$scope.questionCurrent.ZISVIDEO&&($scope.countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"&nbsp;<b style='color: #e50000;'>"+$scope.countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>"))):($scope.questionCurrent.ZQUESTIONTEMP=$scope.questionCurrent.ZQUESTION,$scope.questionCurrent.ZANSWER[0].ZANSWER=$scope.questionCurrent.ZANSWER[0].de.ZANSWER,$scope.questionCurrent.ZANSWER[1].ZANSWER=$scope.questionCurrent.ZANSWER[1].de.ZANSWER,$scope.questionCurrent.ZANSWER[2].ZANSWER=$scope.questionCurrent.ZANSWER[2].de.ZANSWER,$scope.questionItem1.ZQUESTIONTEMP=$scope.questionItem1.ZQUESTION,$scope.questionItem1.ZANSWER[0].ZANSWER=$scope.questionItem1.ZANSWER[0].de.ZANSWER,$scope.questionItem1.ZANSWER[1].ZANSWER=$scope.questionItem1.ZANSWER[1].de.ZANSWER,$scope.questionItem1.ZANSWER[2].ZANSWER=$scope.questionItem1.ZANSWER[2].de.ZANSWER,$scope.questionItem2.ZQUESTIONTEMP=$scope.questionItem2.ZQUESTION,$scope.questionItem2.ZANSWER[0].ZANSWER=$scope.questionItem2.ZANSWER[0].de.ZANSWER,$scope.questionItem2.ZANSWER[1].ZANSWER=$scope.questionItem2.ZANSWER[1].de.ZANSWER,$scope.questionItem2.ZANSWER[2].ZANSWER=$scope.questionItem2.ZANSWER[2].de.ZANSWER,$scope.questionItem3.ZQUESTIONTEMP=$scope.questionItem3.ZQUESTION,$scope.questionItem3.ZANSWER[0].ZANSWER=$scope.questionItem3.ZANSWER[0].de.ZANSWER,$scope.questionItem3.ZANSWER[1].ZANSWER=$scope.questionItem3.ZANSWER[1].de.ZANSWER,$scope.questionItem3.ZANSWER[2].ZANSWER=$scope.questionItem3.ZANSWER[2].de.ZANSWER,$scope.questionItem1.ZPRETEXTTEMP=$scope.questionItem1.ZPRETEXT,$scope.questionItem2.ZPRETEXTTEMP=$scope.questionItem2.ZPRETEXT,$scope.questionItem3.ZPRETEXTTEMP=$scope.questionItem3.ZPRETEXT,$scope.questionItem1.ANSWERINPUTSTRING1TEMP=$scope.questionItem1.ANSWERINPUTSTRING1,$scope.questionItem2.ANSWERINPUTSTRING1TEMP=$scope.questionItem2.ANSWERINPUTSTRING1,$scope.questionItem3.ANSWERINPUTSTRING1TEMP=$scope.questionItem3.ANSWERINPUTSTRING1,$scope.questionItem1.ANSWERINPUTSTRING2TEMP=$scope.questionItem1.ANSWERINPUTSTRING2,$scope.questionItem2.ANSWERINPUTSTRING2TEMP=$scope.questionItem2.ANSWERINPUTSTRING2,$scope.questionItem3.ANSWERINPUTSTRING2TEMP=$scope.questionItem3.ANSWERINPUTSTRING2,$scope.questionCurrent.ZISVIDEO&&($scope.countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"<br /><b style='color: #e50000;'>"+$scope.countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>")));
}function endedVideo(e){0==$scope.listQuestion[$scope.count].countPlayVideo&&($scope.listQuestion[$scope.count].questionCurrent.ZISVIDEO=!1,$scope.listQuestion[$scope.count].countPlayVideo=5)}function playVideo(){var filename=$scope.questionCurrent.ZFRAGENKATALOG.split(".").join("_"),videoPath=$rootScope.assetsPath+"videos/iOS/WVGA/"+filename.replace(/-/g,"_")+".mp4",options={successCallback:function(){window.plugins.streamingMedia.stop(),console.log("Player closed without error."),endedVideo()},errorCallback:function(errMsg){console.log("Error! "+errMsg)}};window.plugins.streamingMedia.playVideo(videoPath,options),$scope.countPlayVideo-=1,$scope.questionCurrent.ZIMAGE=$scope.questionCurrent.ZBIGIMAGE,0==$scope.countPlayVideo&&($scope.questionCurrent.ZISVIDEO=!1,$scope.countPlayVideo=5),0==$rootScope.language?$scope.countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"&nbsp;<b style='color: #e50000;'>"+$scope.countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>"):$scope.countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"<br /><b style='color: #e50000;'>"+$scope.countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>")}function alertCloseVideo(message,yes,no){navigator.notification.confirm(message,onConfirm,"",[yes,no])}function onConfirm(buttonIndex){2!=buttonIndex&&($scope.questionCurrent.ZISVIDEO=!1,$scope.countPlayVideo=5,$scope.$$phase?$timeout(function(){$scope.$apply()},500):$scope.$apply())}function checkValid(){if(null!=promise&&($timeout.cancel(promise),$scope.isShowBar=!1),$scope.questionCurrent.ZISINPUT){var element=null;if(0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3")),null==element.getElementsByClassName("ipAnswer1")[0]){element.getElementsByClassName("ipAnswer")[0].blur();var yourAnswer=element.getElementsByClassName("ipAnswer")[0].value,rightAnswer=element.getElementsByClassName("ipValid")[0].value;yourAnswer.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):($scope.questionCurrent.ISANSWERED=!0,$scope.questionCurrent.ZINPUTANSWER1=yourAnswer,yourAnswer==rightAnswer?($scope.questionCurrent.ANSWERRIGHT=!0,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),element.getElementsByClassName("ipAnswer")[0].style.backgroundColor="#3db707",element.getElementsByClassName("ipAnswer")[0].readOnly=!0,resetInput(),$rootScope.audio&&$rootScope.$broadcast("playaudio","right")):($scope.questionCurrent.ANSWERRIGHT=!1,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),element.getElementsByClassName("ipAnswer")[0].style.backgroundColor="#cd2630",element.getElementsByClassName("ipAnswer")[0].readOnly=!0,resetInput(),$rootScope.audio&&$rootScope.$broadcast("playaudio","error")))}else{var yourAnswer=element.getElementsByClassName("ipAnswer1")[0].value,yourAnswer1=element.getElementsByClassName("ipAnswer2")[0].value,rightAnswer=element.getElementsByClassName("ipValid1")[0].value,rightAnswer1=element.getElementsByClassName("ipValid2")[0].value;element.getElementsByClassName("ipAnswer1")[0].blur(),element.getElementsByClassName("ipAnswer2")[0].blur(),yourAnswer.match(/[a-z]/i)||yourAnswer1.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):($scope.questionCurrent.ISANSWERED=!0,$scope.questionCurrent.ZINPUTANSWER1=yourAnswer,$scope.questionCurrent.ZINPUTANSWER2=yourAnswer1,yourAnswer==rightAnswer&&yourAnswer1==rightAnswer1?($scope.questionCurrent.ANSWERRIGHT=!0,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),element.getElementsByClassName("ipAnswer1")[0].style.backgroundColor="#3db707",element.getElementsByClassName("ipAnswer2")[0].style.backgroundColor="#3db707",element.getElementsByClassName("ipAnswer1")[0].readOnly=!0,element.getElementsByClassName("ipAnswer2")[0].readOnly=!0,resetInput(),$rootScope.audio&&$rootScope.$broadcast("playaudio","right")):($scope.questionCurrent.ANSWERRIGHT=!1,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),element.getElementsByClassName("ipAnswer1")[0].style.backgroundColor="#cd2630",element.getElementsByClassName("ipAnswer2")[0].style.backgroundColor="#cd2630",element.getElementsByClassName("ipAnswer1")[0].readOnly=!0,element.getElementsByClassName("ipAnswer2")[0].readOnly=!0,resetInput(),$rootScope.audio&&$rootScope.$broadcast("playaudio","error")))}}else $scope.questionCurrent.ISANSWERED=!0,$scope.questionCurrent.ZANSWER[0].checkAnswer?1==$scope.questionCurrent.ZVALID1?($scope.questionCurrent.ZANSWER[0].isValid="img/answer_right.png",$scope.questionCurrent.ZANSWER[0].isRight=!0):($scope.questionCurrent.ZANSWER[0].isValid="img/answer_wrong1.png",$scope.questionCurrent.ZANSWER[0].isRight=!1):1==$scope.questionCurrent.ZVALID1?($scope.questionCurrent.ZANSWER[0].isValid="img/answer_right1.png",$scope.questionCurrent.ZANSWER[0].isRight=!1):($scope.questionCurrent.ZANSWER[0].isValid="img/answer_wrong.png",$scope.questionCurrent.ZANSWER[0].isRight=!0),$scope.questionCurrent.ZANSWER[1].checkAnswer?1==$scope.questionCurrent.ZVALID2?($scope.questionCurrent.ZANSWER[1].isValid="img/answer_right.png",$scope.questionCurrent.ZANSWER[1].isRight=!0):($scope.questionCurrent.ZANSWER[1].isValid="img/answer_wrong1.png",$scope.questionCurrent.ZANSWER[1].isRight=!1):1==$scope.questionCurrent.ZVALID2?($scope.questionCurrent.ZANSWER[1].isValid="img/answer_right1.png",$scope.questionCurrent.ZANSWER[1].isRight=!1):($scope.questionCurrent.ZANSWER[1].isValid="img/answer_wrong.png",$scope.questionCurrent.ZANSWER[1].isRight=!0),$scope.questionCurrent.ZANSWER[2].checkAnswer?1==$scope.questionCurrent.ZVALID3?($scope.questionCurrent.ZANSWER[2].isValid="img/answer_right.png",$scope.questionCurrent.ZANSWER[2].isRight=!0):($scope.questionCurrent.ZANSWER[2].isValid="img/answer_wrong1.png",$scope.questionCurrent.ZANSWER[2].isRight=!1):1==$scope.questionCurrent.ZVALID3?($scope.questionCurrent.ZANSWER[2].isValid="img/answer_right1.png",$scope.questionCurrent.ZANSWER[2].isRight=!1):($scope.questionCurrent.ZANSWER[2].isValid="img/answer_wrong.png",$scope.questionCurrent.ZANSWER[2].isRight=!0),$scope.questionCurrent.ZANSWER[0].isRight&&$scope.questionCurrent.ZANSWER[1].isRight&&$scope.questionCurrent.ZANSWER[2].isRight?($scope.questionCurrent.ANSWERRIGHT=!0,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),$rootScope.audio&&$rootScope.$broadcast("playaudio","right")):($scope.questionCurrent.ANSWERRIGHT=!1,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),$rootScope.audio&&$rootScope.$broadcast("playaudio","error"))}function resetInput(){if($scope.questionCurrent.ANSWERRIGHT){var t1=$scope.questionCurrent.ZANSWER1VN.indexOf("^"),answer1=$scope.questionCurrent.ZANSWER1VN.substring(0,t1),answer2=$scope.questionCurrent.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.questionCurrent.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' style='background-color:#3db707' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='"+$scope.questionCurrent.ZINPUTANSWER2+"' type='text' style='background-color:#3db707' readonly/>&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.questionCurrent.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' type='text' style='background-color:#3db707' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}var t1=$scope.questionCurrent.ZANSWER1.indexOf("^"),answer1=$scope.questionCurrent.ZANSWER1.substring(0,t1),answer2=$scope.questionCurrent.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.questionCurrent.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' style='background-color:#3db707' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='"+$scope.questionCurrent.ZINPUTANSWER2+"' type='text' style='background-color:#3db707' readonly/>&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.questionCurrent.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' type='text' style='background-color:#3db707' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}else{var t1=$scope.questionCurrent.ZANSWER1VN.indexOf("^"),answer1=$scope.questionCurrent.ZANSWER1VN.substring(0,t1),answer2=$scope.questionCurrent.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.questionCurrent.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' style='background-color:#cd2630' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='"+$scope.questionCurrent.ZINPUTANSWER2+"' type='text' style='background-color:#cd2630' readonly/>&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.questionCurrent.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' type='text' style='background-color:#cd2630' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}var t1=$scope.questionCurrent.ZANSWER1.indexOf("^"),answer1=$scope.questionCurrent.ZANSWER1.substring(0,t1),answer2=$scope.questionCurrent.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.questionCurrent.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' style='background-color:#cd2630' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='"+$scope.questionCurrent.ZINPUTANSWER2+"' type='text' style='background-color:#cd2630' readonly/>&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.questionCurrent.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' type='text' style='background-color:#cd2630' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}}function resetInputNext(){if($scope.listQuestion[$scope.count].ZISINPUT){var t1=$scope.listQuestion[$scope.count].ZANSWER1VN.indexOf("^"),answer1=$scope.listQuestion[$scope.count].ZANSWER1VN.substring(0,t1),answer2=$scope.listQuestion[$scope.count].ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' style='background-color:#bdbdbd'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' style='background-color:#bdbdbd'/>&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.listQuestion[$scope.count].ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' style='background-color:#bdbdbd'/>&nbsp<p> "+utils.convertText(text)+"</p>",$scope.listQuestion[$scope.count].ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}var t1=$scope.listQuestion[$scope.count].ZANSWER1.indexOf("^"),answer1=$scope.listQuestion[$scope.count].ZANSWER1.substring(0,t1),answer2=$scope.listQuestion[$scope.count].ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' style='background-color:#bdbdbd'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' style='background-color:#bdbdbd'/>&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.listQuestion[$scope.count].ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' style='background-color:#bdbdbd'/>&nbsp<p> "+utils.convertText(text)+"</p>",$scope.listQuestion[$scope.count].ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}}$scope.count=0,$scope.sum=0,$scope.nextQuestion=1,$scope.countPlayVideo=5;var startPage=!1;$scope.hardText="",$scope.isShowBar=!1,$scope.flipLeft=!1,$scope.flipLeft_hidden=!1,$scope.flipRight=!1,$scope.flipRight_hidden=!1,$scope.isNext=!0,$scope.selectedIndex=1,$scope.styleStatus="background-color:transparent;",$scope.listQuestion=[];var utils=new Utils($http);$scope.titlePlayVideo=null,$scope.MenuQuestionItem={klass:null,codeQuestion:null,point:null,back:null,previos:null,next:null,viewResult:null,filmStart:null,viewQuestion:null,titleCount1:null,titleCount2:null,yourAnswer:null,rightAnswer:null,statusRight:null,statusWrong:null,statusHard:null,statusUnHard:null,messageDialog:null,yes:null,no:null,go:null},$scope.isLanguage=1!=$rootScope.language,$scope.languageText=$scope.isLanguage?"DE":"VN",$scope.questionCurrent,$scope.countPlayVideoText=null,$ionicLoading.show({template:'<ion-spinner icon="lines"></ion-spinner>',hideOnStateChange:!0,noBackdrop:!0});var type;init(),type=$rootScope.questionRandom?"RANDOM()":"Z_PK ASC",loadQuestion($state.params.LID,$state.params.THEME),$scope.changeLanguage=function(){$scope.isLanguage=!$scope.isLanguage,$scope.languageText=$scope.isLanguage?"DE":"VN",1==$rootScope.questionChild&&(init(),initChangeLanguage()),$rootScope.audio&&$rootScope.$broadcast("playaudio","lang")},$scope.$on("changeLanguage",function(event){1==$rootScope.questionChild&&(init(),initChangeLanguage())}),$scope.blurInput1=function(){var element=document.getElementById("flip1"),ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer)ipAnswer.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer.blur();else{var ipAnswer2=element.getElementsByClassName("ipAnswer2")[0];ipAnswer1.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer1.blur(),ipAnswer2.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer2.blur()}},$scope.blurInput2=function(){var element=document.getElementById("flip2"),ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer)ipAnswer.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer.blur();else{var ipAnswer2=element.getElementsByClassName("ipAnswer2")[0];ipAnswer1.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer1.blur(),ipAnswer2.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer2.blur()}},$scope.blurInput3=function(){var element=document.getElementById("flip3"),ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer)ipAnswer.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer.blur();else{var ipAnswer2=element.getElementsByClassName("ipAnswer2")[0];ipAnswer1.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer1.blur(),ipAnswer2.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer2.blur()}},$scope.playVideo=function(){playVideo()},$scope.hideVideo=function(){window.plugins.streamingMedia.stopAudio()},$scope.showQuestion=function(){alertCloseVideo($scope.MenuQuestionItem.messageDialog,$scope.MenuQuestionItem.yes,$scope.MenuQuestionItem.no)},$scope.renderHtml=function(htmlCode){return $sce.trustAsHtml(htmlCode)},$scope.open=function(event){switch(event){case 2:$state.go("question",{},{})}},$scope.check=function(item){item.checkAnswer=!item.checkAnswer},$scope.val="",$scope.rotateLeft=function(){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0],yourAnswer="";if(null==ipAnswer1&&null!=ipAnswer?yourAnswer=element.getElementsByClassName("ipAnswer")[0].value:null!=ipAnswer1&&(yourAnswer=element.getElementsByClassName("ipAnswer1")[0].value+element.getElementsByClassName("ipAnswer2")[0].value),$scope.countPlayVideo=5,$scope.questionCurrent.ISANSWERED||$scope.questionCurrent.ZISINPUT&&""==yourAnswer||!$scope.questionCurrent.ZANSWER[0].checkAnswer&&!$scope.questionCurrent.ZANSWER[1].checkAnswer&&!$scope.questionCurrent.ZANSWER[2].checkAnswer&&!$scope.questionCurrent.ZISINPUT){$scope.listQuestion[$scope.count].ZANSWER[0].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[1].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[2].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[0].checkAnswer=!1,$scope.listQuestion[$scope.count].ZANSWER[1].checkAnswer=!1,$scope.listQuestion[$scope.count].ZANSWER[2].checkAnswer=!1,resetInputNext(),$scope.count==$scope.sum-1?$scope.count=0:$scope.count+=1,$scope.nextQuestion=$scope.count+1,null!=ipAnswer&&(ipAnswer.value="",ipAnswer.style.backgroundColor="#bdbdbd",ipAnswer.readOnly=!1),null!=ipAnswer1&&(ipAnswer1.value="",ipAnswer1.style.backgroundColor="#bdbdbd",ipAnswer1.readOnly=!1),null!=element.getElementsByClassName("ipAnswer2")[0]&&(element.getElementsByClassName("ipAnswer2")[0].value="",element.getElementsByClassName("ipAnswer2")[0].style.backgroundColor="#bdbdbd",element.getElementsByClassName("ipAnswer2")[0].readOnly=!1),$scope.questionCurrent.ZANSWER[0].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[1].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[2].isValid="img/answer_uncheck.png",$scope.questionCurrent.ISANSWERED=!1,$scope.questionCurrent=$scope.listQuestion[$scope.count],$scope.questionCurrent.ZISVIDEO&&($scope.questionCurrent.ZVARIANT=!0);var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");if($scope.sum>2)var prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;else if($scope.sum>1)var prev=0==$scope.count?1:0;else if($scope.sum>0)var prev=$scope.count,next=prev;if($scope.sum>2)switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[next],flip1.classList.add("flipLeft"),flip2.classList.remove("flipRight"),flip3.classList.remove("flipLeft"),flip3.classList.add("flipRight");break;case 1:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],flip2.classList.add("flipLeft"),flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip3.classList.remove("flipRight");break;case 2:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip3.classList.add("flipLeft"),flip1.classList.remove("flipRight"),flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight")}else if($scope.sum>1)switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],flip1.classList.contains("flipLeft")&&flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip2.classList.contains("flipLeft")&&flip2.classList.remove("flipLeft"),flip2.classList.contains("flipRight")&&flip2.classList.remove("flipRight");break;case 1:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[prev],flip2.classList.contains("flipLeft")&&flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight"),flip1.classList.contains("flipLeft")&&flip1.classList.remove("flipLeft"),flip1.classList.contains("flipRight")&&flip1.classList.remove("flipRight")}initChangeLanguage(),$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}else($scope.questionCurrent.ZISINPUT||$scope.questionCurrent.ZANSWER[0].checkAnswer||$scope.questionCurrent.ZANSWER[1].checkAnswer||$scope.questionCurrent.ZANSWER[2].checkAnswer)&&checkValid()},$scope.rotateRight=function(){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0],yourAnswer="";if(null==ipAnswer1&&null!=ipAnswer?yourAnswer=element.getElementsByClassName("ipAnswer")[0].value:null!=ipAnswer1&&(yourAnswer=element.getElementsByClassName("ipAnswer1")[0].value+element.getElementsByClassName("ipAnswer2")[0].value),$scope.countPlayVideo=5,$scope.questionCurrent.ISANSWERED||$scope.questionCurrent.ZISINPUT&&""==yourAnswer||!$scope.questionCurrent.ZANSWER[0].checkAnswer&&!$scope.questionCurrent.ZANSWER[1].checkAnswer&&!$scope.questionCurrent.ZANSWER[2].checkAnswer&&!$scope.questionCurrent.ZISINPUT){$scope.isNext=!1,$scope.listQuestion[$scope.count].ZANSWER[0].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[1].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[2].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[0].checkAnswer=!1,$scope.listQuestion[$scope.count].ZANSWER[1].checkAnswer=!1,$scope.listQuestion[$scope.count].ZANSWER[2].checkAnswer=!1,resetInputNext(),$scope.count>0?$scope.count-=1:$scope.count=$scope.sum-1,null!=ipAnswer&&(ipAnswer.value="",ipAnswer.style.backgroundColor="#bdbdbd",ipAnswer.readOnly=!1),null!=ipAnswer1&&(ipAnswer1.value="",ipAnswer1.style.backgroundColor="#bdbdbd",ipAnswer1.readOnly=!1),null!=element.getElementsByClassName("ipAnswer2")[0]&&(element.getElementsByClassName("ipAnswer2")[0].value="",element.getElementsByClassName("ipAnswer2")[0].style.backgroundColor="#bdbdbd",element.getElementsByClassName("ipAnswer2")[0].readOnly=!1),$scope.nextQuestion=$scope.count+1,$scope.questionCurrent.ZANSWER[0].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[1].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[2].isValid="img/answer_uncheck.png",
$scope.questionCurrent.ISANSWERED=!1,$scope.questionCurrent=$scope.listQuestion[$scope.count],$scope.questionCurrent.ZISVIDEO&&($scope.questionCurrent.ZVARIANT=!0);var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");if($scope.sum>2)var prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;else if($scope.sum>1)var prev=0==$scope.count?1:0;else if($scope.sum>0)var prev=$scope.count,next=prev;if($scope.sum>2)switch($scope.selectedIndex){case 0:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],flip1.classList.add("flipRight"),flip2.classList.remove("flipRight"),flip2.classList.add("flipLeft"),flip3.classList.remove("flipLeft");break;case 1:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip2.classList.add("flipRight"),flip1.classList.remove("flipLeft"),flip3.classList.remove("flipRight"),flip3.classList.add("flipLeft");break;case 2:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[next],flip3.classList.add("flipRight"),flip1.classList.remove("flipRight"),flip1.classList.add("flipLeft"),flip2.classList.remove("flipLeft")}else if($scope.sum>1)switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],flip1.classList.contains("flipRight")&&flip1.classList.remove("flipRight"),flip1.classList.contains("flipLeft")||flip1.classList.add("flipLeft"),flip2.classList.contains("flipLeft")&&flip2.classList.remove("flipLeft"),flip2.classList.contains("flipRight")&&flip2.classList.remove("flipRight");break;case 1:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[prev],flip2.classList.contains("flipRight")&&flip2.classList.remove("flipRight"),flip2.classList.contains("flipLeft")||flip2.classList.add("flipLeft"),flip1.classList.contains("flipRight")&&flip1.classList.remove("flipRight"),flip1.classList.contains("flipLeft")&&flip1.classList.remove("flipLeft")}initChangeLanguage(),$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}else($scope.questionCurrent.ZISINPUT||$scope.questionCurrent.ZANSWER[0].checkAnswer||$scope.questionCurrent.ZANSWER[1].checkAnswer||$scope.questionCurrent.ZANSWER[2].checkAnswer)&&checkValid()},$scope.onPrevios=function(){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0],yourAnswer="";if(null==ipAnswer1&&null!=ipAnswer?yourAnswer=element.getElementsByClassName("ipAnswer")[0].value:null!=ipAnswer1&&(yourAnswer=element.getElementsByClassName("ipAnswer1")[0].value+element.getElementsByClassName("ipAnswer2")[0].value),$scope.countPlayVideo=5,$scope.questionCurrent.ISANSWERED||$scope.questionCurrent.ZISINPUT&&""==yourAnswer||!$scope.questionCurrent.ZANSWER[0].checkAnswer&&!$scope.questionCurrent.ZANSWER[1].checkAnswer&&!$scope.questionCurrent.ZANSWER[2].checkAnswer&&!$scope.questionCurrent.ZISINPUT){$scope.isNext=!1,$scope.listQuestion[$scope.count].ZANSWER[0].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[1].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[2].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[0].checkAnswer=!1,$scope.listQuestion[$scope.count].ZANSWER[1].checkAnswer=!1,$scope.listQuestion[$scope.count].ZANSWER[2].checkAnswer=!1,resetInputNext(),$scope.count>0?$scope.count-=1:$scope.count=$scope.sum-1,null!=ipAnswer&&(ipAnswer.value="",ipAnswer.style.backgroundColor="#bdbdbd",ipAnswer.readOnly=!1),null!=ipAnswer1&&(ipAnswer1.value="",ipAnswer1.style.backgroundColor="#bdbdbd",ipAnswer1.readOnly=!1),null!=element.getElementsByClassName("ipAnswer2")[0]&&(element.getElementsByClassName("ipAnswer2")[0].value="",element.getElementsByClassName("ipAnswer2")[0].style.backgroundColor="#bdbdbd",element.getElementsByClassName("ipAnswer2")[0].readOnly=!1),$scope.nextQuestion=$scope.count+1,$scope.questionCurrent.ZANSWER[0].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[1].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[2].isValid="img/answer_uncheck.png",$scope.countPlayVideo=5,$scope.questionCurrent.ISANSWERED=!1,$scope.questionCurrent=$scope.listQuestion[$scope.count],$scope.questionCurrent.ZISVIDEO&&($scope.questionCurrent.ZVARIANT=!0);var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");if($scope.sum>2)var prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;else if($scope.sum>1)var prev=0==$scope.count?1:0;else if($scope.sum>0)var prev=$scope.count,next=prev;if($scope.sum>2)switch($scope.selectedIndex){case 0:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],flip1.classList.add("flipRight"),flip2.classList.remove("flipRight"),flip2.classList.add("flipLeft"),flip3.classList.remove("flipLeft");break;case 1:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip2.classList.add("flipRight"),flip1.classList.remove("flipLeft"),flip3.classList.remove("flipRight"),flip3.classList.add("flipLeft");break;case 2:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[next],flip3.classList.add("flipRight"),flip1.classList.remove("flipRight"),flip1.classList.add("flipLeft"),flip2.classList.remove("flipLeft")}else if($scope.sum>1)switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],flip1.classList.contains("flipRight")&&flip1.classList.remove("flipRight"),flip1.classList.contains("flipLeft")||flip1.classList.add("flipLeft"),flip2.classList.contains("flipLeft")&&flip2.classList.remove("flipLeft"),flip2.classList.contains("flipRight")&&flip2.classList.remove("flipRight");break;case 1:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[prev],flip2.classList.contains("flipRight")&&flip2.classList.remove("flipRight"),flip2.classList.contains("flipLeft")||flip2.classList.add("flipLeft"),flip1.classList.contains("flipRight")&&flip1.classList.remove("flipRight"),flip1.classList.contains("flipLeft")&&flip1.classList.remove("flipLeft")}initChangeLanguage(),$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}else($scope.questionCurrent.ZISINPUT||$scope.questionCurrent.ZANSWER[0].checkAnswer||$scope.questionCurrent.ZANSWER[1].checkAnswer||$scope.questionCurrent.ZANSWER[2].checkAnswer)&&checkValid()},$scope.onNextItem=function(){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0],yourAnswer="";if(null==ipAnswer1&&null!=ipAnswer?yourAnswer=element.getElementsByClassName("ipAnswer")[0].value:null!=ipAnswer1&&(yourAnswer=element.getElementsByClassName("ipAnswer1")[0].value+element.getElementsByClassName("ipAnswer2")[0].value),$scope.countPlayVideo=5,$scope.questionCurrent.ISANSWERED||$scope.questionCurrent.ZISINPUT&&""==yourAnswer||!$scope.questionCurrent.ZANSWER[0].checkAnswer&&!$scope.questionCurrent.ZANSWER[1].checkAnswer&&!$scope.questionCurrent.ZANSWER[2].checkAnswer&&!$scope.questionCurrent.ZISINPUT){$scope.isNext=!0,$scope.listQuestion[$scope.count].ZANSWER[0].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[1].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[2].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[0].checkAnswer=!1,$scope.listQuestion[$scope.count].ZANSWER[1].checkAnswer=!1,$scope.listQuestion[$scope.count].ZANSWER[2].checkAnswer=!1,resetInputNext(),$scope.count==$scope.sum-1?$scope.count=0:$scope.count+=1,null!=ipAnswer&&(ipAnswer.value="",ipAnswer.style.backgroundColor="#bdbdbd",ipAnswer.readOnly=!1),null!=ipAnswer1&&(ipAnswer1.value="",ipAnswer1.style.backgroundColor="#bdbdbd",ipAnswer1.readOnly=!1),null!=element.getElementsByClassName("ipAnswer2")[0]&&(element.getElementsByClassName("ipAnswer2")[0].value="",element.getElementsByClassName("ipAnswer2")[0].style.backgroundColor="#bdbdbd",element.getElementsByClassName("ipAnswer2")[0].readOnly=!1),$scope.questionCurrent.ZANSWER[0].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[1].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[2].isValid="img/answer_uncheck.png",$scope.countPlayVideo=5,$scope.questionCurrent.ISANSWERED=!1,$scope.nextQuestion=$scope.count+1,$scope.questionCurrent=$scope.listQuestion[$scope.count],$scope.questionCurrent.ZISVIDEO&&($scope.questionCurrent.ZVARIANT=!0);var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");if($scope.sum>2)var prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;else if($scope.sum>1)var prev=0==$scope.count?1:0;else if($scope.sum>0)var prev=$scope.count,next=prev;if($scope.sum>2)switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[next],flip1.classList.add("flipLeft"),flip2.classList.remove("flipRight"),flip3.classList.remove("flipLeft"),flip3.classList.add("flipRight");break;case 1:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],flip2.classList.add("flipLeft"),flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip3.classList.remove("flipRight");break;case 2:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip3.classList.add("flipLeft"),flip1.classList.remove("flipRight"),flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight")}else if($scope.sum>1)switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],flip1.classList.contains("flipLeft")&&flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip2.classList.contains("flipLeft")&&flip2.classList.remove("flipLeft"),flip2.classList.contains("flipRight")&&flip2.classList.remove("flipRight");break;case 1:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[prev],flip2.classList.contains("flipLeft")&&flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight"),flip1.classList.contains("flipLeft")&&flip1.classList.remove("flipLeft"),flip1.classList.contains("flipRight")&&flip1.classList.remove("flipRight")}initChangeLanguage(),$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}else($scope.questionCurrent.ZISINPUT||$scope.questionCurrent.ZANSWER[0].checkAnswer||$scope.questionCurrent.ZANSWER[1].checkAnswer||$scope.questionCurrent.ZANSWER[2].checkAnswer)&&checkValid()},$scope.onBack=function(){$scope.count=0,$scope.sum=0,$scope.nextQuestion=1,$scope.countPlayVideo=5,$scope.listQuestion=[],$scope.questionCurrent=new QuestionModel,$scope.questionItem1=new QuestionModel,$scope.questionItem2=new QuestionModel,$scope.questionItem3=new QuestionModel,startPage=!1,2==$rootScope.questionChildOld?document.getElementById("questionByTheme").style.opacity="1":document.getElementById("mainQuestion").style.opacity="1";var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];null!=ipAnswer&&(ipAnswer.value="",ipAnswer.style.backgroundColor="#bdbdbd",ipAnswer.readOnly=!1),null!=ipAnswer1&&(ipAnswer1.value="",ipAnswer1.style.backgroundColor="#bdbdbd",ipAnswer1.readOnly=!1),null!=element.getElementsByClassName("ipAnswer1")[0]&&(element.getElementsByClassName("ipAnswer1")[0].value="",element.getElementsByClassName("ipAnswer1")[0].style.backgroundColor="#bdbdbd",element.getElementsByClassName("ipAnswer1")[0].readOnly=!1,element.getElementsByClassName("ipAnswer2")[0].value="",element.getElementsByClassName("ipAnswer2")[0].style.backgroundColor="#bdbdbd",element.getElementsByClassName("ipAnswer2")[0].readOnly=!1);var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");flip1.classList.contains("flipRight")&&flip1.classList.remove("flipRight"),flip1.classList.contains("flipLeft")||flip1.classList.add("flipLeft"),flip2.classList.contains("flipRight")&&flip2.classList.remove("flipRight"),flip2.classList.contains("flipLeft")&&flip2.classList.remove("flipLeft"),flip3.classList.contains("flipLeft")&&flip3.classList.remove("flipLeft"),flip3.classList.contains("flipRight")||flip3.classList.add("flipRight"),1==$scope.selectedIndex,$timeout(function(event){document.getElementById("listQuestion").style.display="none"},100),2==$rootScope.questionChildOld?($rootScope.questionChild=2,$rootScope.questionChildOld=0):$rootScope.questionChild=0};var promise;$scope.onSetHard=function(){null!=promise&&($timeout.cancel(promise),$scope.isShowBar=!1),db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?$scope.questionCurrent.ISHARD?db.updateQuestionUnHard($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.hardText=$scope.MenuQuestionItem.statusUnHard,$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1,$scope.questionCurrent.ISHARD=!1},3e3)}):db.updateQuestionHard($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.questionCurrent.ISHARD=!0,$scope.hardText=$scope.MenuQuestionItem.statusHard,$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addQuestionHard($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.questionCurrent.ISHARD=!0,$scope.hardText=$scope.MenuQuestionItem.statusHard,$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),$rootScope.audio&&$rootScope.$broadcast("playaudio","hard")},$scope.onCheckValid=function(){checkValid()},$scope.onBlurNextQ=function(event){if(($scope.nextQuestion<1||$scope.nextQuestion>$scope.sum)&&($scope.nextQuestion=1),$scope.nextQuestion=null!=$scope.nextQuestion?$scope.nextQuestion:1,$scope.count=$scope.nextQuestion-1,$scope.listQuestion[$scope.count].ZANSWER[0].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[1].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ZANSWER[2].isValid="img/answer_uncheck.png",$scope.listQuestion[$scope.count].ISANSWERED=!1,$scope.questionCurrent=$scope.listQuestion[$scope.count],$scope.questionCurrent.ZISVIDEO&&($scope.questionCurrent.ZVARIANT=!0),$scope.nextQuestion>$scope.count){var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");if($scope.sum>2)var prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;else if($scope.sum>1)var prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=prev;else if($scope.sum>0)var prev=$scope.count,next=prev;switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem2=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[next],flip1.classList.add("flipLeft"),flip2.classList.remove("flipRight"),flip3.classList.remove("flipLeft"),flip3.classList.add("flipRight");break;case 1:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[$scope.count],flip2.classList.add("flipLeft"),flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip3.classList.remove("flipRight");break;case 2:$scope.selectedIndex=0,$scope.questionItem1=$scope.listQuestion[$scope.count],$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip3.classList.add("flipLeft"),flip1.classList.remove("flipRight"),flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight")}}else{var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");if($scope.sum>2)var prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;else if($scope.sum>1)var prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=prev;else if($scope.sum>0)var prev=$scope.count,next=prev;switch($scope.selectedIndex){case 0:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[$scope.count],flip1.classList.add("flipRight"),flip2.classList.remove("flipRight"),flip2.classList.add("flipLeft"),flip3.classList.remove("flipLeft");break;case 1:$scope.selectedIndex=0,$scope.questionItem1=$scope.listQuestion[$scope.count],$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip2.classList.add("flipRight"),flip1.classList.remove("flipLeft"),flip3.classList.remove("flipRight"),flip3.classList.add("flipLeft");break;case 2:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem2=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[next],flip3.classList.add("flipRight"),flip1.classList.remove("flipRight"),flip1.classList.add("flipLeft"),flip2.classList.remove("flipLeft")}}initChangeLanguage(),$rootScope.audio&&$rootScope.$broadcast("playaudio","next")},$ionicModal.fromTemplateUrl("full-image-modal.html",{scope:$scope,animation:"none"}).then(function(modal){$scope.imageModal=modal}),$scope.fullImage=function(){$scope.questionCurrent.ZISVIDEO?playVideo():$scope.imageModal.show()},$scope.hide=function(){$scope.imageModal.hide()}}).directive("numbersOnly",function(){return{require:"ngModel",link:function(scope,element,attr,ngModelCtrl){function fromUser(text){if(text){var transformedInput=text.replace(/[^0-9]/g,"");return transformedInput!==text&&(ngModelCtrl.$setViewValue(transformedInput),ngModelCtrl.$render()),transformedInput}}ngModelCtrl.$parsers.push(fromUser)}}}).directive("bindHtmlCompile",["$compile",function($compile){return{restrict:"A",link:function(scope,element,attrs){scope.$watch(function(){return scope.$eval(attrs.bindHtmlCompile)},function(value){element.html(value&&value.toString());var compileScope=scope;attrs.bindHtmlScope&&(compileScope=scope.$eval(attrs.bindHtmlScope)),$compile(element.contents())(compileScope)})}}}])}(),function(){"use strict";angular.module("TrafficLaws.TestController",["ui.router","TrafficLaws.databaseService"]).controller("TestCtrl",function($scope,$rootScope,$q,$sce,$state,$window,db,$interval,$timeout,$http,$ionicModal,$ionicLoading){function init(){0==$rootScope.language?($scope.MenuQuestionItem.klass=$rootScope.Menu.vn.klass,$scope.MenuQuestionItem.codeQuestion=$rootScope.Menu.vn.code_question,$scope.MenuQuestionItem.point=$rootScope.Menu.vn.point,$scope.MenuQuestionItem.back=$rootScope.Menu.vn.cancel,$scope.MenuQuestionItem.submit=$rootScope.Menu.vn.submit,$scope.MenuQuestionItem.next=$rootScope.Menu.vn.next_question,$scope.MenuQuestionItem.ticked=$rootScope.Menu.vn.ticked,$scope.MenuQuestionItem.noch=$rootScope.Menu.vn.count_ticked_1,$scope.MenuQuestionItem.aufgaben=$rootScope.Menu.vn.count_ticked_2,$scope.MenuQuestionItem.filmStart=$rootScope.Menu.vn.button_start_video,$scope.MenuQuestionItem.viewQuestion=$rootScope.Menu.vn.view_question_video,$scope.MenuQuestionItem.titleCount1=$rootScope.Menu.vn.title_count_play1,$scope.MenuQuestionItem.titleCount2=$rootScope.Menu.vn.title_count_play2,$scope.MenuQuestionItem.yourAnswer=$rootScope.Menu.vn.your_answer,$scope.MenuQuestionItem.rightAnswer=$rootScope.Menu.vn.right_answer,$scope.MenuQuestionItem.messageSubmit=$rootScope.Menu.vn.submit_check,$scope.MenuQuestionItem.messageDialog=$rootScope.Menu.vn.show_question,$scope.MenuQuestionItem.yes=$rootScope.Menu.vn.yes,$scope.MenuQuestionItem.no=$rootScope.Menu.vn.no,$scope.MenuQuestionItem.statusHard=$rootScope.Menu.vn.status_answer_hard,$scope.MenuQuestionItem.statusUnHard=$rootScope.Menu.vn.status_answer_un_hard,$scope.MenuQuestionItem.backMessage=$rootScope.Menu.vn.back_check,$scope.MenuQuestionItem.alertSubmit1=$rootScope.Menu.vn.alert_submit,$scope.MenuQuestionItem.alertSubmit2=$rootScope.Menu.vn.alert_submit_1,$scope.MenuQuestionItem.causeTion=$rootScope.Menu.vn.cause_tion,$scope.titlePlayVideo=$rootScope.Menu.vn.start_video,$scope.MenuQuestionItem.grundstoft=$rootScope.Menu.vn.basic_test):($scope.MenuQuestionItem.klass=$rootScope.Menu.de.klass,$scope.MenuQuestionItem.codeQuestion=$rootScope.Menu.de.code_question,$scope.MenuQuestionItem.point=$rootScope.Menu.de.point,$scope.MenuQuestionItem.back=$rootScope.Menu.de.cancel,$scope.MenuQuestionItem.submit=$rootScope.Menu.de.submit,$scope.MenuQuestionItem.next=$rootScope.Menu.de.next_question,$scope.MenuQuestionItem.ticked=$rootScope.Menu.de.ticked,$scope.MenuQuestionItem.noch=$rootScope.Menu.de.count_ticked_1,$scope.MenuQuestionItem.aufgaben=$rootScope.Menu.de.count_ticked_2,$scope.MenuQuestionItem.filmStart=$rootScope.Menu.de.button_start_video,$scope.MenuQuestionItem.viewQuestion=$rootScope.Menu.de.view_question_video,$scope.MenuQuestionItem.titleCount1=$rootScope.Menu.de.title_count_play1,$scope.MenuQuestionItem.titleCount2=$rootScope.Menu.de.title_count_play2,$scope.MenuQuestionItem.yourAnswer=$rootScope.Menu.de.your_answer,$scope.MenuQuestionItem.rightAnswer=$rootScope.Menu.de.right_answer,$scope.MenuQuestionItem.messageSubmit=$rootScope.Menu.de.submit_check,$scope.MenuQuestionItem.messageDialog=$rootScope.Menu.de.show_question,$scope.MenuQuestionItem.yes=$rootScope.Menu.de.yes,$scope.MenuQuestionItem.no=$rootScope.Menu.de.no,$scope.MenuQuestionItem.statusHard=$rootScope.Menu.de.status_answer_hard,$scope.MenuQuestionItem.statusUnHard=$rootScope.Menu.de.status_answer_un_hard,$scope.MenuQuestionItem.backMessage=$rootScope.Menu.de.back_check,$scope.MenuQuestionItem.alertSubmit1=$rootScope.Menu.de.alert_submit,$scope.MenuQuestionItem.alertSubmit2=$rootScope.Menu.de.alert_submit_1,$scope.MenuQuestionItem.causeTion=$rootScope.Menu.de.cause_tion,$scope.titlePlayVideo=$rootScope.Menu.de.start_video,$scope.MenuQuestionItem.grundstoft=$rootScope.Menu.de.basic_test)}function initResult(){0==$rootScope.language?($scope.MenuQuestionResult.klass=$rootScope.Menu.vn.klass,$scope.MenuQuestionResult.title=$rootScope.Menu.vn.result_title,$scope.MenuQuestionResult.backtest=$rootScope.Menu.vn.back_test,$scope.MenuQuestionResult.advanced=$rootScope.Menu.vn.advanced,$scope.MenuQuestionResult.pointsError=$rootScope.Menu.vn.point_error,$scope.MenuQuestionResult.basicTest=$rootScope.Menu.vn.basic_test,$scope.MenuQuestionResult.notbestanden=$rootScope.Menu.vn.not_bestanden,$scope.MenuQuestionResult.bestanden=$rootScope.Menu.vn.bestanden):($scope.MenuQuestionResult.klass=$rootScope.Menu.de.klass,$scope.MenuQuestionResult.title=$rootScope.Menu.de.result_title,$scope.MenuQuestionResult.backtest=$rootScope.Menu.de.back_test,$scope.MenuQuestionResult.advanced=$rootScope.Menu.de.advanced,$scope.MenuQuestionResult.pointsError=$rootScope.Menu.de.point_error,$scope.MenuQuestionResult.basicTest=$rootScope.Menu.de.basic_test,$scope.MenuQuestionResult.notbestanden=$rootScope.Menu.de.not_bestanden,$scope.MenuQuestionResult.bestanden=$rootScope.Menu.de.bestanden)}function callbackAllQuestion(data){$scope.ZTNO=data.ZTNO,$scope.testId=data.ZID,db.selectQuestionByIdByTest(data.ZCOMBINATION).then(callbackGetId),startTimer(timer),$ionicLoading.hide()}function callbackGetId(data){$scope.sum=data.length,$scope.count_ticked=data.length;for(var i=0;i<data.length;i++){var questionItem=new QuestionModel;if(questionItem.number=data[i].number+1,questionItem.Z_PK=data[i].Z_PK,questionItem.Z_ENT=data[i].Z_ENT,questionItem.Z_OPT=data[i].Z_OPT,questionItem.ZID=data[i].ZID,questionItem.ZTESTIMAGE=data[i].ZTESTIMAGE,questionItem.ZUPDATE=data[i].ZUPDATE,questionItem.ZISHTML=data[i].ZISHTML,questionItem.ZISVIDEO=1==data[i].ZISVIDEO,questionItem.ZISVIDEO_DEFAULT=questionItem.ZISVIDEO,questionItem.countPlayVideo=questionItem.ZISVIDEO?5:0,questionItem.ZOLDID=data[i].ZOLDID,questionItem.ZTESTBIGIMAGE=data[i].ZTESTBIGIMAGE,questionItem.ZL=data[i].ZL,questionItem.ZPOINTS=data[i].ZPOINTS,questionItem.ZTHEMA=data[i].ZTHEMA,questionItem.ZQZG=data[i].ZQZG,questionItem.ZVALID1=data[i].ZVALID1,questionItem.ZVALID2=data[i].ZVALID2,questionItem.ZVALID3=data[i].ZVALID3,questionItem.ZISINPUT=1==data[i].ZISINPUT,questionItem.ZISINPUT){if(0==$rootScope.language){var t1=data[i].ZANSWER1VN.indexOf("^"),answer1=data[i].ZANSWER1VN.substring(0,t1),answer2=data[i].ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;questionItem.textip1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='",questionItem.textip1_1VN="' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='",questionItem.textip1_2VN="' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",questionItem.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",questionItem.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>",questionItem.ZINPUTRIGHT1=valid1,questionItem.ZINPUTRIGHT2=valid2}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";questionItem.textip1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='",questionItem.textip1_1VN="' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",questionItem.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",questionItem.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>",questionItem.ZINPUTRIGHT1=valid}questionItem.ANSWERINPUTSTRING1TEMP=questionItem.ANSWERINPUTSTRING1VN,questionItem.ANSWERINPUTSTRING2TEMP=questionItem.ANSWERINPUTSTRING2VN}var t1=data[i].ZANSWER1.indexOf("^"),answer1=data[i].ZANSWER1.substring(0,t1),answer2=data[i].ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;questionItem.textip1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='",questionItem.textip1_1="' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='",questionItem.textip1_2="' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",questionItem.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input class='ipAnswer1' type='text' value='' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipAnswer2' value='' type='text' />&nbsp<p>"+utils.convertText(text2)+"</p>",questionItem.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input class='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>",questionItem.ZINPUTRIGHT1=valid1,questionItem.ZINPUTRIGHT2=valid2}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";questionItem.textip1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='",questionItem.textip1_1="' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",questionItem.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='' type='text' />&nbsp<p> "+utils.convertText(text)+"</p>",questionItem.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>",questionItem.ZINPUTRIGHT1=valid}}questionItem.ISHARD=1==data[i].ZDIFFICULT,null!=data[i].ZPRETEXT&&(data[i].ZPRETEXT=data[i].ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data[i].ZPRETEXT=data[i].ZPRETEXT.replace(/(]\})/g,"</b>")),questionItem.ZPRETEXT=null!=data[i].ZPRETEXT?$sce.trustAsHtml(utils.convertText(data[i].ZPRETEXT)):null,questionItem.ZISPRETEXT=null!=data[i].ZPRETEXT,questionItem.ZIMAGE="img/"+data[i].ZIMAGE,questionItem.ZISIMAGE=null!=data[i].ZIMAGE,questionItem.ZWBMP=data[i].ZWBMP,null!=data[i].ZQUESTION&&(data[i].ZQUESTION=data[i].ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data[i].ZQUESTION=data[i].ZQUESTION.replace(/(]\})/g,"</b>")),questionItem.ZQUESTION=$sce.trustAsHtml(utils.convertText(data[i].ZQUESTION+"&nbsp"+(null!=data[i].ZKOMENTAR?data[i].ZKOMENTAR:""))),questionItem.ZQUESTIONIMAGE=data[i].ZQUESTIONIMAGE,questionItem.ZTIP=data[i].ZTIP,questionItem.ZKOMENTAR=data[i].ZKOMENTAR,questionItem.ZSETNAME=data[i].ZSETNAME,questionItem.ZNOTUSED=data[i].ZNOTUSED,questionItem.ZTYPE=data[i].ZTYPE,questionItem.ZFRAGENKATALOG=data[i].ZFRAGENKATALOG,questionItem.ZVARIANT=data[i].ZFRAGENKATALOG.indexOf("M")>0||data[i].ZFRAGENKATALOG.indexOf("B")>0,questionItem.ZBIGIMAGE="img/"+data[i].ZBIGIMAGE,questionItem.ZCOMMENTMOFFA=data[i].ZCOMMENTMOFFA,questionItem.ZCOMMENTZ=data[i].ZCOMMENTZ,questionItem.ZPRETEXTVN=null!=data[i].ZPRETEXTVN?$sce.trustAsHtml(data[i].ZPRETEXTVN):null,questionItem.ZQUESTIONVN=null!=data[i].ZQUESTIONVN?$sce.trustAsHtml(data[i].ZQUESTIONVN):null,questionItem.ISCHECK=!1,questionItem.ZICON=1==data[i].ZISVIDEO?"img/answer_wrong_vd.png":"img/answer_wrong.png",null!=data[i].ZANSWER1&&(data[i].ZANSWER1=data[i].ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data[i].ZANSWER1=data[i].ZANSWER1.replace(/(]\})/g,"</b>")),null!=data[i].ZANSWER2&&(data[i].ZANSWER2=data[i].ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data[i].ZANSWER2=data[i].ZANSWER2.replace(/(]\})/g,"</b>")),null!=data[i].ZANSWER3&&(data[i].ZANSWER3=data[i].ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),
data[i].ZANSWER3=data[i].ZANSWER3.replace(/(]\})/g,"</b>")),null!=data[i].ZANSWER1VN&&(data[i].ZANSWER1VN=data[i].ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data[i].ZANSWER1VN=data[i].ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data[i].ZANSWER2VN&&(data[i].ZANSWER2VN=data[i].ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data[i].ZANSWER2VN=data[i].ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data[i].ZANSWER3VN&&(data[i].ZANSWER3VN=data[i].ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data[i].ZANSWER3VN=data[i].ZANSWER3VN.replace(/(]\})/g,"</b>")),questionItem.ZANSWER[0].vn.ZANSWER=null!=data[i].ZANSWER1VN?$sce.trustAsHtml(data[i].ZANSWER1VN):null,questionItem.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data[i].ZANSWER1IMAGE,questionItem.ZANSWER[0].de.ZANSWER=null!=data[i].ZANSWER1?$sce.trustAsHtml(utils.convertText(data[i].ZANSWER1)):null,questionItem.ZANSWER[0].de.ZANSWERIMAGE="img/"+data[i].ZANSWER1IMAGE,questionItem.ZANSWER[0].isImage=null!=data[i].ZANSWER1IMAGE,questionItem.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,questionItem.ZANSWER[1].vn.ZANSWER=null!=data[i].ZANSWER2VN?$sce.trustAsHtml(data[i].ZANSWER2VN):null,questionItem.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data[i].ZANSWER2IMAGE,questionItem.ZANSWER[1].de.ZANSWER=null!=data[i].ZANSWER2?$sce.trustAsHtml(utils.convertText(data[i].ZANSWER2)):null,questionItem.ZANSWER[1].de.ZANSWERIMAGE="img/"+data[i].ZANSWER2IMAGE,questionItem.ZANSWER[1].isImage=null!=data[i].ZANSWER2IMAGE,questionItem.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,questionItem.ZANSWER[2].vn.ZANSWER=null!=data[i].ZANSWER3VN?$sce.trustAsHtml(data[i].ZANSWER3VN):null,questionItem.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data[i].ZANSWER3IMAGE,questionItem.ZANSWER[2].de.ZANSWER=null!=data[i].ZANSWER3?$sce.trustAsHtml(utils.convertText(data[i].ZANSWER3)):null,questionItem.ZANSWER[2].de.ZANSWERIMAGE="img/"+data[i].ZANSWER3IMAGE,questionItem.ZANSWER[2].isImage=null!=data[i].ZANSWER3IMAGE,questionItem.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,questionItem.ZANSWER[0].isAnswer=null!=data[i].ZANSWER1,questionItem.ZANSWER[1].isAnswer=null!=data[i].ZANSWER2,questionItem.ZANSWER[2].isAnswer=null!=data[i].ZANSWER3,questionItem.ZANSWER[0].checkAnswer=!1,questionItem.ZANSWER[1].checkAnswer=!1,questionItem.ZANSWER[2].checkAnswer=!1,$scope.pointsError+=questionItem.ZPOINTS,data[i].number<20?(questionItem.ZFRAGENKATALOG.indexOf("1.1")>-1?($scope.listTheme1_1.count+=1,$scope.listTheme1_1.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("1.2")>-1?($scope.listTheme1_2.count+=1,$scope.listTheme1_2.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("1.3")>-1?($scope.listTheme1_3.count+=1,$scope.listTheme1_3.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("1.4")>-1?($scope.listTheme1_4.count+=1,$scope.listTheme1_4.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("1.5")>-1?($scope.listTheme1_5.count+=1,$scope.listTheme1_5.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("1.7")>-1&&($scope.listTheme1_7.count+=1,$scope.listTheme1_7.listItem.push(questionItem)),$scope.listIdGrunt.push(questionItem),$scope.pointsBasicError+=questionItem.ZPOINTS):(questionItem.ZFRAGENKATALOG.indexOf("2.1")>-1?($scope.listTheme2_1.count+=1,$scope.listTheme2_1.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("2.2")>-1?($scope.listTheme2_2.count+=1,$scope.listTheme2_2.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("2.4")>-1?($scope.listTheme2_4.count+=1,$scope.listTheme2_4.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("2.5")>-1?($scope.listTheme2_5.count+=1,$scope.listTheme2_5.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("2.6")>-1?($scope.listTheme2_6.count+=1,$scope.listTheme2_6.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("2.7")>-1?($scope.listTheme2_7.count+=1,$scope.listTheme2_7.listItem.push(questionItem)):questionItem.ZFRAGENKATALOG.indexOf("2.8")>-1&&($scope.listTheme2_8.count+=1,$scope.listTheme2_8.listItem.push(questionItem)),$scope.pointsAdvancedError+=questionItem.ZPOINTS,$scope.listIdB.push(questionItem)),0==$rootScope.language?(questionItem.ZQUESTIONTEMP=questionItem.ZQUESTIONVN,questionItem.ZANSWER[0].ZANSWER=questionItem.ZANSWER[0].vn.ZANSWER,questionItem.ZANSWER[1].ZANSWER=questionItem.ZANSWER[1].vn.ZANSWER,questionItem.ZANSWER[2].ZANSWER=questionItem.ZANSWER[2].vn.ZANSWER):(questionItem.ZQUESTIONTEMP=questionItem.ZQUESTION,questionItem.ZANSWER[0].ZANSWER=questionItem.ZANSWER[0].de.ZANSWER,questionItem.ZANSWER[1].ZANSWER=questionItem.ZANSWER[1].de.ZANSWER,questionItem.ZANSWER[2].ZANSWER=questionItem.ZANSWER[2].de.ZANSWER),$scope.listQuestion.push(questionItem),30==$scope.listQuestion.length&&($scope.listTheme1_1.count>0&&$scope.listBasic.push($scope.listTheme1_1),$scope.listTheme1_2.count>0&&$scope.listBasic.push($scope.listTheme1_2),$scope.listTheme1_3.count>0&&$scope.listBasic.push($scope.listTheme1_3),$scope.listTheme1_4.count>0&&$scope.listBasic.push($scope.listTheme1_4),$scope.listTheme1_5.count>0&&$scope.listBasic.push($scope.listTheme1_5),$scope.listTheme1_7.count>0&&$scope.listBasic.push($scope.listTheme1_7),$scope.listTheme2_1.count>0&&$scope.listAdvanced.push($scope.listTheme2_1),$scope.listTheme2_2.count>0&&$scope.listAdvanced.push($scope.listTheme2_2),$scope.listTheme2_4.count>0&&$scope.listAdvanced.push($scope.listTheme2_4),$scope.listTheme2_5.count>0&&$scope.listAdvanced.push($scope.listTheme2_5),$scope.listTheme2_6.count>0&&$scope.listAdvanced.push($scope.listTheme2_6),$scope.listTheme2_7.count>0&&$scope.listAdvanced.push($scope.listTheme2_7),$scope.listTheme2_8.count>0&&$scope.listAdvanced.push($scope.listTheme2_8),initChangeLanguageResult(),initChangeLanguage(),$scope.listQuestion[$scope.count].ZISVIDEO&&($scope.listQuestion[$scope.count].ZVARIANT=!0),$scope.questionCurrent=$scope.listQuestion[$scope.count],$scope.questionItem1=$scope.listQuestion[$scope.sum-1],$scope.questionItem2=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[$scope.count+1],document.getElementById("toolbar3").style.display="block")}}function initChangeLanguage(){0==$rootScope.language?($scope.listQuestion[$scope.count].ZQUESTIONTEMP=$scope.listQuestion[$scope.count].ZQUESTIONVN,$scope.listQuestion[$scope.count].ZANSWER[0].ZANSWER=$scope.listQuestion[$scope.count].ZANSWER[0].vn.ZANSWER,$scope.listQuestion[$scope.count].ZANSWER[1].ZANSWER=$scope.listQuestion[$scope.count].ZANSWER[1].vn.ZANSWER,$scope.listQuestion[$scope.count].ZANSWER[2].ZANSWER=$scope.listQuestion[$scope.count].ZANSWER[2].vn.ZANSWER,$scope.listQuestion[$scope.count].ZPRETEXTTEMP=$scope.listQuestion[$scope.count].ZPRETEXTVN,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1TEMP=$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1VN,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING2TEMP=$scope.listQuestion[$scope.count].ANSWERINPUTSTRING2VN,$scope.listQuestion[$scope.count].ZISVIDEO&&($scope.listQuestion[$scope.count].countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"&nbsp;<b style='color: #e50000;'>"+$scope.listQuestion[$scope.count].countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>")),$scope.questionCurrent.ZQUESTIONTEMP=$scope.questionCurrent.ZQUESTIONVN,$scope.questionCurrent.ZANSWER[0].ZANSWER=$scope.questionCurrent.ZANSWER[0].vn.ZANSWER,$scope.questionCurrent.ZANSWER[1].ZANSWER=$scope.questionCurrent.ZANSWER[1].vn.ZANSWER,$scope.questionCurrent.ZANSWER[2].ZANSWER=$scope.questionCurrent.ZANSWER[2].vn.ZANSWER,$scope.questionCurrent.ZPRETEXTTEMP=$scope.questionCurrent.ZPRETEXTVN,$scope.questionCurrent.ANSWERINPUTSTRING1TEMP=$scope.questionCurrent.ANSWERINPUTSTRING1VN,$scope.questionCurrent.ANSWERINPUTSTRING2TEMP=$scope.questionCurrent.ANSWERINPUTSTRING2VN,$scope.questionCurrent.ZISVIDEO&&($scope.questionCurrent.countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"&nbsp;<b style='color: #e50000;'>"+$scope.questionCurrent.countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>"))):($scope.listQuestion[$scope.count].ZQUESTIONTEMP=$scope.listQuestion[$scope.count].ZQUESTION,$scope.listQuestion[$scope.count].ZANSWER[0].ZANSWER=$scope.listQuestion[$scope.count].ZANSWER[0].de.ZANSWER,$scope.listQuestion[$scope.count].ZANSWER[1].ZANSWER=$scope.listQuestion[$scope.count].ZANSWER[1].de.ZANSWER,$scope.listQuestion[$scope.count].ZANSWER[2].ZANSWER=$scope.listQuestion[$scope.count].ZANSWER[2].de.ZANSWER,$scope.listQuestion[$scope.count].ZPRETEXTTEMP=$scope.listQuestion[$scope.count].ZPRETEXT,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1TEMP=$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING2TEMP=$scope.listQuestion[$scope.count].ANSWERINPUTSTRING2,$scope.listQuestion[$scope.count].ZISVIDEO&&($scope.listQuestion[$scope.count].countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"<br /><b style='color: #e50000;'>"+$scope.listQuestion[$scope.count].countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>")),$scope.questionCurrent.ZQUESTIONTEMP=$scope.questionCurrent.ZQUESTION,$scope.questionCurrent.ZANSWER[0].ZANSWER=$scope.questionCurrent.ZANSWER[0].de.ZANSWER,$scope.questionCurrent.ZANSWER[1].ZANSWER=$scope.questionCurrent.ZANSWER[1].de.ZANSWER,$scope.questionCurrent.ZANSWER[2].ZANSWER=$scope.questionCurrent.ZANSWER[2].de.ZANSWER,$scope.questionCurrent.ZPRETEXTTEMP=$scope.questionCurrent.ZPRETEXT,$scope.questionCurrent.ANSWERINPUTSTRING1TEMP=$scope.questionCurrent.ANSWERINPUTSTRING1,$scope.questionCurrent.ANSWERINPUTSTRING2TEMP=$scope.questionCurrent.ANSWERINPUTSTRING2,$scope.questionCurrent.ZISVIDEO&&($scope.questionCurrent.countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"&nbsp;<b style='color: #e50000;'>"+$scope.questionCurrent.countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>")))}function initChangeLanguageResult(){for(var i=0;i<$scope.listBasic.length;i++)0==$rootScope.language?$scope.listBasic[i].title=$scope.listBasic[i].title_vn:$scope.listBasic[i].title=$scope.listBasic[i].title_de;for(var i=0;i<$scope.listAdvanced.length;i++)0==$rootScope.language?$scope.listAdvanced[i].title=$scope.listAdvanced[i].title_vn:$scope.listAdvanced[i].title=$scope.listAdvanced[i].title_de}function endedVideo(e){0==$scope.listQuestion[$scope.count].countPlayVideo&&($scope.listQuestion[$scope.count].questionCurrent.ZISVIDEO=!1,$scope.listQuestion[$scope.count].countPlayVideo=5)}function playVideo(){var filename=$scope.questionCurrent.ZFRAGENKATALOG.split(".").join("_"),videoPath=$rootScope.assetsPath+"videos/iOS/WVGA/"+filename.replace(/-/g,"_")+".mp4",options={successCallback:function(){window.plugins.streamingMedia.stop(),console.log("Player closed without error."),endedVideo()},errorCallback:function(errMsg){console.log("Error! "+errMsg)}};window.plugins.streamingMedia.playVideo(videoPath,options),$scope.listQuestion[$scope.count].countPlayVideo-=1,$scope.questionCurrent.ZIMAGE=$scope.questionCurrent.ZBIGIMAGE,0==$scope.listQuestion[$scope.count].countPlayVideo&&($scope.questionCurrent.ZISVIDEO=!1,$scope.listQuestion[$scope.count].countPlayVideo=5),0==$rootScope.language?$scope.listQuestion[$scope.count].countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"&nbsp;<b style='color: #e50000;'>"+$scope.listQuestion[$scope.count].countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>"):$scope.listQuestion[$scope.count].countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"<br /><b style='color: #e50000;'>"+$scope.listQuestion[$scope.count].countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>")}function alertCloseVideo(message,yes,no){navigator.notification.confirm(message,onConfirm,$scope.MenuQuestionItem.causeTion,[yes,no])}function onConfirm(buttonIndex){2!=buttonIndex&&($scope.questionCurrent.ZISVIDEO=!1,$scope.listQuestion[$scope.count].countPlayVideo=5)}function startTimer(duration){var minutes,seconds,timer1=duration;interval=$interval(function(){minutes=parseInt(timer1/60,10),seconds=parseInt(timer1%60,10),$scope.timeStamp=60*minutes+seconds,minutes=10>minutes?"0"+minutes:minutes,seconds=10>seconds?"0"+seconds:seconds,$scope.timerCount=minutes+":"+seconds+" ",$rootScope.titleAll=minutes+":"+seconds+" ",--timer1<0&&($interval.cancel(interval),$timeout(function(){$scope.modal.show(),checkAnswered()},500))},1e3)}function alertBackTest(message,yes,no){navigator.notification.confirm(message,onBackTest,"",[yes,no])}function onBackTest(index){2!=index&&($interval.cancel(interval),3==$rootScope.startApp?($state.go("home",{},{location:"replace"}),$rootScope.isBack=!1,$rootScope.imgIconLeft="img/setting_white.png"):$window.history.back())}function alertSubmit(message,yes,no){navigator.notification.confirm(message+"\n\r"+$scope.MenuQuestionItem.alertSubmit1+$scope.count_ticked+$scope.MenuQuestionItem.alertSubmit2,onSubmit,$scope.MenuQuestionItem.submit,[yes,no])}function onSubmit(index){2!=index&&($interval.cancel(interval),$timeout(function(){$scope.modal.show(),document.getElementById("dvCountTicked").style.display="none",checkAnswered()},500))}function checkAnswered(){for(var i=0;i<$scope.listQuestion.length;i++)if($scope.listQuestion[i].ISANSWERED=!0,$scope.listQuestion[i].ZISVIDEO=!1,$scope.listQuestion[i].ZISINPUT){if(null==$scope.listQuestion[i].ZINPUTANSWER2){if(null!=$scope.listQuestion[i].ZINPUTANSWER1&&($scope.listQuestion[i].ZINPUTANSWER1=$scope.listQuestion[i].ZINPUTANSWER1.replace(".",",")),$scope.listQuestion[i].ANSWERINPUTSTRING1=$scope.listQuestion[i].textip1+$scope.listQuestion[i].ZINPUTANSWER1+$scope.listQuestion[i].textip1_1,$scope.listQuestion[i].ANSWERINPUTSTRING1VN=$scope.listQuestion[i].textip1VN+$scope.listQuestion[i].ZINPUTANSWER1+$scope.listQuestion[i].textip1_1VN,$scope.listQuestion[i].ZINPUTANSWER1==$scope.listQuestion[i].ZINPUTRIGHT1?($scope.listQuestion[i].ANSWERRIGHT=!0,$scope.listQuestion[i].ZICON=$scope.listQuestion[i].ZISVIDEO?"img/answer_right_vd.png":"img/answer_right.png",$scope.countRight+=1,$scope.pointsError-=$scope.listQuestion[i].ZPOINTS,20>i?$scope.pointsBasicError-=$scope.listQuestion[i].ZPOINTS:$scope.pointsAdvancedError-=$scope.listQuestion[i].ZPOINTS,db.checkIfExistsQuestionTest($scope.listQuestion[i].ZID,i).then(function(data){data.ZQUESTION==$scope.listQuestion[data.number].ZID?db.updateAnswerRight($scope.listQuestion[data.number].ZID):db.addAnswerRight($scope.listQuestion[data.number].ZID)})):($scope.listQuestion[i].ANSWERRIGHT=!1,$scope.listQuestion[i].ISCHECK&&($scope.listQuestion[i].ZICON=$scope.listQuestion[i].ZISVIDEO?"img/answer_wrong1_vd.png":"img/answer_wrong1.png",db.checkIfExistsQuestionTest($scope.listQuestion[i].ZID,i).then(function(data){data.ZQUESTION==$scope.listQuestion[data.number].ZID?db.updateAnswerWrong($scope.listQuestion[data.number].ZID):db.addAnswerWrong($scope.listQuestion[data.number].ZID)}))),20>i){loop1:for(var j=0;j<$scope.listBasic.length;j++)for(var k=0;k<$scope.listBasic[j].listItem.length;k++)if($scope.listBasic[j].listItem[k].ZID==$scope.listQuestion[i].ZID){$scope.listBasic[j].listItem[k]=$scope.listQuestion[i];break loop1}}else loop1:for(var j=0;j<$scope.listAdvanced.length;j++)for(var k=0;k<$scope.listAdvanced[j].listItem.length;k++)if($scope.listAdvanced[j].listItem[k].ZID==$scope.listQuestion[i].ZID){$scope.listAdvanced[j].listItem[k]=$scope.listQuestion[i];break loop1}}else if(null!=$scope.listQuestion[i].ZINPUTANSWER1&&($scope.listQuestion[i].ZINPUTANSWER1=$scope.listQuestion[i].ZINPUTANSWER1.replace(".",",")),null!=$scope.listQuestion[i].ZINPUTANSWER2&&($scope.listQuestion[i].ZINPUTANSWER2=$scope.listQuestion[i].ZINPUTANSWER2.replace(".",",")),$scope.listQuestion[i].ANSWERINPUTSTRING1VN=$scope.listQuestion[i].textip1VN+$scope.listQuestion[i].ZINPUTANSWER1+$scope.listQuestion[i].textip1_1VN+$scope.listQuestion[i].ZINPUTANSWER2+$scope.listQuestion[i].textip1_2VN,$scope.listQuestion[i].ANSWERINPUTSTRING1=$scope.listQuestion[i].textip1+$scope.listQuestion[i].ZINPUTANSWER1+$scope.listQuestion[i].textip1_1+$scope.listQuestion[i].ZINPUTANSWER2+$scope.listQuestion[i].textip1_2,$scope.listQuestion[i].ZINPUTANSWER1==$scope.listQuestion[i].ZINPUTRIGHT1&&$scope.listQuestion[i].ZINPUTANSWER2==$scope.listQuestion[i].ZINPUTRIGHT2?($scope.listQuestion[i].ANSWERRIGHT=!0,$scope.listQuestion[i].ZICON=$scope.listQuestion[i].ZISVIDEO?"img/answer_right_vd.png":"img/answer_right.png",$scope.countRight+=1,$scope.pointsError-=$scope.listQuestion[i].ZPOINTS,20>i?$scope.pointsBasicError-=$scope.listQuestion[i].ZPOINTS:$scope.pointsAdvancedError-=$scope.listQuestion[i].ZPOINTS,db.checkIfExistsQuestionTest($scope.listQuestion[i].ZID,i).then(function(data){data.ZQUESTION==$scope.listQuestion[data.number].ZID?db.updateAnswerRight($scope.listQuestion[data.number].ZID):db.addAnswerRight($scope.listQuestion[data.number].ZID)})):($scope.listQuestion[i].ANSWERRIGHT=!1,$scope.listQuestion[i].ISCHECK&&($scope.listQuestion[i].ZICON=$scope.listQuestion[i].ZISVIDEO?"img/answer_wrong1_vd.png":"img/answer_wrong1.png",db.checkIfExistsQuestionTest($scope.listQuestion[i].ZID,i).then(function(data){data.ZQUESTION==$scope.listQuestion[data.number].ZID?db.updateAnswerWrong($scope.listQuestion[data.number].ZID):db.addAnswerWrong($scope.listQuestion[data.number].ZID)}))),20>i){loop1:for(var j=0;j<$scope.listBasic.length;j++)for(var k=0;k<$scope.listBasic[j].listItem.length;k++)if($scope.listBasic[j].listItem[k].ZID==$scope.listQuestion[i].ZID){$scope.listBasic[j].listItem[k]=$scope.listQuestion[i];break loop1}}else loop1:for(var j=0;j<$scope.listAdvanced.length;j++)for(var k=0;k<$scope.listAdvanced[j].listItem.length;k++)if($scope.listAdvanced[j].listItem[k].ZID==$scope.listQuestion[i].ZID){$scope.listAdvanced[j].listItem[k]=$scope.listQuestion[i];break loop1}}else if($scope.listQuestion[i].ZANSWER[0].checkAnswer?1==$scope.listQuestion[i].ZVALID1?($scope.listQuestion[i].ZANSWER[0].isValid="img/answer_right.png",$scope.listQuestion[i].ZANSWER[0].isRight=!0):($scope.listQuestion[i].ZANSWER[0].isValid="img/answer_wrong1.png",$scope.listQuestion[i].ZANSWER[0].isRight=!1):1==$scope.listQuestion[i].ZVALID1?($scope.listQuestion[i].ZANSWER[0].isValid="img/answer_right1.png",$scope.listQuestion[i].ZANSWER[0].isRight=!1):($scope.listQuestion[i].ZANSWER[0].isValid="img/answer_wrong.png",$scope.listQuestion[i].ZANSWER[0].isRight=!0),$scope.listQuestion[i].ZANSWER[1].checkAnswer?1==$scope.listQuestion[i].ZVALID2?($scope.listQuestion[i].ZANSWER[1].isValid="img/answer_right.png",$scope.listQuestion[i].ZANSWER[1].isRight=!0):($scope.listQuestion[i].ZANSWER[1].isValid="img/answer_wrong1.png",$scope.listQuestion[i].ZANSWER[1].isRight=!1):1==$scope.listQuestion[i].ZVALID2?($scope.listQuestion[i].ZANSWER[1].isValid="img/answer_right1.png",$scope.listQuestion[i].ZANSWER[1].isRight=!1):($scope.listQuestion[i].ZANSWER[1].isValid="img/answer_wrong.png",$scope.listQuestion[i].ZANSWER[1].isRight=!0),$scope.listQuestion[i].ZANSWER[2].checkAnswer?1==$scope.listQuestion[i].ZVALID3?($scope.listQuestion[i].ZANSWER[2].isValid="img/answer_right.png",$scope.listQuestion[i].ZANSWER[2].isRight=!0):($scope.listQuestion[i].ZANSWER[2].isValid="img/answer_wrong1.png",$scope.listQuestion[i].ZANSWER[2].isRight=!1):1==$scope.listQuestion[i].ZVALID3?($scope.listQuestion[i].ZANSWER[2].isValid="img/answer_right1.png",$scope.listQuestion[i].ZANSWER[2].isRight=!1):($scope.listQuestion[i].ZANSWER[2].isValid="img/answer_wrong.png",$scope.listQuestion[i].ZANSWER[2].isRight=!0),$scope.listQuestion[i].ZANSWER[0].isRight&&$scope.listQuestion[i].ZANSWER[1].isRight&&$scope.listQuestion[i].ZANSWER[2].isRight?($scope.listQuestion[i].ANSWERRIGHT=!0,$scope.listQuestion[i].ZICON=$scope.listQuestion[i].ZISVIDEO?"img/answer_right_vd.png":"img/answer_right.png",$scope.countRight+=1,$scope.pointsError-=$scope.listQuestion[i].ZPOINTS,20>i?$scope.pointsBasicError-=$scope.listQuestion[i].ZPOINTS:$scope.pointsAdvancedError-=$scope.listQuestion[i].ZPOINTS,db.checkIfExistsQuestionTest($scope.listQuestion[i].ZID,i).then(function(data){data.ZQUESTION==$scope.listQuestion[data.number].ZID?db.updateAnswerRight($scope.listQuestion[data.number].ZID):db.addAnswerRight($scope.listQuestion[data.number].ZID)})):($scope.listQuestion[i].ANSWERRIGHT=!1,$scope.listQuestion[i].ISCHECK&&($scope.listQuestion[i].ZICON=$scope.listQuestion[i].ZISVIDEO?"img/answer_wrong1_vd.png":"img/answer_wrong1.png",db.checkIfExistsQuestionTest($scope.listQuestion[i].ZID,i).then(function(data){data.ZQUESTION==$scope.listQuestion[data.number].ZID?db.updateAnswerWrong($scope.listQuestion[data.number].ZID):db.addAnswerWrong($scope.listQuestion[data.number].ZID)}))),20>i){loop1:for(var j=0;j<$scope.listBasic.length;j++)for(var k=0;k<$scope.listBasic[j].listItem.length;k++)if($scope.listBasic[j].listItem[k].ZID==$scope.listQuestion[i].ZID){$scope.listBasic[j].listItem[k]=$scope.listQuestion[i];break loop1}}else loop1:for(var j=0;j<$scope.listAdvanced.length;j++)for(var k=0;k<$scope.listAdvanced[j].listItem.length;k++)if($scope.listAdvanced[j].listItem[k].ZID==$scope.listQuestion[i].ZID){$scope.listAdvanced[j].listItem[k]=$scope.listQuestion[i];break loop1}$scope.countRight>=28?($scope.isBestanden=!0,$scope.result=1,$rootScope.audio&&$rootScope.$broadcast("playaudio","flap")):$rootScope.audio&&$rootScope.$broadcast("playaudio","error"),db.checkExistsTest($scope.testId).then(function(data){void 0!=data&&data==$scope.testId?db.updateTestStart($scope.pointsBasicError,$scope.result,$scope.pointsAdvancedError,$scope.timeStamp,1,$scope.testId):db.addTestStart($scope.pointsBasicError,$scope.result,$scope.pointsAdvancedError,$scope.timeStamp,1,$scope.testId)})}$ionicLoading.show({template:'<ion-spinner icon="lines"></ion-spinner>',hideOnStateChange:!0,noBackdrop:!0}),$scope.count=0,$scope.sum=0,$scope.testId=0,$scope.isTestEnd=!1,$scope.timeStamp=0,$scope.selectedIndex=1,$scope.count_ticked=0,$scope.countPlayVideo=5,$scope.pointsError=0,$scope.pointsBasicError=0,$scope.pointsAdvancedError=0,$scope.changes=0,$scope.changes1=0,$scope.changes2=0,$scope.listIdGrunt=[],$scope.listIdB=[],$scope.listQuestion=[],$scope.listBasic=[],$scope.listAdvanced=[],$rootScope.isBack=!0,$rootScope.searchDisabled=!0,$scope.listTheme1_1={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme1_2={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme1_3={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme1_4={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme1_5={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme1_7={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme2_1={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme2_2={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme2_4={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme2_5={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme2_6={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme2_7={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.listTheme2_8={title_vn:null,title_de:null,count:0,title:null,rightCount:0,wrongCount:0,listItem:[]},$scope.ZTNO=0,$scope.timerCount="59:59 ",$rootScope.titleAll="59:59 ",$scope.isShowBar=!1,$scope.hardText="",$scope.flipLeft=!1,$scope.flipRight=!1;var interval,isNext=!0,timer=3599,utils=new Utils($http);$scope.MenuQuestionItem={klass:null,codeQuestion:null,point:null,back:null,submit:null,next:null,ticked:null,noch:null,grundstoft:null,aufgaben:null,filmStart:null,viewQuestion:null,titleCount1:null,titleCount2:null,yourAnswer:null,rightAnswer:null,messageDialog:null,statusHard:null,yes:null,no:null,messageSubmit:null,statusUnHard:null,backMessage:null,alertSubmit1:null,alertSubmit2:null,causeTion:null},$scope.MenuQuestionResult={klass:null,title:null,backtest:null,advanced:null,pointsError:null,basicTest:null,notbestanden:null,bestanden:null},$scope.isLanguage=1!=$rootScope.language,$scope.isLanguageResult=!0,$scope.languageText=$scope.isLanguage?"DE":"VN",$scope.languageTextResult=$scope.isLanguageResult?"DE":"VN",$scope.questionCurrent=new QuestionModel,$scope.questionItem1=new QuestionModel,$scope.questionItem2=new QuestionModel,$scope.questionItem3=new QuestionModel;var type;init(),initResult(),type="RANDOM()",$scope.questionTheme1=new Array,$scope.questionTheme2=new Array,db.selectAllQuestionTheme().then(function(data){for(var i=0;i<data.length;i++)1==data[i].ZGROUP?$scope.questionTheme1.push(data[i]):2==data[i].ZGROUP&&$scope.questionTheme2.push(data[i]);$scope.listTheme1_1.title_vn=$scope.questionTheme1[0].ZNAMEVN,$scope.listTheme1_1.title_de=$scope.questionTheme1[0].ZNAMEDE,$scope.listTheme1_2.title_vn=$scope.questionTheme1[1].ZNAMEVN,$scope.listTheme1_2.title_de=$scope.questionTheme1[1].ZNAMEDE,$scope.listTheme1_3.title_vn=$scope.questionTheme1[2].ZNAMEVN,$scope.listTheme1_3.title_de=$scope.questionTheme1[2].ZNAMEDE,$scope.listTheme1_4.title_vn=$scope.questionTheme1[3].ZNAMEVN,$scope.listTheme1_4.title_de=$scope.questionTheme1[3].ZNAMEDE,$scope.listTheme1_5.title_vn=$scope.questionTheme1[4].ZNAMEVN,$scope.listTheme1_5.title_de=$scope.questionTheme1[4].ZNAMEDE,$scope.listTheme1_7.title_vn=$scope.questionTheme1[5].ZNAMEVN,$scope.listTheme1_7.title_de=$scope.questionTheme1[5].ZNAMEDE,$scope.listTheme2_1.title_vn=$scope.questionTheme2[0].ZNAMEVN,$scope.listTheme2_1.title_de=$scope.questionTheme2[0].ZNAMEDE,$scope.listTheme2_2.title_vn=$scope.questionTheme2[1].ZNAMEVN,$scope.listTheme2_2.title_de=$scope.questionTheme2[1].ZNAMEDE,$scope.listTheme2_4.title_vn=$scope.questionTheme2[2].ZNAMEVN,$scope.listTheme2_4.title_de=$scope.questionTheme2[2].ZNAMEDE,$scope.listTheme2_5.title_vn=$scope.questionTheme2[3].ZNAMEVN,$scope.listTheme2_5.title_de=$scope.questionTheme2[3].ZNAMEDE,$scope.listTheme2_6.title_vn=$scope.questionTheme2[4].ZNAMEVN,$scope.listTheme2_6.title_de=$scope.questionTheme2[4].ZNAMEDE,$scope.listTheme2_7.title_vn=$scope.questionTheme2[5].ZNAMEVN,$scope.listTheme2_7.title_de=$scope.questionTheme2[5].ZNAMEDE,$scope.listTheme2_8.title_vn=$scope.questionTheme2[6].ZNAMEVN,$scope.listTheme2_8.title_de=$scope.questionTheme2[6].ZNAMEDE,$rootScope.isActive?db.selectTestPackage(type).then(callbackAllQuestion):db.selectTestPackageFree(type).then(callbackAllQuestion)}),$scope.changeLanguage=function(){$scope.isLanguage=!$scope.isLanguage,$scope.languageText=$scope.isLanguage?"DE":"VN",init(),initChangeLanguage(),$rootScope.audio&&$rootScope.$broadcast("playaudio","lang")},$scope.$on("changeLanguage",function(event){init(),initChangeLanguage(),initResult(),initChangeLanguageResult()}),$scope.changeLanguageResults=function(){$scope.isLanguageResult=!$scope.isLanguageResult,$scope.languageTextResult=$scope.isLanguageResult?"DE":"VN",initResult(),initChangeLanguageResult(),$rootScope.audio&&$rootScope.$broadcast("playaudio","lang")},$scope.random=function(){return $rootScope.answeredRandom?.5-Math.random():null},$scope.blurInput1=function(){var element=document.getElementById("flip1"),ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer)ipAnswer.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):(null!=ipAnswer.value?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0,$scope.listQuestion[$scope.count].ZINPUTANSWER1=ipAnswer.value):($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ZINPUTANSWER1="",$scope.listQuestion[$scope.count].ISCHECK=!1),ipAnswer.blur());else{var ipAnswer2=element.getElementsByClassName("ipAnswer2")[0];ipAnswer1.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer1.blur(),ipAnswer2.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):(null!=ipAnswer1.value||null!=ipAnswer2.value?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0,$scope.listQuestion[$scope.count].ZINPUTANSWER1=ipAnswer1.value,$scope.listQuestion[$scope.count].ZINPUTANSWER2=ipAnswer2.value):($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1,$scope.listQuestion[$scope.count].ZINPUTANSWER1="",$scope.listQuestion[$scope.count].ZINPUTANSWER2=""),ipAnswer2.blur())}},$scope.blurInput2=function(){var element=document.getElementById("flip2"),ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer)ipAnswer.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):(null!=ipAnswer.value?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0,$scope.listQuestion[$scope.count].ZINPUTANSWER1=ipAnswer.value):($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ZINPUTANSWER1="",$scope.listQuestion[$scope.count].ISCHECK=!1),ipAnswer.blur());else{var ipAnswer2=element.getElementsByClassName("ipAnswer2")[0];ipAnswer1.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer1.blur(),ipAnswer2.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):(null!=ipAnswer1.value||null!=ipAnswer2.value?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0,scope.listQuestion[$scope.count].ISCHECK=!0,$scope.listQuestion[$scope.count].ZINPUTANSWER1=ipAnswer1.value,$scope.listQuestion[$scope.count].ZINPUTANSWER2=ipAnswer2.value):($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1,$scope.listQuestion[$scope.count].ZINPUTANSWER1="",$scope.listQuestion[$scope.count].ZINPUTANSWER2=""),ipAnswer2.blur())}},$scope.blurInput3=function(){var element=document.getElementById("flip3"),ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer)ipAnswer.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):(null!=ipAnswer.value?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0,$scope.listQuestion[$scope.count].ZINPUTANSWER1=ipAnswer.value):($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ZINPUTANSWER1="",$scope.listQuestion[$scope.count].ISCHECK=!1),ipAnswer.blur());else{var ipAnswer2=element.getElementsByClassName("ipAnswer2")[0];ipAnswer1.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):(null!=ipAnswer1.value||null!=ipAnswer2.value?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0,scope.listQuestion[$scope.count].ISCHECK=!0,$scope.listQuestion[$scope.count].ZINPUTANSWER1=ipAnswer1.value,$scope.listQuestion[$scope.count].ZINPUTANSWER2=ipAnswer2.value):($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1,$scope.listQuestion[$scope.count].ZINPUTANSWER1="",$scope.listQuestion[$scope.count].ZINPUTANSWER2=""),ipAnswer1.blur()),ipAnswer2.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer2.blur()}},$scope.playVideo=function(){
playVideo()},$scope.hideVideo=function(){window.plugins.streamingMedia.stopAudio()},$scope.showQuestion=function(){alertCloseVideo($scope.MenuQuestionItem.messageDialog,$scope.MenuQuestionItem.yes,$scope.MenuQuestionItem.no)},$scope.renderHtml=function(htmlCode){return $sce.trustAsHtml(htmlCode)},$scope.$on("$destroy",function(){$interval.cancel(interval)}),$scope.open=function(event){switch(event){case 2:$state.go("question",{},{})}},$scope.check=function(item,tab){item.checkAnswer=!item.checkAnswer,tab.ZANSWER[0].checkAnswer||tab.ZANSWER[1].checkAnswer||tab.ZANSWER[2].checkAnswer?tab.ISCHECK||($scope.count_ticked-=1,tab.ISCHECK=!0):($scope.count_ticked+=1,tab.ISCHECK=!1)},$rootScope.onBack=function(){if($scope.isTestEnd){$scope.selectedIndex=1;var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");flip1.classList.contains("flipRight")&&flip1.classList.remove("flipRight"),flip1.classList.contains("flipLeft")||flip1.classList.add("flipLeft"),flip2.classList.contains("flipRight")&&flip2.classList.remove("flipRight"),flip2.classList.contains("flipLeft")&&flip2.classList.remove("flipLeft"),flip3.classList.contains("flipLeft")&&flip3.classList.remove("flipLeft"),flip3.classList.contains("flipRight")||flip3.classList.add("flipRight"),$timeout(function(){$scope.modal.show()},100)}else alertBackTest($scope.MenuQuestionItem.backMessage,$scope.MenuQuestionItem.yes,$scope.MenuQuestionItem.no)},$scope.onBack_1=function(){$window.history.back()},$scope.openAnswered=function(item){$scope.isTestEnd=!0,$scope.selectedIndex=1;var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");$scope.questionCurrent=item,$scope.count=$scope.questionCurrent.number-1,initChangeLanguage(),$scope.count<1?($scope.questionItem1=$scope.listQuestion[$scope.sum-1],$scope.questionItem2=item,$scope.questionItem3=$scope.listQuestion[$scope.count+1]):$scope.count==$scope.sum-1?($scope.questionItem1=$scope.listQuestion[$scope.count-1],$scope.questionItem2=item,$scope.questionItem3=$scope.listQuestion[0]):($scope.questionItem1=$scope.listQuestion[$scope.count-1],$scope.questionItem2=item,$scope.questionItem3=$scope.listQuestion[$scope.count+1]),flip1.classList.contains("flipRight")&&flip1.classList.remove("flipRight"),flip1.classList.contains("flipLeft")||flip1.classList.add("flipLeft"),flip2.classList.contains("flipRight")&&flip2.classList.remove("flipRight"),flip2.classList.contains("flipLeft")&&flip2.classList.remove("flipLeft"),flip3.classList.contains("flipLeft")&&flip3.classList.remove("flipLeft"),flip3.classList.contains("flipRight")||flip3.classList.add("flipRight"),$timeout(function(){$scope.modal.hide()},300)},$ionicModal.fromTemplateUrl("results-modal.html",{scope:$scope,backdropClickToClose:!0,animation:"slide-in-up"}).then(function(modal){$scope.modal=modal}),$scope.openModal=function(){$scope.modal.show()},$scope.closeModal=function(){$scope.modal.hide()};var promise;$scope.onSetHard=function(item){null!=promise&&($timeout.cancel(promise),$scope.isShowBar=!1),db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?$scope.questionCurrent.ISHARD?db.updateQuestionUnHard($scope.questionCurrent.ZID).then(function(){$scope.hardText=$scope.MenuQuestionItem.statusUnHard,$scope.isShowBar=!0,promise=$timeout(function(){$scope.listQuestion[$scope.count].ISHARD=!1,item.ISHARD=!1,$scope.questionCurrent=$scope.listQuestion[$scope.count],$scope.isShowBar=!1},3e3)}):db.updateQuestionHard($scope.questionCurrent.ZID).then(function(){$scope.listQuestion[$scope.count].ISHARD=!0,item.ISHARD=!0,$scope.questionCurrent=$scope.listQuestion[$scope.count],$scope.hardText=$scope.MenuQuestionItem.statusHard,$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addQuestionHard($scope.questionCurrent.ZID).then(function(){$scope.listQuestion[$scope.count].ISHARD=!0,item.ISHARD=!0,$scope.questionCurrent=$scope.listQuestion[$scope.count],$scope.hardText=$scope.MenuQuestionItem.statusHard,$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),$rootScope.audio&&$rootScope.$broadcast("playaudio","hard")};var isTypeInput=!0;$scope.onNextItem=function(){if($scope.questionCurrent.ZISINPUT){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer){var valueInput=element.getElementsByClassName("ipAnswer")[0].value;valueInput.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer.blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$sce.trustAsHtml(utils.convertText($scope.listQuestion[$scope.count].textip1+valueInput+$scope.listQuestion[$scope.count].textip1_1)),$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput,valueInput.length>0&&!$scope.listQuestion[$scope.count].ISCHECK?$scope.listQuestion[$scope.count].ISCHECK=!0:0==valueInput.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.listQuestion[$scope.count].ISCHECK=!1))}else if(null!=ipAnswer1){var valueInput1=element.getElementsByClassName("ipAnswer1")[0].value,valueInput2=element.getElementsByClassName("ipAnswer2")[0].value;valueInput1.match(/[a-z]/i)||valueInput2.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer1.blur(),element.getElementsByClassName("ipAnswer2")[0].blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$sce.trustAsHtml(utils.convertText($scope.listQuestion[$scope.count].textip1+valueInput1+$scope.listQuestion[$scope.count].textip1_1+valueInput2+$scope.listQuestion[$scope.count].textip1_2)),$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput1,$scope.listQuestion[$scope.count].ZINPUTANSWER2=valueInput2,(valueInput1.length>0||valueInput2.length>0)&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput1.length&&0==valueInput2.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}}if(isTypeInput){$scope.count==$scope.sum-1?$scope.count=0:$scope.count+=1,initChangeLanguage(),$scope.listQuestion[$scope.count].ZISVIDEO&&($scope.listQuestion[$scope.count].ZVARIANT=!0),$scope.questionCurrent=$scope.listQuestion[$scope.count];var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3"),prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[next],flip1.classList.add("flipLeft"),flip2.classList.remove("flipRight"),flip3.classList.remove("flipLeft"),flip3.classList.add("flipRight");break;case 1:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],flip2.classList.add("flipLeft"),flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip3.classList.remove("flipRight");break;case 2:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip3.classList.add("flipLeft"),flip1.classList.remove("flipRight"),flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight")}$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}},$scope.rotateLeft=function(){if($scope.questionCurrent.ZISINPUT){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer){var valueInput=element.getElementsByClassName("ipAnswer")[0].value;valueInput.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer.blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$scope.listQuestion[$scope.count].textip1+valueInput+$scope.listQuestion[$scope.count].textip1_1,$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput,valueInput.length>0&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}else if(null!=ipAnswer1){var valueInput1=element.getElementsByClassName("ipAnswer1")[0].value,valueInput2=element.getElementsByClassName("ipAnswer2")[0].value;valueInput1.match(/[a-z]/i)||valueInput2.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer1.blur(),element.getElementsByClassName("ipAnswer2")[0].blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$scope.listQuestion[$scope.count].textip1+valueInput1+$scope.listQuestion[$scope.count].textip1_1+valueInput2+$scope.listQuestion[$scope.count].textip1_2,$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput1,$scope.listQuestion[$scope.count].ZINPUTANSWER2=valueInput2,(valueInput1.length>0||valueInput2.length>0)&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput1.length&&0==valueInput2.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}}if(isTypeInput){$scope.count==$scope.sum-1?$scope.count=0:$scope.count+=1,initChangeLanguage(),$scope.listQuestion[$scope.count].ZISVIDEO&&($scope.listQuestion[$scope.count].ZVARIANT=!0),$scope.questionCurrent=$scope.listQuestion[$scope.count];var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3"),prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[next],flip1.classList.add("flipLeft"),flip2.classList.remove("flipRight"),flip3.classList.remove("flipLeft"),flip3.classList.add("flipRight");break;case 1:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],flip2.classList.add("flipLeft"),flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip3.classList.remove("flipRight");break;case 2:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip3.classList.add("flipLeft"),flip1.classList.remove("flipRight"),flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight")}$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}},$scope.rotateRight=function(){if($scope.questionCurrent.ZISINPUT){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer){var valueInput=element.getElementsByClassName("ipAnswer")[0].value;valueInput.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer.blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$sce.trustAsHtml(utils.convertText($scope.listQuestion[$scope.count].textip1+valueInput+$scope.listQuestion[$scope.count].textip1_1)),$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput,valueInput.length>0&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}else if(null!=ipAnswer1){var valueInput1=element.getElementsByClassName("ipAnswer1")[0].value,valueInput2=element.getElementsByClassName("ipAnswer2")[0].value;valueInput1.match(/[a-z]/i)||valueInput2.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer1.blur(),element.getElementsByClassName("ipAnswer2")[0].blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$sce.trustAsHtml(utils.convertText($scope.listQuestion[$scope.count].textip1+valueInput1+$scope.listQuestion[$scope.count].textip1_1+valueInput2+$scope.listQuestion[$scope.count].textip1_2)),$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput1,$scope.listQuestion[$scope.count].ZINPUTANSWER2=valueInput2,(valueInput1.length>0||valueInput2.length>0)&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput1.length&&0==valueInput2.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}}if(isTypeInput){$scope.count>0?$scope.count-=1:$scope.count=$scope.sum-1,initChangeLanguage(),$scope.listQuestion[$scope.count].ZISVIDEO&&($scope.listQuestion[$scope.count].ZVARIANT=!0),$scope.questionCurrent=$scope.listQuestion[$scope.count];var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3"),prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;switch($scope.selectedIndex){case 0:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],flip1.classList.add("flipRight"),flip2.classList.remove("flipRight"),flip2.classList.add("flipLeft"),flip3.classList.remove("flipLeft");break;case 1:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip2.classList.add("flipRight"),flip1.classList.remove("flipLeft"),flip3.classList.remove("flipRight"),flip3.classList.add("flipLeft");break;case 2:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[next],flip3.classList.add("flipRight"),flip1.classList.remove("flipRight"),flip1.classList.add("flipLeft"),flip2.classList.remove("flipLeft")}$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}};var isNext=!1;$scope.openQuestion=function(item){if($scope.questionCurrent.ZISINPUT){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer){var valueInput=element.getElementsByClassName("ipAnswer")[0].value;valueInput.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer.blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$scope.listQuestion[$scope.count].textip1+valueInput+$scope.listQuestion[$scope.count].textip1_1,$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput,valueInput.length>0&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}else if(null!=ipAnswer1){var valueInput1=element.getElementsByClassName("ipAnswer1")[0].value,valueInput2=element.getElementsByClassName("ipAnswer2")[0].value;valueInput1.match(/[a-z]/i)||valueInput2.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer1.blur(),element.getElementsByClassName("ipAnswer2")[0].blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$scope.listQuestion[$scope.count].textip1+valueInput1+$scope.listQuestion[$scope.count].textip1_1+valueInput2+$scope.listQuestion[$scope.count].textip1_2,$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput1,$scope.listQuestion[$scope.count].ZINPUTANSWER2=valueInput2,(valueInput1.length>0||valueInput2.length>0)&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput1.length&&0==valueInput2.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}}if(isTypeInput){isNext=$scope.count<item-1,$scope.count=item-1,$scope.listQuestion[$scope.count].ZISVIDEO&&($scope.listQuestion[$scope.count].ZVARIANT=!0),$scope.questionCurrent=$scope.listQuestion[$scope.count];var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3"),prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;if(isNext)switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem2=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[next],flip1.classList.add("flipLeft"),flip2.classList.remove("flipRight"),flip3.classList.remove("flipLeft"),flip3.classList.add("flipRight");break;case 1:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[$scope.count],$scope.questionItem2=$scope.listQuestion[prev],flip2.classList.add("flipLeft"),flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip3.classList.remove("flipRight");break;case 2:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem1=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[prev],flip3.classList.add("flipLeft"),flip1.classList.remove("flipRight"),flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight")}else switch($scope.selectedIndex){case 0:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[$scope.count],$scope.questionItem2=$scope.listQuestion[prev],flip1.classList.add("flipRight"),flip2.classList.remove("flipRight"),flip2.classList.add("flipLeft"),flip3.classList.remove("flipLeft");break;case 1:$scope.selectedIndex=0,$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem1=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[prev],flip2.classList.add("flipRight"),flip1.classList.remove("flipLeft"),flip3.classList.remove("flipRight"),flip3.classList.add("flipLeft");break;case 2:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem2=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[next],flip3.classList.add("flipRight"),flip1.classList.remove("flipRight"),flip1.classList.add("flipLeft"),flip2.classList.remove("flipLeft")}initChangeLanguage(),$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}},$scope.showQuestionGrun=function(){if($scope.questionCurrent.ZISINPUT){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer){var valueInput=element.getElementsByClassName("ipAnswer")[0].value;valueInput.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer.blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$scope.listQuestion[$scope.count].textip1+valueInput+$scope.listQuestion[$scope.count].textip1_1,$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput,valueInput.length>0&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}else if(null!=ipAnswer1){var valueInput1=element.getElementsByClassName("ipAnswer1")[0].value,valueInput2=element.getElementsByClassName("ipAnswer2")[0].value;valueInput1.match(/[a-z]/i)||valueInput2.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer1.blur(),element.getElementsByClassName("ipAnswer2")[0].blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$scope.listQuestion[$scope.count].textip1+valueInput1+$scope.listQuestion[$scope.count].textip1_1+valueInput2+$scope.listQuestion[$scope.count].textip1_2,$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput1,$scope.listQuestion[$scope.count].ZINPUTANSWER2=valueInput2,(valueInput1.length>0||valueInput2.length>0)&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput1.length&&0==valueInput2.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}}if(isTypeInput){$scope.count=0,$scope.listQuestion[$scope.count].ZISVIDEO&&($scope.listQuestion[$scope.count].ZVARIANT=!0),$scope.questionCurrent=$scope.listQuestion[$scope.count],document.getElementById("dv_menu_q1").style.display="block",document.getElementById("dv_menu_q2").style.display="none",document.getElementById("ip_type_b").style.backgroundColor="#636363",document.getElementById("ip_grun").style.backgroundColor="#00827a";var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3"),prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;switch($scope.selectedIndex){case 0:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[$scope.count],flip1.classList.add("flipRight"),flip2.classList.remove("flipRight"),flip2.classList.add("flipLeft"),flip3.classList.remove("flipLeft");break;case 1:$scope.selectedIndex=0,$scope.questionItem1=$scope.listQuestion[$scope.count],$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip2.classList.add("flipRight"),flip1.classList.remove("flipLeft"),flip3.classList.remove("flipRight"),flip3.classList.add("flipLeft");break;case 2:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem2=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[next],flip3.classList.add("flipRight"),flip1.classList.remove("flipRight"),flip1.classList.add("flipLeft"),flip2.classList.remove("flipLeft")}initChangeLanguage(),$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}},$scope.showQuestionB=function(){if($scope.questionCurrent.ZISINPUT){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer){var valueInput=element.getElementsByClassName("ipAnswer")[0].value;valueInput.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer.blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$scope.listQuestion[$scope.count].textip1+valueInput+$scope.listQuestion[$scope.count].textip1_1,$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput,valueInput.length>0&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}else if(null!=ipAnswer1){var valueInput1=element.getElementsByClassName("ipAnswer1")[0].value,valueInput2=element.getElementsByClassName("ipAnswer2")[0].value;valueInput1.match(/[a-z]/i)||valueInput2.match(/[a-z]/i)?(isTypeInput=!1,navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"])):(ipAnswer1.blur(),element.getElementsByClassName("ipAnswer2")[0].blur(),isTypeInput=!0,$scope.listQuestion[$scope.count].ANSWERINPUTSTRING1=$scope.listQuestion[$scope.count].textip1+valueInput1+$scope.listQuestion[$scope.count].textip1_1+valueInput2+$scope.listQuestion[$scope.count].textip1_2,$scope.listQuestion[$scope.count].ZINPUTANSWER1=valueInput1,$scope.listQuestion[$scope.count].ZINPUTANSWER2=valueInput2,(valueInput1.length>0||valueInput2.length>0)&&!$scope.listQuestion[$scope.count].ISCHECK?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0):0==valueInput1.length&&0==valueInput2.length&&$scope.listQuestion[$scope.count].ISCHECK&&($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1))}}if(isTypeInput){$scope.count=20,$scope.listQuestion[$scope.count].ZISVIDEO&&($scope.listQuestion[$scope.count].ZVARIANT=!0),$scope.questionCurrent=$scope.listQuestion[$scope.count],document.getElementById("dv_menu_q1").style.display="none",document.getElementById("dv_menu_q2").style.display="block",document.getElementById("ip_grun").style.backgroundColor="#636363",document.getElementById("ip_grun").style.borderBottomWidth="1",document.getElementById("ip_type_b").style.backgroundColor="#00827a",document.getElementById("ip_type_b").style.borderBottomWidth="0";var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3"),prev=$scope.count-1>=0?$scope.count-1:$scope.sum-1,next=$scope.count+1<=$scope.sum-1?$scope.count+1:0;switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,$scope.questionItem1=$scope.listQuestion[prev],$scope.questionItem2=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[next],flip1.classList.add("flipLeft"),flip2.classList.remove("flipRight"),flip3.classList.remove("flipLeft"),flip3.classList.add("flipRight");break;case 1:$scope.selectedIndex=2,$scope.questionItem1=$scope.listQuestion[next],$scope.questionItem2=$scope.listQuestion[prev],$scope.questionItem3=$scope.listQuestion[$scope.count],flip2.classList.add("flipLeft"),flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip3.classList.remove("flipRight");break;case 2:$scope.selectedIndex=0,$scope.questionItem1=$scope.listQuestion[$scope.count],$scope.questionItem2=$scope.listQuestion[next],$scope.questionItem3=$scope.listQuestion[prev],flip3.classList.add("flipLeft"),flip1.classList.remove("flipRight"),flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight")}initChangeLanguage(),$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}};$scope.showMenuQuestion=function(){document.getElementById("menu_question").style.display="block"},$ionicModal.fromTemplateUrl("full-image-modal.html",{scope:$scope,animation:"none"}).then(function(modal){$scope.imageModal=modal}),$scope.hideMenuQuestion=function(){document.getElementById("menu_question").style.display="none"},$scope.fullImage=function(){$scope.questionCurrent.ZISVIDEO?playVideo():$scope.imageModal.show()},$scope.hide=function(){$scope.imageModal.hide()},$scope.countRight=0,$scope.result=0,$scope.isBestanden=!1,$scope.testBack=function(){$scope.pointsError=0,$scope.pointsBasicError=0,$scope.pointsAdvancedError=0;for(var i=0;i<$scope.listQuestion.length;i++){if($scope.listQuestion[i].ISCHECK=!1,$scope.listQuestion[i].ZANSWER[0].checkAnswer=!1,$scope.listQuestion[i].ZANSWER[1].checkAnswer=!1,$scope.listQuestion[i].ZANSWER[2].checkAnswer=!1,$scope.listQuestion[i].ZANSWER[0].isRight=!1,$scope.listQuestion[i].ZANSWER[1].isRight=!1,$scope.listQuestion[i].ZANSWER[2].isRight=!1,$scope.listQuestion[i].ISANSWERED=!1,$scope.pointsError+=$scope.listQuestion[i].ZPOINTS,$scope.listQuestion[i].ZISINPUT){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];null==ipAnswer1&&null!=ipAnswer?($scope.listQuestion[i].ANSWERINPUTSTRING1=$scope.listQuestion[i].textip1+$scope.listQuestion[i].textip1_1,$scope.listQuestion[i].ANSWERINPUTSTRING1VN=$scope.listQuestion[i].textip1VN+$scope.listQuestion[i].textip1_1VN,$scope.listQuestion[i].ZINPUTANSWER1=null):null!=ipAnswer1&&($scope.listQuestion[i].ANSWERINPUTSTRING1=$scope.listQuestion[i].textip1+$scope.listQuestion[i].textip1_1+$scope.listQuestion[i].textip1_2,$scope.listQuestion[i].ANSWERINPUTSTRING1VN=$scope.listQuestion[i].textip1VN+$scope.listQuestion[i].textip1_1VN+$scope.listQuestion[i].textip1_2VN,$scope.listQuestion[i].ZINPUTANSWER1=null,$scope.listQuestion[i].ZINPUTANSWER2=null)}if($scope.listQuestion[i].ZISVIDEO_DEFAULT&&($scope.listQuestion[i].ZISVIDEO=!0),$scope.listQuestion[i].ZICON=1==$scope.listQuestion[i].ZISVIDEO?"img/answer_wrong_vd.png":"img/answer_wrong.png",$scope.listQuestion[i].countPlayVideo=$scope.listQuestion[i].ZISVIDEO?5:0,$scope.listQuestion[i].ANSWERRIGHT=!1,20>i){loop1:for(var j=0;j<$scope.listBasic.length;j++)for(var k=0;k<$scope.listBasic[j].listItem.length;k++)if($scope.listBasic[j].listItem[k].ZID==$scope.listQuestion[i].ZID){$scope.listBasic[j].listItem[k]=$scope.listQuestion[i];break loop1}$scope.pointsBasicError+=$scope.listQuestion[i].ZPOINTS}else{loop1:for(var j=0;j<$scope.listAdvanced.length;j++)for(var k=0;k<$scope.listAdvanced[j].listItem.length;k++)if($scope.listAdvanced[j].listItem[k].ZID==$scope.listQuestion[i].ZID){$scope.listAdvanced[j].listItem[k]=$scope.listQuestion[i];break loop1}$scope.pointsAdvancedError+=$scope.listQuestion[i].ZPOINTS}}interval=null,startTimer(timer),document.getElementById("dvCountTicked").style.display="",$scope.count_ticked=$scope.listQuestion.length,$scope.count=0,$scope.countRight=0,$scope.isBestanden=!1,$scope.selectedIndex=1,$scope.isTestEnd=!1;var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");$scope.questionCurrent=$scope.listQuestion[$scope.count],initChangeLanguage(),$scope.questionItem1=$scope.listQuestion[$scope.sum-1],$scope.questionItem2=$scope.listQuestion[$scope.count],$scope.questionItem3=$scope.listQuestion[$scope.count+1],flip1.classList.contains("flipRight")&&flip1.classList.remove("flipRight"),flip1.classList.contains("flipLeft")||flip1.classList.add("flipLeft"),flip2.classList.contains("flipRight")&&flip2.classList.remove("flipRight"),flip2.classList.contains("flipLeft")&&flip2.classList.remove("flipLeft"),flip3.classList.contains("flipLeft")&&flip3.classList.remove("flipLeft"),flip3.classList.contains("flipRight")||flip3.classList.add("flipRight"),$timeout(function(){$scope.modal.hide();
},500)},$scope.onSubmit=function(){var element=null;0==$scope.selectedIndex?element=document.getElementById("flip1"):1==$scope.selectedIndex?element=document.getElementById("flip2"):2==$scope.selectedIndex&&(element=document.getElementById("flip3"));var ipAnswer1=element.getElementsByClassName("ipAnswer1")[0],ipAnswer=element.getElementsByClassName("ipAnswer")[0];if(null==ipAnswer1&&null!=ipAnswer)$scope.listQuestion[$scope.count].ZINPUTANSWER1!=ipAnswer.value?ipAnswer.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):(null!=ipAnswer.value?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0,$scope.listQuestion[$scope.count].ZINPUTANSWER1=ipAnswer.value):($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ZINPUTANSWER1="",$scope.listQuestion[$scope.count].ISCHECK=!1),ipAnswer.blur(),alertSubmit($scope.MenuQuestionItem.messageSubmit,$scope.MenuQuestionItem.yes,$scope.MenuQuestionItem.no)):alertSubmit($scope.MenuQuestionItem.messageSubmit,$scope.MenuQuestionItem.yes,$scope.MenuQuestionItem.no);else if(null!=ipAnswer1)if($scope.listQuestion[$scope.count].ZINPUTANSWER1==ipAnswer1.value){var ipAnswer2=element.getElementsByClassName("ipAnswer2")[0];ipAnswer1.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):ipAnswer1.blur(),ipAnswer2.value.match(/[a-z]/i)?navigator.notification.confirm("Bạn hãy nhập câu trả lời bằng số!",function(index){},"Chú ý",["Ok"]):(null!=ipAnswer1.value||null!=ipAnswer2.value?($scope.count_ticked-=1,$scope.listQuestion[$scope.count].ISCHECK=!0,$scope.listQuestion[$scope.count].ZINPUTANSWER1=ipAnswer1.value,$scope.listQuestion[$scope.count].ZINPUTANSWER2=ipAnswer2.value):($scope.count_ticked+=1,$scope.listQuestion[$scope.count].ISCHECK=!1,$scope.listQuestion[$scope.count].ZINPUTANSWER1="",$scope.listQuestion[$scope.count].ZINPUTANSWER2=""),ipAnswer2.blur(),alertSubmit($scope.MenuQuestionItem.messageSubmit,$scope.MenuQuestionItem.yes,$scope.MenuQuestionItem.no))}else alertSubmit($scope.MenuQuestionItem.messageSubmit,$scope.MenuQuestionItem.yes,$scope.MenuQuestionItem.no);else alertSubmit($scope.MenuQuestionItem.messageSubmit,$scope.MenuQuestionItem.yes,$scope.MenuQuestionItem.no)}})}(),function(){"use strict";angular.module("TrafficLaws.QuestionSearchController",["ui.router","TrafficLaws.databaseService"]).controller("QuestionSearchCtrl",function($scope,$rootScope,$q,$sce,$state,$window,db,$timeout,$http,$ionicModal){function init(){0==$rootScope.language?($scope.titlePlayVideo=$rootScope.Menu.vn.start_video,$scope.MenuQuestionItem.klass=$rootScope.Menu.vn.klass,$scope.MenuQuestionItem.codeQuestion=$rootScope.Menu.vn.code_question,$scope.MenuQuestionItem.point=$rootScope.Menu.vn.point,$scope.MenuQuestionItem.back=$rootScope.Menu.vn.cancel,$scope.MenuQuestionItem.previos=$rootScope.Menu.vn.previos_question,$scope.MenuQuestionItem.next=$rootScope.Menu.vn.next_question,$scope.MenuQuestionItem.viewResult=$rootScope.Menu.vn.view_result,$scope.MenuQuestionItem.filmStart=$rootScope.Menu.vn.button_start_video,$scope.MenuQuestionItem.viewQuestion=$rootScope.Menu.vn.view_question_video,$scope.MenuQuestionItem.titleCount1=$rootScope.Menu.vn.title_count_play1,$scope.MenuQuestionItem.titleCount2=$rootScope.Menu.vn.title_count_play2,$scope.MenuQuestionItem.yourAnswer=$rootScope.Menu.vn.your_answer,$scope.MenuQuestionItem.rightAnswer=$rootScope.Menu.vn.right_answer,$scope.MenuQuestionItem.statusRight=$rootScope.Menu.vn.status_answer_right,$scope.MenuQuestionItem.statusWrong=$rootScope.Menu.vn.status_answer_wrong,$scope.MenuQuestionItem.statusHard=$rootScope.Menu.vn.status_answer_hard,$scope.MenuQuestionItem.statusUnHard=$rootScope.Menu.vn.status_answer_un_hard,$scope.MenuQuestionItem.messageDialog=$rootScope.Menu.vn.show_question,$scope.MenuQuestionItem.yes=$rootScope.Menu.vn.yes,$scope.MenuQuestionItem.no=$rootScope.Menu.vn.no,$scope.MenuQuestionItem.hard=$rootScope.Menu.vn.hard):($scope.titlePlayVideo=$rootScope.Menu.de.start_video,$scope.MenuQuestionItem.klass=$rootScope.Menu.de.klass,$scope.MenuQuestionItem.codeQuestion=$rootScope.Menu.de.code_question,$scope.MenuQuestionItem.point=$rootScope.Menu.de.point,$scope.MenuQuestionItem.back=$rootScope.Menu.de.cancel,$scope.MenuQuestionItem.previos=$rootScope.Menu.de.previos_question,$scope.MenuQuestionItem.next=$rootScope.Menu.de.next_question,$scope.MenuQuestionItem.viewResult=$rootScope.Menu.de.view_result,$scope.MenuQuestionItem.filmStart=$rootScope.Menu.de.button_start_video,$scope.MenuQuestionItem.viewQuestion=$rootScope.Menu.de.view_question_video,$scope.MenuQuestionItem.titleCount1=$rootScope.Menu.de.title_count_play1,$scope.MenuQuestionItem.titleCount2=$rootScope.Menu.de.title_count_play2,$scope.MenuQuestionItem.yourAnswer=$rootScope.Menu.de.your_answer,$scope.MenuQuestionItem.rightAnswer=$rootScope.Menu.de.right_answer,$scope.MenuQuestionItem.statusRight=$rootScope.Menu.de.status_answer_right,$scope.MenuQuestionItem.statusWrong=$rootScope.Menu.de.status_answer_wrong,$scope.MenuQuestionItem.statusHard=$rootScope.Menu.de.status_answer_hard,$scope.MenuQuestionItem.statusUnHard=$rootScope.Menu.de.status_answer_un_hard,$scope.MenuQuestionItem.messageDialog=$rootScope.Menu.de.show_question,$scope.MenuQuestionItem.yes=$rootScope.Menu.de.yes,$scope.MenuQuestionItem.no=$rootScope.Menu.de.no,$scope.MenuQuestionItem.hard=$rootScope.Menu.de.hard)}function callbackGetId(data){if($scope.questionCurrent=new QuestionModel,$scope.questionItem1=new QuestionModel,$scope.questionItem2=new QuestionModel,$scope.questionItem3=new QuestionModel,$scope.questionCurrent.Z_PK=data.Z_PK,$scope.questionCurrent.Z_ENT=data.Z_ENT,$scope.questionCurrent.Z_OPT=data.Z_OPT,$scope.questionCurrent.ZID=data.ZID,$scope.questionCurrent.ZTESTIMAGE=data.ZTESTIMAGE,$scope.questionCurrent.ZUPDATE=data.ZUPDATE,$scope.questionCurrent.ZISHTML=data.ZISHTML,$scope.questionCurrent.ZISVIDEO=1==data.ZISVIDEO,$scope.questionCurrent.ZOLDID=data.ZOLDID,$scope.questionCurrent.ZTESTBIGIMAGE=data.ZTESTBIGIMAGE,$scope.questionCurrent.ZL=data.ZL,$scope.questionCurrent.ZPOINTS=data.ZPOINTS,$scope.questionCurrent.ZTHEMA=data.ZTHEMA,$scope.questionCurrent.ZQZG=data.ZQZG,$scope.questionCurrent.ZVALID1=data.ZVALID1,$scope.questionCurrent.ZVALID2=data.ZVALID2,$scope.questionCurrent.ZVALID3=data.ZVALID3,$scope.questionCurrent.ZISINPUT=1==data.ZISINPUT,$scope.questionCurrent.ISHARD=1==data.ZDIFFICULT,$scope.questionCurrent.ZISINPUT)if(0==$rootScope.language){var t1=data.ZANSWER1VN.indexOf("^"),answer1=data.ZANSWER1VN.substring(0,t1),answer2=data.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=utils.convertText(answer4.substring(0,answer4.indexOf(" "))),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.questionCurrent.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input id='ipAnswer1' type='number' value='' class='ipAnswer' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipAnswer2' value='' type='number' class='ipAnswer' />&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input id='ipValid1' type='text' class='ipAnswer' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipValid2' type='text' class='ipAnswer' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.questionCurrent.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input id='ipAnswer' value='' type='number' class='ipAnswer' />&nbsp<p> "+utils.convertText(text)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input id='ipValid' type='text' class='ipAnswer' value='"+valid+"'/>&nbsp<p> "+utils.convertText(text)+"</p>"}$scope.questionCurrent.ANSWERINPUTSTRING1TEMP=$scope.questionCurrent.ANSWERINPUTSTRING1VN,$scope.questionCurrent.ANSWERINPUTSTRING2TEMP=$scope.questionCurrent.ANSWERINPUTSTRING2VN}else{var t1=data.ZANSWER1.indexOf("^"),answer1=data.ZANSWER1.substring(0,t1),answer2=data.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=utils.convertText(answer4.substring(0,answer4.indexOf(" "))),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.questionCurrent.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input id='ipAnswer1' type='number' value='' class='ipAnswer' />&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipAnswer2' value='' type='number' class='ipAnswer' />&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input id='ipValid1' type='text' class='ipAnswer' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipValid2' type='text' class='ipAnswer' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.questionCurrent.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input id='ipAnswer' value='' type='number' class='ipAnswer' />&nbsp<p> "+utils.convertText(text)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input id='ipValid' type='text' class='ipAnswer' value='"+valid+"'/>&nbsp<p> "+utils.convertText(text)+"</p>"}$scope.questionCurrent.ANSWERINPUTSTRING1TEMP=$scope.questionCurrent.ANSWERINPUTSTRING1,$scope.questionCurrent.ANSWERINPUTSTRING2TEMP=$scope.questionCurrent.ANSWERINPUTSTRING2}null!=data.ZPRETEXT&&(data.ZPRETEXT=data.ZPRETEXT.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZPRETEXT=data.ZPRETEXT.replace(/(]\})/g,"</b>")),$scope.questionCurrent.ZPRETEXT=null!=data.ZPRETEXT?$sce.trustAsHtml(utils.convertText(data.ZPRETEXT)):null,$scope.questionCurrent.ZISPRETEXT=null!=data.ZPRETEXT,$scope.questionCurrent.ZIMAGE="img/"+data.ZIMAGE,$scope.questionCurrent.ZISIMAGE=null!=data.ZIMAGE,$scope.questionCurrent.ZWBMP=data.ZWBMP,null!=data.ZQUESTION&&(data.ZQUESTION=data.ZQUESTION.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZQUESTION=data.ZQUESTION.replace(/(]\})/g,"</b>")),$scope.questionCurrent.ZQUESTION=$sce.trustAsHtml(utils.convertText(data.ZQUESTION+"&nbsp"+(null!=data.ZKOMENTAR?data.ZKOMENTAR:""))),$scope.questionCurrent.ZQUESTIONIMAGE=data.ZQUESTIONIMAGE,$scope.questionCurrent.ZTIP=data.ZTIP,$scope.questionCurrent.ZKOMENTAR=data.ZKOMENTAR,$scope.questionCurrent.ZSETNAME=data.ZSETNAME,$scope.questionCurrent.ZNOTUSED=data.ZNOTUSED,$scope.questionCurrent.ZTYPE=data.ZTYPE,$scope.questionCurrent.ZFRAGENKATALOG=data.ZFRAGENKATALOG,$scope.questionCurrent.ZVARIANT=data.ZFRAGENKATALOG.indexOf("M")>0||data.ZFRAGENKATALOG.indexOf("B")>0,$scope.questionCurrent.ZBIGIMAGE="img/"+data.ZBIGIMAGE,$scope.questionCurrent.ZCOMMENTMOFFA=data.ZCOMMENTMOFFA,$scope.questionCurrent.ZCOMMENTZ=data.ZCOMMENTZ,$scope.questionCurrent.ZPRETEXTVN=null!=data.ZPRETEXTVN?$sce.trustAsHtml(data.ZPRETEXTVN):null,$scope.questionCurrent.ZQUESTIONVN=null!=data.ZQUESTIONVN?$sce.trustAsHtml(data.ZQUESTIONVN):null,null!=data.ZANSWER1&&(data.ZANSWER1=data.ZANSWER1.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1=data.ZANSWER1.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2&&(data.ZANSWER2=data.ZANSWER2.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2=data.ZANSWER2.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3&&(data.ZANSWER3=data.ZANSWER3.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3=data.ZANSWER3.replace(/(]\})/g,"</b>")),null!=data.ZANSWER1VN&&(data.ZANSWER1VN=data.ZANSWER1VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER1VN=data.ZANSWER1VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER2VN&&(data.ZANSWER2VN=data.ZANSWER2VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER2VN=data.ZANSWER2VN.replace(/(]\})/g,"</b>")),null!=data.ZANSWER3VN&&(data.ZANSWER3VN=data.ZANSWER3VN.replace(/({\[)/g,"<b style='color: #e50000;'>"),data.ZANSWER3VN=data.ZANSWER3VN.replace(/(]\})/g,"</b>")),$scope.questionCurrent.ZANSWER[0].vn.ZANSWER=null!=data.ZANSWER1VN?$sce.trustAsHtml(data.ZANSWER1VN):null,$scope.questionCurrent.ZANSWER[0].vn.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,$scope.questionCurrent.ZANSWER[0].de.ZANSWER=null!=data.ZANSWER1?$sce.trustAsHtml(utils.convertText(data.ZANSWER1)):null,$scope.questionCurrent.ZANSWER[0].de.ZANSWERIMAGE="img/"+data.ZANSWER1IMAGE,$scope.questionCurrent.ZANSWER[0].isImage=null!=data.ZANSWER1IMAGE,$scope.questionCurrent.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[1].vn.ZANSWER=null!=data.ZANSWER2VN?$sce.trustAsHtml(data.ZANSWER2VN):null,$scope.questionCurrent.ZANSWER[1].vn.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,$scope.questionCurrent.ZANSWER[1].de.ZANSWER=null!=data.ZANSWER2?$sce.trustAsHtml(utils.convertText(data.ZANSWER2)):null,$scope.questionCurrent.ZANSWER[1].de.ZANSWERIMAGE="img/"+data.ZANSWER2IMAGE,$scope.questionCurrent.ZANSWER[1].isImage=null!=data.ZANSWER2IMAGE,$scope.questionCurrent.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[2].vn.ZANSWER=null!=data.ZANSWER3VN?$sce.trustAsHtml(data.ZANSWER3VN):null,$scope.questionCurrent.ZANSWER[2].vn.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,$scope.questionCurrent.ZANSWER[2].de.ZANSWER=null!=data.ZANSWER3?$sce.trustAsHtml(utils.convertText(data.ZANSWER3)):null,$scope.questionCurrent.ZANSWER[2].de.ZANSWERIMAGE="img/"+data.ZANSWER3IMAGE,$scope.questionCurrent.ZANSWER[2].isImage=null!=data.ZANSWER3IMAGE,$scope.questionCurrent.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[0].isAnswer=null!=data.ZANSWER1,$scope.questionCurrent.ZANSWER[1].isAnswer=null!=data.ZANSWER2,$scope.questionCurrent.ZANSWER[2].isAnswer=null!=data.ZANSWER3,$scope.questionCurrent.ZANSWER[0].checkAnswer=!1,$scope.questionCurrent.ZANSWER[1].checkAnswer=!1,$scope.questionCurrent.ZANSWER[2].checkAnswer=!1,$scope.questionCurrent.ZISVIDEO&&(setSourceVideo($scope.questionCurrent.ZFRAGENKATALOG),$scope.questionCurrent.ZVARIANT=!0),$scope.questionItem2=$scope.questionCurrent,initChangeLanguage()}function initChangeLanguage(){0==$rootScope.language?($scope.questionCurrent.ZQUESTIONTEMP=$scope.questionCurrent.ZQUESTIONVN,$scope.questionCurrent.ZANSWER[0].ZANSWER=$scope.questionCurrent.ZANSWER[0].vn.ZANSWER,$scope.questionCurrent.ZANSWER[1].ZANSWER=$scope.questionCurrent.ZANSWER[1].vn.ZANSWER,$scope.questionCurrent.ZANSWER[2].ZANSWER=$scope.questionCurrent.ZANSWER[2].vn.ZANSWER,$scope.questionItem1.ZQUESTIONTEMP=$scope.questionItem1.ZQUESTIONVN,$scope.questionItem1.ZANSWER[0].ZANSWER=$scope.questionItem1.ZANSWER[0].vn.ZANSWER,$scope.questionItem1.ZANSWER[1].ZANSWER=$scope.questionItem1.ZANSWER[1].vn.ZANSWER,$scope.questionItem1.ZANSWER[2].ZANSWER=$scope.questionItem1.ZANSWER[2].vn.ZANSWER,$scope.questionItem2.ZQUESTIONTEMP=$scope.questionItem2.ZQUESTIONVN,$scope.questionItem2.ZANSWER[0].ZANSWER=$scope.questionItem2.ZANSWER[0].vn.ZANSWER,$scope.questionItem2.ZANSWER[1].ZANSWER=$scope.questionItem2.ZANSWER[1].vn.ZANSWER,$scope.questionItem2.ZANSWER[2].ZANSWER=$scope.questionItem2.ZANSWER[2].vn.ZANSWER,$scope.questionItem3.ZQUESTIONTEMP=$scope.questionItem3.ZQUESTIONVN,$scope.questionItem3.ZANSWER[0].ZANSWER=$scope.questionItem3.ZANSWER[0].vn.ZANSWER,$scope.questionItem3.ZANSWER[1].ZANSWER=$scope.questionItem3.ZANSWER[1].vn.ZANSWER,$scope.questionItem3.ZANSWER[2].ZANSWER=$scope.questionItem3.ZANSWER[2].vn.ZANSWER,$scope.questionItem1.ZPRETEXTTEMP=$scope.questionItem1.ZPRETEXTVN,$scope.questionItem2.ZPRETEXTTEMP=$scope.questionItem2.ZPRETEXTVN,$scope.questionItem3.ZPRETEXTTEMP=$scope.questionItem3.ZPRETEXTVN,$scope.questionCurrent.ZISVIDEO&&($scope.countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"&nbsp;<b style='color: #e50000;'>"+$scope.countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>")),$scope.questionCurrent.ANSWERINPUTSTRING1TEMP=$scope.questionCurrent.ANSWERINPUTSTRING1VN,$scope.questionCurrent.ANSWERINPUTSTRING2TEMP=$scope.questionCurrent.ANSWERINPUTSTRING2VN):($scope.questionCurrent.ZQUESTIONTEMP=$scope.questionCurrent.ZQUESTION,$scope.questionCurrent.ZANSWER[0].ZANSWER=$scope.questionCurrent.ZANSWER[0].de.ZANSWER,$scope.questionCurrent.ZANSWER[1].ZANSWER=$scope.questionCurrent.ZANSWER[1].de.ZANSWER,$scope.questionCurrent.ZANSWER[2].ZANSWER=$scope.questionCurrent.ZANSWER[2].de.ZANSWER,$scope.questionItem1.ZQUESTIONTEMP=$scope.questionItem1.ZQUESTION,$scope.questionItem1.ZANSWER[0].ZANSWER=$scope.questionItem1.ZANSWER[0].de.ZANSWER,$scope.questionItem1.ZANSWER[1].ZANSWER=$scope.questionItem1.ZANSWER[1].de.ZANSWER,$scope.questionItem1.ZANSWER[2].ZANSWER=$scope.questionItem1.ZANSWER[2].de.ZANSWER,$scope.questionItem2.ZQUESTIONTEMP=$scope.questionItem2.ZQUESTION,$scope.questionItem2.ZANSWER[0].ZANSWER=$scope.questionItem2.ZANSWER[0].de.ZANSWER,$scope.questionItem2.ZANSWER[1].ZANSWER=$scope.questionItem2.ZANSWER[1].de.ZANSWER,$scope.questionItem2.ZANSWER[2].ZANSWER=$scope.questionItem2.ZANSWER[2].de.ZANSWER,$scope.questionItem3.ZQUESTIONTEMP=$scope.questionItem3.ZQUESTION,$scope.questionItem3.ZANSWER[0].ZANSWER=$scope.questionItem3.ZANSWER[0].de.ZANSWER,$scope.questionItem3.ZANSWER[1].ZANSWER=$scope.questionItem3.ZANSWER[1].de.ZANSWER,$scope.questionItem3.ZANSWER[2].ZANSWER=$scope.questionItem3.ZANSWER[2].de.ZANSWER,$scope.questionItem1.ZPRETEXTTEMP=$scope.questionItem1.ZPRETEXT,$scope.questionItem2.ZPRETEXTTEMP=$scope.questionItem2.ZPRETEXT,$scope.questionItem3.ZPRETEXTTEMP=$scope.questionItem3.ZPRETEXT,$scope.questionCurrent.ZISVIDEO&&($scope.countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"<br /><b style='color: #e50000;'>"+$scope.countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>")),$scope.questionCurrent.ANSWERINPUTSTRING1TEMP=$scope.questionCurrent.ANSWERINPUTSTRING1,$scope.questionCurrent.ANSWERINPUTSTRING2TEMP=$scope.questionCurrent.ANSWERINPUTSTRING2)}function endedVideo(e){0==$scope.listQuestion[$scope.count].countPlayVideo&&($scope.listQuestion[$scope.count].questionCurrent.ZISVIDEO=!1,$scope.listQuestion[$scope.count].countPlayVideo=5)}function playVideo(){var filename=$scope.questionCurrent.ZFRAGENKATALOG.split(".").join("_"),videoPath=$rootScope.assetsPath+"videos/iOS/WVGA/"+filename.replace(/-/g,"_")+".mp4",options={successCallback:function(){window.plugins.streamingMedia.stop(),console.log("Player closed without error."),endedVideo()},errorCallback:function(errMsg){console.log("Error! "+errMsg)}};window.plugins.streamingMedia.playVideo(videoPath,options),$scope.countPlayVideo-=1,$scope.questionCurrent.ZIMAGE=$scope.questionCurrent.ZBIGIMAGE,0==$scope.countPlayVideo&&($scope.questionCurrent.ZISVIDEO=!1,$scope.countPlayVideo=5),0==$rootScope.language?$scope.countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"&nbsp;<b style='color: #e50000;'>"+$scope.countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>"):$scope.countPlayVideoText=$sce.trustAsHtml("<p id='pSie'>"+$scope.MenuQuestionItem.titleCount1+"<br /><b style='color: #e50000;'>"+$scope.countPlayVideo+"</b>&nbsp;"+$scope.MenuQuestionItem.titleCount2+"</p>")}function alertCloseVideo(message,yes,no){navigator.notification.confirm(message,onConfirm,"",[yes,no])}function onConfirm(buttonIndex){2!=buttonIndex&&($scope.questionCurrent.ZISVIDEO=!1,$scope.countPlayVideo=5,$scope.$$phase?$timeout(function(){$scope.$apply()},500):$scope.$apply())}function checkValid(){if(null!=promise&&($timeout.cancel(promise),$scope.isShowBar=!1),$scope.questionCurrent.ISANSWERED=!0,$scope.questionCurrent.ZISINPUT)if(null==document.getElementById("ipAnswer1")){var yourAnswer=document.getElementById("ipAnswer").value,rightAnswer=document.getElementById("ipValid").value;$scope.questionCurrent.ZINPUTANSWER1=yourAnswer,yourAnswer==rightAnswer?($scope.questionCurrent.ANSWERRIGHT=!0,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),document.getElementById("ipAnswer").style.backgroundColor="#3db707",resetInput(),$rootScope.audio&&$rootScope.$broadcast("playaudio","right")):($scope.questionCurrent.ANSWERRIGHT=!1,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),document.getElementById("ipAnswer").style.backgroundColor="#cd2630",resetInput(),$rootScope.audio&&$rootScope.$broadcast("playaudio","error"))}else{var yourAnswer=document.getElementById("ipAnswer").value,yourAnswer1=document.getElementById("ipAnswer1").value,rightAnswer=document.getElementById("ipValid").value,rightAnswer1=document.getElementById("ipValid1").value;$scope.questionCurrent.ZINPUTANSWER1=yourAnswer,$scope.questionCurrent.ZINPUTANSWER2=yourAnswer1,yourAnswer==rightAnswer&&yourAnswer1==rightAnswer1?($scope.questionCurrent.ANSWERRIGHT=!0,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),document.getElementById("ipAnswer").style.backgroundColor="#3db707",document.getElementById("ipAnswer1").style.backgroundColor="#3db707",resetInput(),$rootScope.audio&&$rootScope.$broadcast("playaudio","right")):($scope.questionCurrent.ANSWERRIGHT=!1,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),document.getElementById("ipAnswer").style.backgroundColor="#cd2630",document.getElementById("ipAnswer1").style.backgroundColor="#cd2630",resetInput(),$rootScope.audio&&$rootScope.$broadcast("playaudio","error"))}else $scope.questionCurrent.ZANSWER[0].checkAnswer?1==$scope.questionCurrent.ZVALID1?($scope.questionCurrent.ZANSWER[0].isValid="img/answer_right.png",$scope.questionCurrent.ZANSWER[0].isRight=!0):($scope.questionCurrent.ZANSWER[0].isValid="img/answer_wrong1.png",$scope.questionCurrent.ZANSWER[0].isRight=!1):1==$scope.questionCurrent.ZVALID1?($scope.questionCurrent.ZANSWER[0].isValid="img/answer_right1.png",$scope.questionCurrent.ZANSWER[0].isRight=!1):($scope.questionCurrent.ZANSWER[0].isValid="img/answer_wrong.png",$scope.questionCurrent.ZANSWER[0].isRight=!0),$scope.questionCurrent.ZANSWER[1].checkAnswer?1==$scope.questionCurrent.ZVALID2?($scope.questionCurrent.ZANSWER[1].isValid="img/answer_right.png",$scope.questionCurrent.ZANSWER[1].isRight=!0):($scope.questionCurrent.ZANSWER[1].isValid="img/answer_wrong1.png",$scope.questionCurrent.ZANSWER[1].isRight=!1):1==$scope.questionCurrent.ZVALID2?($scope.questionCurrent.ZANSWER[1].isValid="img/answer_right1.png",$scope.questionCurrent.ZANSWER[1].isRight=!1):($scope.questionCurrent.ZANSWER[1].isValid="img/answer_wrong.png",$scope.questionCurrent.ZANSWER[1].isRight=!0),$scope.questionCurrent.ZANSWER[2].checkAnswer?1==$scope.questionCurrent.ZVALID3?($scope.questionCurrent.ZANSWER[2].isValid="img/answer_right.png",$scope.questionCurrent.ZANSWER[2].isRight=!0):($scope.questionCurrent.ZANSWER[2].isValid="img/answer_wrong1.png",$scope.questionCurrent.ZANSWER[2].isRight=!1):1==$scope.questionCurrent.ZVALID3?($scope.questionCurrent.ZANSWER[2].isValid="img/answer_right1.png",$scope.questionCurrent.ZANSWER[2].isRight=!1):($scope.questionCurrent.ZANSWER[2].isValid="img/answer_wrong.png",$scope.questionCurrent.ZANSWER[2].isRight=!0),$scope.questionCurrent.ZANSWER[0].isRight&&$scope.questionCurrent.ZANSWER[1].isRight&&$scope.questionCurrent.ZANSWER[2].isRight?($scope.questionCurrent.ANSWERRIGHT=!0,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerRight($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),$rootScope.audio&&$rootScope.$broadcast("playaudio","right")):($scope.questionCurrent.ANSWERRIGHT=!1,db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?db.updateAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addAnswerWrong($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),2==$rootScope.questionChild&&$rootScope.$broadcast("reloadTheme"),$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),$rootScope.audio&&$rootScope.$broadcast("playaudio","error"))}function resetInput(){if($scope.questionCurrent.ANSWERRIGHT){var t1=$scope.questionCurrent.ZANSWER1VN.indexOf("^"),answer1=$scope.questionCurrent.ZANSWER1VN.substring(0,t1),answer2=$scope.questionCurrent.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.questionCurrent.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input id='ipAnswer1' type='number' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' style='background-color:#3db707' roadonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipAnswer2' value='"+$scope.questionCurrent.ZINPUTANSWER2+"' type='number' style='background-color:#3db707' roadonly/>&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input id='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.questionCurrent.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' type='number' style='background-color:#3db707' roadonly/>&nbsp<p> "+utils.convertText(text)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}var t1=$scope.questionCurrent.ZANSWER1.indexOf("^"),answer1=$scope.questionCurrent.ZANSWER1.substring(0,t1),answer2=$scope.questionCurrent.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.questionCurrent.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input id='ipAnswer1' type='number' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' style='background-color:#3db707' roadonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipAnswer2' value='"+$scope.questionCurrent.ZINPUTANSWER2+"' type='number' style='background-color:#3db707' roadonly/>&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input id='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.questionCurrent.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' type='number' style='background-color:#3db707' roadonly/>&nbsp<p> "+utils.convertText(text)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}else{var t1=$scope.questionCurrent.ZANSWER1VN.indexOf("^"),answer1=$scope.questionCurrent.ZANSWER1VN.substring(0,t1),answer2=$scope.questionCurrent.ZANSWER1VN.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.questionCurrent.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+"</p>&nbsp<input id='ipAnswer1' type='number' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' style='background-color:#cd2630' roadonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipAnswer2' value='"+$scope.questionCurrent.ZINPUTANSWER2+"' type='number' style='background-color:#cd2630' roadonly/>&nbsp<p>"+utils.convertText(text2)+"</p>",
$scope.questionCurrent.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input id='ipValid1' type='text' value='"+valid1+"' readonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipValid2' type='text' value='"+valid2+"' readonly/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.questionCurrent.ANSWERINPUTSTRING1VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' type='number' style='background-color:#cd2630' roadonly/>&nbsp<p> "+utils.convertText(text)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2VN="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}var t1=$scope.questionCurrent.ZANSWER1.indexOf("^"),answer1=$scope.questionCurrent.ZANSWER1.substring(0,t1),answer2=$scope.questionCurrent.ZANSWER1.substring(t1+1),t2=answer2.indexOf("^");if(t2>0){var answer3=answer2.substring(0,t2),answer4=answer2.substring(t2+1);if(answer3.length>1)var valid1=answer3.substring(0,answer3.indexOf(" ")),text1=answer3.substring(answer3.indexOf(" "));else var valid1=answer3,text1=answer3;if(answer4.length>1)var valid2=answer4.substring(0,answer4.indexOf(" ")),text2=answer4.substring(answer4.indexOf(" "));else var valid2=answer4,text2=answer4;$scope.questionCurrent.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+"</p>&nbsp<input id='ipAnswer1' type='number' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' style='background-color:#cd2630' roadonly/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipAnswer2' value='"+$scope.questionCurrent.ZINPUTANSWER2+"' type='number' style='background-color:#cd2630' roadonly/>&nbsp<p>"+utils.convertText(text2)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input id='ipValid1' type='text' value='"+valid1+"'/>&nbsp<p> "+utils.convertText(text1)+"</p>&nbsp<input id='ipValid2' type='text' value='"+valid2+"'/>&nbsp<p> "+utils.convertText(text2)+"</p>"}else{if(answer2.length>1)var valid=answer2.substring(0,answer2.indexOf(" ")),text=answer2.substring(answer2.indexOf(" "));else var valid=answer2,text="";$scope.questionCurrent.ANSWERINPUTSTRING1="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipAnswer' value='"+$scope.questionCurrent.ZINPUTANSWER1+"' type='number' style='background-color:#cd2630' roadonly/>&nbsp<p> "+utils.convertText(text)+"</p>",$scope.questionCurrent.ANSWERINPUTSTRING2="<p>"+utils.convertText(answer1)+" </p>&nbsp<input class='ipValid' type='text' value='"+valid+"' readonly/>&nbsp<p> "+utils.convertText(text)+"</p>"}}}$scope.count=0,$scope.sum=0,$scope.selectedIndex=1,$scope.nextQuestion=1,$scope.countPlayVideo=5,$scope.isShowBar=!1,$scope.hardText="",$scope.flipLeft=!1,$scope.flipRight=!1;$scope.listQuestion=[];var utils=new Utils($http);$scope.titlePlayVideo=$rootScope.Menu.vn.start_video,$scope.MenuQuestionItem={klass:null,codeQuestion:null,point:null,back:null,previos:null,next:null,viewResult:null,filmStart:null,viewQuestion:null,titleCount1:null,titleCount2:null,yourAnswer:null,rightAnswer:null,statusRight:null,statusWrong:null,statusHard:null,messageDialog:null,yes:null,no:null,statusUnHard:null},$scope.isLanguage=1!=$rootScope.language,$scope.languageText=$scope.isLanguage?"DE":"VN",$scope.questionCurrent=new QuestionModel,$scope.countPlayVideoText=null;var type,type,Id=$state.params.ZId;init(),type=$rootScope.questionRandom?"RANDOM()":"Z_PK ASC",$scope.listQuestion.push(Id),$scope.sum=$scope.listQuestion.length,db.selectQuestionById(Id).then(callbackGetId),$scope.changeLanguage=function(){$scope.isLanguage=!$scope.isLanguage,$scope.languageText=$scope.isLanguage?"DE":"VN",init(),initChangeLanguage(),$rootScope.audio&&$rootScope.$broadcast("playaudio","lang")},$scope.playVideo=function(){playVideo()},$scope.hideVideo=function(){window.plugins.streamingMedia.stopAudio()},$scope.showQuestion=function(){alertCloseVideo($scope.MenuQuestionItem.messageDialog,$scope.MenuQuestionItem.yes,$scope.MenuQuestionItem.no)},$scope.renderHtml=function(htmlCode){return $sce.trustAsHtml(htmlCode)},$scope.open=function(event){switch(event){case 2:$state.go("question",{},{})}},$scope.check=function(item){item.checkAnswer=!item.checkAnswer},$scope.rotateLeft=function(){var ipAnswer1=document.getElementById("ipAnswer1"),ipAnswer=document.getElementById("ipAnswer"),yourAnswer="";if(null==ipAnswer1&&null!=ipAnswer?yourAnswer=document.getElementById("ipAnswer").value:null!=ipAnswer1&&(yourAnswer=document.getElementById("ipAnswer1").value+document.getElementById("ipAnswer2").value),$scope.questionCurrent.ISANSWERED||$scope.questionCurrent.ZISINPUT&&""==yourAnswer||!$scope.questionCurrent.ZANSWER[0].checkAnswer&&!$scope.questionCurrent.ZANSWER[1].checkAnswer&&!$scope.questionCurrent.ZANSWER[2].checkAnswer&&!$scope.questionCurrent.ZISINPUT){$scope.questionCurrent.ZANSWER[0].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[1].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[2].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[0].checkAnswer=!1,$scope.questionCurrent.ZANSWER[1].checkAnswer=!1,$scope.questionCurrent.ZANSWER[2].checkAnswer=!1,$scope.questionCurrent.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ISANSWERED=!1;var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");$scope.count;if($scope.sum>1)switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,flip1.classList.add("flipLeft"),flip2.classList.remove("flipRight"),flip3.classList.remove("flipLeft"),flip3.classList.add("flipRight");break;case 1:$scope.selectedIndex=2,flip2.classList.add("flipLeft"),flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip3.classList.remove("flipRight");break;case 2:$scope.selectedIndex=0,flip3.classList.add("flipLeft"),flip1.classList.remove("flipRight"),flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight")}$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}else($scope.questionCurrent.ZISINPUT||$scope.questionCurrent.ZANSWER[0].checkAnswer||$scope.questionCurrent.ZANSWER[1].checkAnswer||$scope.questionCurrent.ZANSWER[2].checkAnswer)&&checkValid()},$scope.rotateRight=function(){var ipAnswer1=document.getElementById("ipAnswer1"),ipAnswer=document.getElementById("ipAnswer"),yourAnswer="";if(null==ipAnswer1&&null!=ipAnswer?yourAnswer=document.getElementById("ipAnswer").value:null!=ipAnswer1&&(yourAnswer=document.getElementById("ipAnswer1").value+document.getElementById("ipAnswer2").value),$scope.questionCurrent.ISANSWERED||$scope.questionCurrent.ZISINPUT&&""==yourAnswer||!$scope.questionCurrent.ZANSWER[0].checkAnswer&&!$scope.questionCurrent.ZANSWER[1].checkAnswer&&!$scope.questionCurrent.ZANSWER[2].checkAnswer&&!$scope.questionCurrent.ZISINPUT){$scope.questionCurrent.ZANSWER[0].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[1].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[2].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[0].checkAnswer=!1,$scope.questionCurrent.ZANSWER[1].checkAnswer=!1,$scope.questionCurrent.ZANSWER[2].checkAnswer=!1,$scope.questionCurrent.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ISANSWERED=!1;var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");$scope.count;if($scope.sum>1)switch($scope.selectedIndex){case 0:$scope.selectedIndex=2,flip1.classList.add("flipRight"),flip2.classList.remove("flipRight"),flip2.classList.add("flipLeft"),flip3.classList.remove("flipLeft");break;case 1:$scope.selectedIndex=0,flip2.classList.add("flipRight"),flip1.classList.remove("flipLeft"),flip3.classList.remove("flipRight"),flip3.classList.add("flipLeft");break;case 2:$scope.selectedIndex=1,flip3.classList.add("flipRight"),flip1.classList.remove("flipRight"),flip1.classList.add("flipLeft"),flip2.classList.remove("flipLeft")}$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}else($scope.questionCurrent.ZISINPUT||$scope.questionCurrent.ZANSWER[0].checkAnswer||$scope.questionCurrent.ZANSWER[1].checkAnswer||$scope.questionCurrent.ZANSWER[2].checkAnswer)&&checkValid()},$scope.onBack=function(){$window.history.back(),$rootScope.$broadcast("backFromSearch")};var promise;$scope.onSetHard=function(){null!=promise&&($timeout.cancel(promise),$scope.isShowBar=!1),db.checkIfExistsQuestion($scope.questionCurrent.ZID).then(function(data){data==$scope.questionCurrent.ZID?$scope.questionCurrent.ISHARD?db.updateQuestionUnHard($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),$scope.hardText=$scope.MenuQuestionItem.statusUnHard,$scope.isShowBar=!0,promise=$timeout(function(){$scope.questionCurrent.ISHARD=!1,$scope.isShowBar=!1},3e3)}):db.updateQuestionHard($scope.questionCurrent.ZID).then(function(){$scope.questionCurrent.ISHARD=!0,$rootScope.$broadcast("reload"),$scope.hardText=$scope.MenuQuestionItem.statusHard,$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)}):db.addQuestionHard($scope.questionCurrent.ZID).then(function(){$rootScope.$broadcast("reload"),$scope.questionCurrent.ISHARD=!0,$scope.hardText=$scope.MenuQuestionItem.statusHard,$scope.isShowBar=!0,promise=$timeout(function(){$scope.isShowBar=!1},3e3)})}),$rootScope.audio&&$rootScope.$broadcast("playaudio","hard")},$scope.onPrevios=function(){var ipAnswer1=document.getElementById("ipAnswer1"),ipAnswer=document.getElementById("ipAnswer"),yourAnswer="";if(null==ipAnswer1&&null!=ipAnswer?yourAnswer=document.getElementById("ipAnswer").value:null!=ipAnswer1&&(yourAnswer=document.getElementById("ipAnswer1").value+document.getElementById("ipAnswer2").value),$scope.questionCurrent.ISANSWERED||$scope.questionCurrent.ZISINPUT&&""==yourAnswer||!$scope.questionCurrent.ZANSWER[0].checkAnswer&&!$scope.questionCurrent.ZANSWER[1].checkAnswer&&!$scope.questionCurrent.ZANSWER[2].checkAnswer&&!$scope.questionCurrent.ZISINPUT){$scope.questionCurrent.ZANSWER[0].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[1].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[2].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[0].checkAnswer=!1,$scope.questionCurrent.ZANSWER[1].checkAnswer=!1,$scope.questionCurrent.ZANSWER[2].checkAnswer=!1,$scope.questionCurrent.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.countPlayVideo=5,$scope.questionCurrent.ISANSWERED=!1;var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");$scope.count;if($scope.sum>1)switch($scope.selectedIndex){case 0:$scope.selectedIndex=2,flip1.classList.add("flipRight"),flip2.classList.remove("flipRight"),flip2.classList.add("flipLeft"),flip3.classList.remove("flipLeft");break;case 1:$scope.selectedIndex=0,flip2.classList.add("flipRight"),flip1.classList.remove("flipLeft"),flip3.classList.remove("flipRight"),flip3.classList.add("flipLeft");break;case 2:$scope.selectedIndex=1,flip3.classList.add("flipRight"),flip1.classList.remove("flipRight"),flip1.classList.add("flipLeft"),flip2.classList.remove("flipLeft")}$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}else($scope.questionCurrent.ZISINPUT||$scope.questionCurrent.ZANSWER[0].checkAnswer||$scope.questionCurrent.ZANSWER[1].checkAnswer||$scope.questionCurrent.ZANSWER[2].checkAnswer)&&checkValid()},$scope.onNextItem=function(){var ipAnswer1=document.getElementById("ipAnswer1"),ipAnswer=document.getElementById("ipAnswer"),yourAnswer="";if(null==ipAnswer1&&null!=ipAnswer?yourAnswer=document.getElementById("ipAnswer").value:null!=ipAnswer1&&(yourAnswer=document.getElementById("ipAnswer1").value+document.getElementById("ipAnswer2").value),$scope.questionCurrent.ISANSWERED||$scope.questionCurrent.ZISINPUT&&""==yourAnswer||!$scope.questionCurrent.ZANSWER[0].checkAnswer&&!$scope.questionCurrent.ZANSWER[1].checkAnswer&&!$scope.questionCurrent.ZANSWER[2].checkAnswer&&!$scope.questionCurrent.ZISINPUT){$scope.questionCurrent.ZANSWER[0].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[1].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[2].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[0].checkAnswer=!1,$scope.questionCurrent.ZANSWER[1].checkAnswer=!1,$scope.questionCurrent.ZANSWER[2].checkAnswer=!1,$scope.questionCurrent.ZANSWER[0].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[1].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.questionCurrent.ZANSWER[2].Number=$rootScope.answeredRandom?.5-$window.Math.random():0,$scope.countPlayVideo=5,$scope.questionCurrent.ISANSWERED=!1;var flip1=document.getElementById("flip1"),flip2=document.getElementById("flip2"),flip3=document.getElementById("flip3");$scope.count;if($scope.sum>1)switch($scope.selectedIndex){case 0:$scope.selectedIndex=1,flip1.classList.add("flipLeft"),flip2.classList.remove("flipRight"),flip3.classList.remove("flipLeft"),flip3.classList.add("flipRight");break;case 1:$scope.selectedIndex=2,flip2.classList.add("flipLeft"),flip1.classList.remove("flipLeft"),flip1.classList.add("flipRight"),flip3.classList.remove("flipRight");break;case 2:$scope.selectedIndex=0,flip3.classList.add("flipLeft"),flip1.classList.remove("flipRight"),flip2.classList.remove("flipLeft"),flip2.classList.add("flipRight")}$rootScope.audio&&$rootScope.$broadcast("playaudio","next")}else($scope.questionCurrent.ZISINPUT||$scope.questionCurrent.ZANSWER[0].checkAnswer||$scope.questionCurrent.ZANSWER[1].checkAnswer||$scope.questionCurrent.ZANSWER[2].checkAnswer)&&checkValid()},$scope.onCheckValid=function(){checkValid()},$scope.onBlurNextQ=function(event){($scope.nextQuestion<1||$scope.nextQuestion>$scope.sum)&&($scope.nextQuestion=1),$scope.nextQuestion=null!=$scope.nextQuestion?$scope.nextQuestion:1,$scope.count=$scope.nextQuestion-1,$scope.questionCurrent.ZANSWER[0].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[1].isValid="img/answer_uncheck.png",$scope.questionCurrent.ZANSWER[2].isValid="img/answer_uncheck.png",$scope.questionCurrent.ISANSWERED=!1,db.selectQuestionById($scope.listQuestion[$scope.count]).then(callbackGetId)},$ionicModal.fromTemplateUrl("full-image-modal.html",{scope:$scope,animation:"none"}).then(function(modal){$scope.imageModal=modal}),$scope.fullImage=function(){$scope.questionCurrent.ZISVIDEO?playVideo():$scope.imageModal.show()},$scope.hide=function(){$scope.imageModal.hide()}})}(),function(){"use strict";angular.module("TrafficLaws.SettingController",["ui.router"]).controller("SettingCtrl",function($scope,$rootScope,$timeout,$q,$state,$window){function init(){if(0==$rootScope.language){$rootScope.titleAll=$rootScope.Menu.vn.setting,$scope.divider1=$rootScope.Menu.vn.screen_start,$scope.divider2=$rootScope.Menu.vn.setting_question,$scope.divider3=$rootScope.Menu.vn.advanced_divider,$scope.divider4=$rootScope.Menu.vn.change_all_question,$scope.question_time=$rootScope.Menu.vn.question_from;var start_setting=[{name:$rootScope.Menu.vn.start,event:1,choosed:1==$rootScope.startApp},{name:$rootScope.Menu.vn.question,event:2,choosed:2==$rootScope.startApp},{name:$rootScope.Menu.vn.test,event:3,choosed:3==$rootScope.startApp}];$scope.menuQuestion.setting_start=start_setting,$scope.questionRandom=$rootScope.Menu.vn.question+" "+$rootScope.Menu.vn.random,$scope.isQuestionRandom=$rootScope.questionRandom,$scope.answerRandom=$rootScope.Menu.vn.answer+" "+$rootScope.Menu.vn.random,$scope.isAnswerRandom=$rootScope.answeredRandom,$scope.audio=$rootScope.Menu.vn.audio,$scope.isAudio=$rootScope.audio}else{$rootScope.titleAll=$rootScope.Menu.de.setting,$scope.divider1=$rootScope.Menu.de.screen_start,$scope.divider2=$rootScope.Menu.de.setting_question,$scope.divider3=$rootScope.Menu.de.advanced_divider,$scope.divider4=$rootScope.Menu.de.change_all_question,$scope.question_time=$rootScope.Menu.de.question_from;var start_setting=[{name:$rootScope.Menu.de.start,event:1,choosed:1==$rootScope.startApp},{name:$rootScope.Menu.de.question,event:2,choosed:2==$rootScope.startApp},{name:$rootScope.Menu.de.test,event:3,choosed:3==$rootScope.startApp}];$scope.menuQuestion.setting_start=start_setting,$scope.questionRandom=$rootScope.Menu.de.question_setting+" "+$rootScope.Menu.de.random,$scope.isQuestionRandom=$rootScope.questionRandom,$scope.answerRandom=$rootScope.Menu.de.answer+" "+$rootScope.Menu.de.random,$scope.isAnswerRandom=$rootScope.answeredRandom,$scope.audio=$rootScope.Menu.de.audio,$scope.isAudio=$rootScope.audio}$scope.$$phase?$timeout(function(){$scope.$apply()},500):$scope.$apply()}$rootScope.isBack=!0,$rootScope.isSetting=!0,$scope.questionTheme1=new Array,$scope.questionTheme2=new Array,$scope.menuQuestion=[{setting_start:[],setting_question:[]}],init(),$scope.$on("changeLanguage",function(event){$scope.isLanguage=$rootScope.language,init()}),$scope.chooseStart=function(event){$scope.menuQuestion.setting_start[0].choosed=!1,$scope.menuQuestion.setting_start[1].choosed=!1,$scope.menuQuestion.setting_start[2].choosed=!1,$scope.menuQuestion.setting_start[event-1].choosed=!0,$window.localStorage.setItem("START_APP",event)},$scope.settingQuestion=function(){$window.localStorage.setItem("QUESTION_RANDOM",$scope.isQuestionRandom),$rootScope.questionRandom=JSON.parse($window.localStorage.getItem("QUESTION_RANDOM"))},$scope.settingAnswer=function(){$window.localStorage.setItem("ANSWERED_RANDOM",$scope.isAnswerRandom),$rootScope.answeredRandom=JSON.parse($window.localStorage.getItem("ANSWERED_RANDOM"))},$scope.settingAudio=function(){console.log($scope.isAudio),$window.localStorage.setItem("AUDIO",$scope.isAudio),$rootScope.audio=JSON.parse($window.localStorage.getItem("AUDIO"))}})}();